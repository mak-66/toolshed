import{$ as Dl,$a as Ut,A as No,Aa as zm,Ab as Zi,B as Al,Ba as Ki,Bb as es,C as xo,Ca as Tr,Cb as _n,D as Vt,Da as Ar,Db as ag,E as fn,Ea as qm,Eb as cg,F as Un,Fa as Gm,Fb as Dr,G as Dm,Ga as Wm,Gb as lg,H as Cl,Ha as Hm,Hb as Ol,I as bt,Ia as Km,Ib as ug,J as Pm,Ja as Qm,Jb as Pr,K as jn,Ka as Ym,Kb as dg,L as pn,La as Xe,Lb as _t,M as Sl,Ma as Jm,Mb as ts,N as km,Na as Xm,Nb as yn,O as Rl,Oa as Qi,Ob as kr,P as Mm,Pa as Ke,Pb as hg,Q as Nm,Qa as _e,Qb as fg,R as Gi,Ra as kl,Rb as Ee,S as ht,Sa as Lo,Sb as Vl,T as Oo,Ta as Yi,Tb as qo,U as ge,Ua as Zm,Ub as pg,V as ue,Va as Cr,Vb as mg,W as br,Wa as eg,Wb as gg,X as q,Xa as tg,Xb as _g,Y as Ce,Ya as Pe,Yb as Fl,Z as xm,Za as Se,Zb as yg,_ as X,_a as fe,a as O,aa as ne,ab as Sr,b as se,ba as N,bb as Uo,ca as He,cb as jo,d as un,da as ft,db as ng,e as v,ea as Om,eb as Ml,f as Mo,fa as Wi,fb as mn,g as vl,ga as Ft,gb as Rr,h as dn,ha as Bn,hb as Tt,i as Il,ia as $n,ib as Bo,j as wl,ja as Vm,jb as rg,k as rt,ka as pt,kb as ig,l as it,la as Fm,lb as sg,m as Am,ma as Lm,mb as Z,n as Cm,na as Um,nb as ie,o as hn,oa as jm,ob as at,p as El,pa as ot,pb as jt,q as bl,qa as we,qb as gn,r as Tl,ra as zn,rb as gt,s as We,sa as Vo,sb as og,t as U,ta as mt,tb as Nl,u as Ln,ua as Bm,ub as $o,v as Sm,va as Fo,vb as zo,w as Rm,wa as $m,wb as pe,x as B,xa as Lt,xb as xl,y as qi,ya as Pl,yb as Ji,z as st,za as Hi,zb as Xi}from"./chunk-DZWS2PQT.js";var Ul=class{};var Mr=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=t.slice(r+1).trim();this.addHeaderEntry(i,s)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.addHeaderEntry(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let a=this.headers.get(t);if(!a)return;a=a.filter(c=>s.indexOf(c)===-1),a.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}break}}addHeaderEntry(e,t){let r=e.toLowerCase();this.maybeSetNormalizedName(e,r),this.headers.has(r)?this.headers.get(r).push(t):this.headers.set(r,[t])}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var jl=class{encodeKey(e){return vg(e)}encodeValue(e){return vg(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function mE(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[a,c]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],l=t.get(a)||[];l.push(c),t.set(a,l)}),t}var gE=/%(\d[a-f0-9])/gi,_E={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function vg(n){return encodeURIComponent(n).replace(gE,(e,t)=>_E[t]??e)}function Go(n){return`${n}`}var vn=class n{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new jl,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=mE(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let r=e.fromObject[t],i=Array.isArray(r)?r.map(Go):[Go(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(Go(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(Go(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var Bl=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function yE(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Ig(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function wg(n){return typeof Blob<"u"&&n instanceof Blob}function Eg(n){return typeof FormData<"u"&&n instanceof FormData}function vE(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var ns=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(e,t,r,i){this.url=t,this.method=e.toUpperCase();let s;if(yE(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new Mr,this.context??=new Bl,!this.params)this.params=new vn,this.urlWithParams=t;else{let a=this.params.toString();if(a.length===0)this.urlWithParams=t;else{let c=t.indexOf("?"),l=c===-1?"?":c<t.length-1?"&":"";this.urlWithParams=t+l+a}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Ig(this.body)||wg(this.body)||Eg(this.body)||vE(this.body)?this.body:this.body instanceof vn?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Eg(this.body)?null:wg(this.body)?this.body.type||null:Ig(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof vn?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,a=e.body!==void 0?e.body:this.body,c=e.withCredentials??this.withCredentials,l=e.reportProgress??this.reportProgress,h=e.headers||this.headers,p=e.params||this.params,m=e.context??this.context;return e.setHeaders!==void 0&&(h=Object.keys(e.setHeaders).reduce((E,S)=>E.set(S,e.setHeaders[S]),h)),e.setParams&&(p=Object.keys(e.setParams).reduce((E,S)=>E.set(S,e.setParams[S]),p)),new n(t,r,a,{params:p,headers:h,context:m,reportProgress:l,responseType:i,withCredentials:c,transferCache:s})}},bg=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(bg||{}),$l=class{headers;status;statusText;url;ok;type;constructor(e,t=200,r="OK"){this.headers=e.headers||new Mr,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}};var zl=class n extends $l{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=bg.Response;clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}};function Ll(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var Tg=(()=>{class n{handler;constructor(t){this.handler=t}request(t,r,i={}){let s;if(t instanceof ns)s=t;else{let l;i.headers instanceof Mr?l=i.headers:l=new Mr(i.headers);let h;i.params&&(i.params instanceof vn?h=i.params:h=new vn({fromObject:i.params})),s=new ns(t,r,i.body!==void 0?i.body:null,{headers:l,context:i.context,params:h,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache})}let a=U(s).pipe(Un(l=>this.handler.handle(l)));if(t instanceof ns||i.observe==="events")return a;let c=a.pipe(Vt(l=>l instanceof zl));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return c.pipe(B(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(B(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(B(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return c.pipe(B(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:new vn().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,Ll(i,r))}post(t,r,i={}){return this.request("POST",t,Ll(i,r))}put(t,r,i={}){return this.request("PUT",t,Ll(i,r))}static \u0275fac=function(r){return new(r||n)(ne(Ul))};static \u0275prov=q({token:n,factory:n.\u0275fac})}return n})();var Gl=class extends fg{supportsDOMEvents=!0},Wl=class n extends Gl{static makeCurrent(){hg(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=EE();return t==null?null:bE(t)}resetBaseElement(){rs=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return pg(document.cookie,e)}},rs=null;function EE(){return rs=rs||document.querySelector("base"),rs?rs.getAttribute("href"):null}function bE(n){return new URL(n,document.baseURI).pathname}var TE=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=q({token:n,factory:n.\u0275fac})}return n})(),Hl=new X(""),Dg=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new ue(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(ne(Hl),ne(we))};static \u0275prov=q({token:n,factory:n.\u0275fac})}return n})(),Wo=class{_doc;constructor(e){this._doc=e}manager},Kl="ng-app-id";function Ag(n){for(let e of n)e.remove()}function Cg(n,e){let t=e.createElement("style");return t.textContent=n,t}function AE(n,e,t){let r=n.head?.querySelectorAll(`style[${Kl}="${e}"]`);if(r)for(let i of r)i.textContent&&(i.removeAttribute(Kl),t.set(i.textContent,{usage:0,elements:[i]}))}function Ql(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var Pg=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.isServer=Fl(s),AE(t,r,this.inline),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,Cg);r?.forEach(i=>this.addUsage(i,this.external,Ql))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let s=r.get(t);s?s.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(a=>this.addElement(a,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(Ag(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])Ag(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,Cg(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,Ql(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(Kl,this.appId),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(ne(Ee),ne(Fo),ne(Hi,8),ne(Lt))};static \u0275prov=q({token:n,factory:n.\u0275fac})}return n})(),ql={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Jl=/%COMP%/g,kg="%COMP%",CE=`_nghost-${kg}`,SE=`_ngcontent-${kg}`,RE=!0,DE=new X("",{providedIn:"root",factory:()=>RE});function PE(n){return SE.replace(Jl,n)}function kE(n){return CE.replace(Jl,n)}function Mg(n,e){return e.map(t=>t.replace(Jl,n))}var Ho=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,s,a,c,l,h=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=h,this.platformIsServer=Fl(c),this.defaultRenderer=new is(t,a,l,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Ki.ShadowDom&&(r=se(O({},r),{encapsulation:Ki.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof Ko?i.applyToHost(t):i instanceof ss&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let a=this.doc,c=this.ngZone,l=this.eventManager,h=this.sharedStylesHost,p=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(r.encapsulation){case Ki.Emulated:s=new Ko(l,h,r,this.appId,p,a,c,m);break;case Ki.ShadowDom:return new Yl(l,h,t,r,a,c,this.nonce,m);default:s=new ss(l,h,r,p,a,c,m);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static \u0275fac=function(r){return new(r||n)(ne(Dg),ne(Pg),ne(Fo),ne(DE),ne(Ee),ne(Lt),ne(we),ne(Hi))};static \u0275prov=q({token:n,factory:n.\u0275fac})}return n})(),is=class{eventManager;doc;ngZone;platformIsServer;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(ql[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Sg(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(Sg(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new ue(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=ql[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=ql[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Qi.DashCase|Qi.Important)?e.style.setProperty(t,r,i&Qi.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Qi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=kr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function Sg(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Yl=class extends is{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,i,s,a,c,l){super(e,s,a,l),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let h=Mg(i.id,i.styles);for(let m of h){let E=document.createElement("style");c&&E.setAttribute("nonce",c),E.textContent=m,this.shadowRoot.appendChild(E)}let p=i.getExternalStyles?.();if(p)for(let m of p){let E=Ql(m,s);c&&E.setAttribute("nonce",c),this.shadowRoot.appendChild(E)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},ss=class extends is{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,s,a,c,l){super(e,s,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=l?Mg(l,r.styles):r.styles,this.styleUrls=r.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Ko=class extends ss{contentAttr;hostAttr;constructor(e,t,r,i,s,a,c,l){let h=i+"-"+r.id;super(e,t,r,s,a,c,l,h),this.contentAttr=PE(h),this.hostAttr=kE(h)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},ME=(()=>{class n extends Wo{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static \u0275fac=function(r){return new(r||n)(ne(Ee))};static \u0275prov=q({token:n,factory:n.\u0275fac})}return n})(),Rg=["alt","control","meta","shift"],NE={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},xE={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},OE=(()=>{class n extends Wo{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i){let s=n.parseEventName(r),a=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>kr().onAndCancel(t,s.domEventName,a))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),a="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),a="code."),Rg.forEach(h=>{let p=r.indexOf(h);p>-1&&(r.splice(p,1),a+=h+".")}),a+=s,r.length!=0||s.length===0)return null;let l={};return l.domEventName=i,l.fullKey=a,l}static matchEventFullKeyCode(t,r){let i=NE[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),Rg.forEach(a=>{if(a!==i){let c=xE[a];c(t)&&(s+=a+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(ne(Ee))};static \u0275prov=q({token:n,factory:n.\u0275fac})}return n})();function Ng(n,e){return dg(O({rootComponent:n},VE(e)))}function VE(n){return{appProviders:[...BE,...n?.providers??[]],platformProviders:jE}}function FE(){Wl.makeCurrent()}function LE(){return new zn}function UE(){return Bm(document),document}var jE=[{provide:Lt,useValue:gg},{provide:$m,useValue:FE,multi:!0},{provide:Ee,useFactory:UE,deps:[]}];var BE=[{provide:Om,useValue:"root"},{provide:zn,useFactory:LE,deps:[]},{provide:Hl,useClass:ME,multi:!0,deps:[Ee,we,Lt]},{provide:Hl,useClass:OE,multi:!0,deps:[Ee]},Ho,Pg,Dg,{provide:Lo,useExisting:Ho},{provide:yg,useClass:TE,deps:[]},[]];var xg=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(ne(Ee))};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Xl=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=q({token:n,factory:function(r){let i=null;return r?i=new(r||n):i=ne($E),i},providedIn:"root"})}return n})(),$E=(()=>{class n extends Xl{_doc;constructor(t){super(),this._doc=t}sanitize(t,r){if(r==null)return null;switch(t){case Xe.NONE:return r;case Xe.HTML:return Ar(r,"HTML")?Tr(r):Ym(this._doc,String(r)).toString();case Xe.STYLE:return Ar(r,"Style")?Tr(r):r;case Xe.SCRIPT:if(Ar(r,"Script"))return Tr(r);throw new ue(5200,!1);case Xe.URL:return Ar(r,"URL")?Tr(r):Qm(String(r));case Xe.RESOURCE_URL:if(Ar(r,"ResourceURL"))return Tr(r);throw new ue(5201,!1);default:throw new ue(5202,!1)}}bypassSecurityTrustHtml(t){return qm(t)}bypassSecurityTrustStyle(t){return Gm(t)}bypassSecurityTrustScript(t){return Wm(t)}bypassSecurityTrustUrl(t){return Hm(t)}bypassSecurityTrustResourceUrl(t){return Km(t)}static \u0275fac=function(r){return new(r||n)(ne(Ee))};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var H="primary",ws=Symbol("RouteTitle"),ru=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Lr(n){return new ru(n)}function GE(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let a=r[s],c=n[s];if(a[0]===":")i[a.substring(1)]=c;else if(a!==c.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function WE(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!At(n[t],e[t]))return!1;return!0}function At(n,e){let t=n?iu(n):void 0,r=e?iu(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!zg(n[i],e[i]))return!1;return!0}function iu(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function zg(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function qg(n){return n.length>0?n[n.length-1]:null}function wn(n){return Sm(n)?n:jo(n)?We(Promise.resolve(n)):U(n)}var HE={exact:Wg,subset:Hg},Gg={exact:KE,subset:QE,ignored:()=>!0};function Vg(n,e,t){return HE[t.paths](n.root,e.root,t.matrixParams)&&Gg[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function KE(n,e){return At(n,e)}function Wg(n,e,t){if(!Gn(n.segments,e.segments)||!Jo(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!Wg(n.children[r],e.children[r],t))return!1;return!0}function QE(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>zg(n[t],e[t]))}function Hg(n,e,t){return Kg(n,e,e.segments,t)}function Kg(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Gn(i,t)||e.hasChildren()||!Jo(i,t,r))}else if(n.segments.length===t.length){if(!Gn(n.segments,t)||!Jo(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!Hg(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Gn(n.segments,i)||!Jo(n.segments,i,r)||!n.children[H]?!1:Kg(n.children[H],e,s,r)}}function Jo(n,e,t){return e.every((r,i)=>Gg[t](n[i].parameters,r.parameters))}var $t=class{root;queryParams;fragment;_queryParamMap;constructor(e=new oe([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Lr(this.queryParams),this._queryParamMap}toString(){return XE.serialize(this)}},oe=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Xo(this)}},qn=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Lr(this.parameters),this._parameterMap}toString(){return Yg(this)}};function YE(n,e){return Gn(n,e)&&n.every((t,r)=>At(t.parameters,e[r].parameters))}function Gn(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function JE(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===H&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==H&&(t=t.concat(e(i,r)))}),t}var Pu=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=q({token:n,factory:()=>new hs,providedIn:"root"})}return n})(),hs=class{parse(e){let t=new ou(e);return new $t(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${os(e.root,!0)}`,r=tb(e.queryParams),i=typeof e.fragment=="string"?`#${ZE(e.fragment)}`:"";return`${t}${r}${i}`}},XE=new hs;function Xo(n){return n.segments.map(e=>Yg(e)).join("/")}function os(n,e){if(!n.hasChildren())return Xo(n);if(e){let t=n.children[H]?os(n.children[H],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==H&&r.push(`${i}:${os(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=JE(n,(r,i)=>i===H?[os(n.children[H],!1)]:[`${i}:${os(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[H]!=null?`${Xo(n)}/${t[0]}`:`${Xo(n)}/(${t.join("//")})`}}function Qg(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Qo(n){return Qg(n).replace(/%3B/gi,";")}function ZE(n){return encodeURI(n)}function su(n){return Qg(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Zo(n){return decodeURIComponent(n)}function Fg(n){return Zo(n.replace(/\+/g,"%20"))}function Yg(n){return`${su(n.path)}${eb(n.parameters)}`}function eb(n){return Object.entries(n).map(([e,t])=>`;${su(e)}=${su(t)}`).join("")}function tb(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Qo(t)}=${Qo(i)}`).join("&"):`${Qo(t)}=${Qo(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var nb=/^[^\/()?;#]+/;function Zl(n){let e=n.match(nb);return e?e[0]:""}var rb=/^[^\/()?;=#]+/;function ib(n){let e=n.match(rb);return e?e[0]:""}var sb=/^[^=?&#]+/;function ob(n){let e=n.match(sb);return e?e[0]:""}var ab=/^[^&#]+/;function cb(n){let e=n.match(ab);return e?e[0]:""}var ou=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new oe([],{}):new oe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[H]=new oe(e,t)),r}parseSegment(){let e=Zl(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new ue(4009,!1);return this.capture(e),new qn(Zo(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=ib(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=Zl(this.remaining);i&&(r=i,this.capture(r))}e[Zo(t)]=Zo(r)}parseQueryParam(e){let t=ob(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let a=cb(this.remaining);a&&(r=a,this.capture(r))}let i=Fg(t),s=Fg(r);if(e.hasOwnProperty(i)){let a=e[i];Array.isArray(a)||(a=[a],e[i]=a),a.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Zl(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new ue(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=H);let a=this.parseChildren();t[s]=Object.keys(a).length===1?a[H]:new oe([],a),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new ue(4011,!1)}};function Jg(n){return n.segments.length>0?new oe([],{[H]:n}):n}function Xg(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=Xg(i);if(r===H&&s.segments.length===0&&s.hasChildren())for(let[a,c]of Object.entries(s.children))e[a]=c;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new oe(n.segments,e);return lb(t)}function lb(n){if(n.numberOfChildren===1&&n.children[H]){let e=n.children[H];return new oe(n.segments.concat(e.segments),e.children)}return n}function Wn(n){return n instanceof $t}function ub(n,e,t=null,r=null){let i=Zg(n);return e_(i,e,t,r)}function Zg(n){let e;function t(s){let a={};for(let l of s.children){let h=t(l);a[l.outlet]=h}let c=new oe(s.url,a);return s===n&&(e=c),c}let r=t(n.root),i=Jg(r);return e??i}function e_(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return eu(i,i,i,t,r);let s=db(e);if(s.toRoot())return eu(i,i,new oe([],{}),t,r);let a=hb(s,i,n),c=a.processChildren?ls(a.segmentGroup,a.index,s.commands):n_(a.segmentGroup,a.index,s.commands);return eu(i,a.segmentGroup,c,t,r)}function ea(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function fs(n){return typeof n=="object"&&n!=null&&n.outlets}function eu(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([l,h])=>{s[l]=Array.isArray(h)?h.map(p=>`${p}`):`${h}`});let a;n===e?a=t:a=t_(n,e,t);let c=Jg(Xg(a));return new $t(c,s,i)}function t_(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=t_(s,e,t)}),new oe(n.segments,r)}var ta=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&ea(r[0]))throw new ue(4003,!1);let i=r.find(fs);if(i&&i!==qg(r))throw new ue(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function db(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new ta(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,a)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let c={};return Object.entries(s.outlets).forEach(([l,h])=>{c[l]=typeof h=="string"?h.split("/"):h}),[...i,{outlets:c}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:a===0?(s.split("/").forEach((c,l)=>{l==0&&c==="."||(l==0&&c===""?t=!0:c===".."?e++:c!=""&&i.push(c))}),i):[...i,s]},[]);return new ta(t,e,r)}var Or=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function hb(n,e,t){if(n.isAbsolute)return new Or(e,!0,0);if(!t)return new Or(e,!1,NaN);if(t.parent===null)return new Or(t,!0,0);let r=ea(n.commands[0])?0:1,i=t.segments.length-1+r;return fb(t,i,n.numberOfDoubleDots)}function fb(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new ue(4005,!1);i=r.segments.length}return new Or(r,!1,i-s)}function pb(n){return fs(n[0])?n[0].outlets:{[H]:n}}function n_(n,e,t){if(n??=new oe([],{}),n.segments.length===0&&n.hasChildren())return ls(n,e,t);let r=mb(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new oe(n.segments.slice(0,r.pathIndex),{});return s.children[H]=new oe(n.segments.slice(r.pathIndex),n.children),ls(s,0,i)}else return r.match&&i.length===0?new oe(n.segments,{}):r.match&&!n.hasChildren()?au(n,e,t):r.match?ls(n,0,i):au(n,e,t)}function ls(n,e,t){if(t.length===0)return new oe(n.segments,{});{let r=pb(t),i={};if(Object.keys(r).some(s=>s!==H)&&n.children[H]&&n.numberOfChildren===1&&n.children[H].segments.length===0){let s=ls(n.children[H],e,t);return new oe(n.segments,s.children)}return Object.entries(r).forEach(([s,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(i[s]=n_(n.children[s],e,a))}),Object.entries(n.children).forEach(([s,a])=>{r[s]===void 0&&(i[s]=a)}),new oe(n.segments,i)}}function mb(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let a=n.segments[i],c=t[r];if(fs(c))break;let l=`${c}`,h=r<t.length-1?t[r+1]:null;if(i>0&&l===void 0)break;if(l&&h&&typeof h=="object"&&h.outlets===void 0){if(!Ug(l,h,a))return s;r+=2}else{if(!Ug(l,{},a))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function au(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(fs(s)){let l=gb(s.outlets);return new oe(r,l)}if(i===0&&ea(t[0])){let l=n.segments[e];r.push(new qn(l.path,Lg(t[0]))),i++;continue}let a=fs(s)?s.outlets[H]:`${s}`,c=i<t.length-1?t[i+1]:null;a&&c&&ea(c)?(r.push(new qn(a,Lg(c))),i+=2):(r.push(new qn(a,{})),i++)}return new oe(r,{})}function gb(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=au(new oe([],{}),0,r))}),e}function Lg(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function Ug(n,e,t){return n==t.path&&At(e,t.parameters)}var us="imperative",Ve=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Ve||{}),ct=class{id;url;constructor(e,t){this.id=e,this.url=t}},ps=class extends ct{type=Ve.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},In=class extends ct{urlAfterRedirects;type=Ve.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},et=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(et||{}),cu=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(cu||{}),Bt=class extends ct{reason;code;type=Ve.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Hn=class extends ct{reason;code;type=Ve.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},ms=class extends ct{error;target;type=Ve.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},na=class extends ct{urlAfterRedirects;state;type=Ve.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},lu=class extends ct{urlAfterRedirects;state;type=Ve.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},uu=class extends ct{urlAfterRedirects;state;shouldActivate;type=Ve.GuardsCheckEnd;constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},du=class extends ct{urlAfterRedirects;state;type=Ve.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},hu=class extends ct{urlAfterRedirects;state;type=Ve.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},fu=class{route;type=Ve.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},pu=class{route;type=Ve.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},mu=class{snapshot;type=Ve.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},gu=class{snapshot;type=Ve.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},_u=class{snapshot;type=Ve.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},yu=class{snapshot;type=Ve.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var gs=class{},Ur=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function _b(n,e){return n.providers&&!n._injector&&(n._injector=tg(n.providers,e,`Route: ${n.path}`)),n._injector??e}function yt(n){return n.outlet||H}function yb(n,e){let t=n.filter(r=>yt(r)===e);return t.push(...n.filter(r=>yt(r)!==e)),t}function Es(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var vu=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Es(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new la(this.rootInjector)}},la=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new vu(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(ne(Wi))};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ra=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Iu(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=Iu(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=wu(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return wu(e,this._root).map(t=>t.value)}};function Iu(n,e){if(n===e.value)return e;for(let t of e.children){let r=Iu(n,t);if(r)return r}return null}function wu(n,e){if(n===e.value)return[e];for(let t of e.children){let r=wu(n,t);if(r.length)return r.unshift(e),r}return[]}var Ze=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function xr(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var ia=class extends ra{snapshot;constructor(e,t){super(e),this.snapshot=t,ku(this,e)}toString(){return this.snapshot.toString()}};function r_(n){let e=vb(n),t=new it([new qn("",{})]),r=new it({}),i=new it({}),s=new it({}),a=new it(""),c=new Kn(t,r,s,a,i,H,n,e.root);return c.snapshot=e.root,new ia(new Ze(c,[]),e)}function vb(n){let e={},t={},r={},i="",s=new Vr([],e,r,i,t,H,n,null,{});return new oa("",new Ze(s,[]))}var Kn=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,s,a,c,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=a,this.component=c,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(B(h=>h[ws]))??U(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(B(e=>Lr(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(B(e=>Lr(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function sa(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:O(O({},e.params),n.params),data:O(O({},e.data),n.data),resolve:O(O(O(O({},n.data),e.data),i?.data),n._resolvedData)}:r={params:O({},n.params),data:O({},n.data),resolve:O(O({},n.data),n._resolvedData??{})},i&&s_(i)&&(r.resolve[ws]=i.title),r}var Vr=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[ws]}constructor(e,t,r,i,s,a,c,l,h){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=a,this.component=c,this.routeConfig=l,this._resolve=h}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Lr(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Lr(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},oa=class extends ra{url;constructor(e,t){super(t),this.url=e,ku(this,t)}toString(){return i_(this._root)}};function ku(n,e){e.value._routerState=n,e.children.forEach(t=>ku(n,t))}function i_(n){let e=n.children.length>0?` { ${n.children.map(i_).join(", ")} } `:"";return`${n.value}${e}`}function tu(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,At(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),At(e.params,t.params)||n.paramsSubject.next(t.params),WE(e.url,t.url)||n.urlSubject.next(t.url),At(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Eu(n,e){let t=At(n.params,e.params)&&YE(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Eu(n.parent,e.parent))}function s_(n){return typeof n.title=="string"||n.title===null}var Ib=new X(""),bs=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=H;activateEvents=new ot;deactivateEvents=new ot;attachEvents=new ot;detachEvents=new ot;routerOutletData=Vo(void 0);parentContexts=N(la);location=N(Zm);changeDetector=N(Pr);inputBinder=N(Mu,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ue(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ue(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ue(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new ue(4013,!1);this._activatedRoute=t;let i=this.location,a=t.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new bu(t,c,i.injector,this.routerOutletData);this.activated=i.createComponent(a,{index:i.length,injector:l,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=fe({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Bn]})}return n})(),bu=class n{route;childContexts;parent;outletData;__ngOutletInjector(e){return new n(this.route,this.childContexts,e,this.outletData)}constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===Kn?this.route:e===la?this.childContexts:e===Ib?this.outletData:this.parent.get(e,t)}},Mu=new X("");function wb(n,e,t){let r=_s(n,e._root,t?t._root:void 0);return new ia(r,e)}function _s(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=Eb(n,e,t);return new Ze(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let a=s.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(c=>_s(n,c)),a}}let r=bb(e.value),i=e.children.map(s=>_s(n,s));return new Ze(r,i)}}function Eb(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return _s(n,r,i);return _s(n,r)})}function bb(n){return new Kn(new it(n.url),new it(n.params),new it(n.queryParams),new it(n.fragment),new it(n.data),n.outlet,n.component,n)}var ys=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},o_="ngNavigationCancelingError";function aa(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Wn(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=a_(!1,et.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function a_(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[o_]=!0,t.cancellationCode=e,t}function Tb(n){return c_(n)&&Wn(n.url)}function c_(n){return!!n&&n[o_]}var Ab=(n,e,t,r)=>B(i=>(new Tu(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Tu=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),tu(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=xr(t);e.children.forEach(s=>{let a=s.value.outlet;this.deactivateRoutes(s,i[a],r),delete i[a]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let a=r.getContext(i.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=xr(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);if(r&&r.outlet){let a=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=xr(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=xr(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new yu(s.value.snapshot))}),e.children.length&&this.forwardEvent(new gu(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(tu(i),i===s)if(i.component){let a=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let a=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let c=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),a.children.onOutletReAttached(c.contexts),a.attachRef=c.componentRef,a.route=c.route.value,a.outlet&&a.outlet.attach(c.componentRef,c.route.value),tu(c.route.value),this.activateChildRoutes(e,null,a.children)}else a.attachRef=null,a.route=i,a.outlet&&a.outlet.activateWith(i,a.injector),this.activateChildRoutes(e,null,a.children)}else this.activateChildRoutes(e,null,r)}},ca=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Fr=class{component;route;constructor(e,t){this.component=e,this.route=t}};function Cb(n,e,t){let r=n._root,i=e?e._root:null;return as(r,i,t,[r.value])}function Sb(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Br(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!xm(n)?n:e.get(n):r}function as(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=xr(e);return n.children.forEach(a=>{Rb(a,s[a.value.outlet],t,r.concat([a.value]),i),delete s[a.value.outlet]}),Object.entries(s).forEach(([a,c])=>ds(c,t.getContext(a),i)),i}function Rb(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,a=e?e.value:null,c=t?t.getContext(n.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){let l=Db(a,s,s.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new ca(r)):(s.data=a.data,s._resolvedData=a._resolvedData),s.component?as(n,e,c?c.children:null,r,i):as(n,e,t,r,i),l&&c&&c.outlet&&c.outlet.isActivated&&i.canDeactivateChecks.push(new Fr(c.outlet.component,a))}else a&&ds(e,c,i),i.canActivateChecks.push(new ca(r)),s.component?as(n,null,c?c.children:null,r,i):as(n,null,t,r,i);return i}function Db(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Gn(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Gn(n.url,e.url)||!At(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Eu(n,e)||!At(n.queryParams,e.queryParams);case"paramsChange":default:return!Eu(n,e)}}function ds(n,e,t){let r=xr(n),i=n.value;Object.entries(r).forEach(([s,a])=>{i.component?e?ds(a,e.children.getContext(s),t):ds(a,null,t):ds(a,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Fr(e.outlet.component,i)):t.canDeactivateChecks.push(new Fr(null,i)):t.canDeactivateChecks.push(new Fr(null,i))}function Ts(n){return typeof n=="function"}function Pb(n){return typeof n=="boolean"}function kb(n){return n&&Ts(n.canLoad)}function Mb(n){return n&&Ts(n.canActivate)}function Nb(n){return n&&Ts(n.canActivateChild)}function xb(n){return n&&Ts(n.canDeactivate)}function Ob(n){return n&&Ts(n.canMatch)}function l_(n){return n instanceof Rm||n?.name==="EmptyError"}var Yo=Symbol("INITIAL_VALUE");function jr(){return ht(n=>qi(n.map(e=>e.pipe(bt(1),Gi(Yo)))).pipe(B(e=>{for(let t of e)if(t!==!0){if(t===Yo)return Yo;if(t===!1||Vb(t))return t}return!0}),Vt(e=>e!==Yo),bt(1)))}function Vb(n){return Wn(n)||n instanceof ys}function Fb(n,e){return st(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:a}}=t;return a.length===0&&s.length===0?U(se(O({},t),{guardsResult:!0})):Lb(a,r,i,n).pipe(st(c=>c&&Pb(c)?Ub(r,s,n,e):U(c)),B(c=>se(O({},t),{guardsResult:c})))})}function Lb(n,e,t,r){return We(n).pipe(st(i=>qb(i.component,i.route,t,e,r)),pn(i=>i!==!0,!0))}function Ub(n,e,t,r){return We(e).pipe(Un(i=>No(Bb(i.route.parent,r),jb(i.route,r),zb(n,i.path,t),$b(n,i.route,t))),pn(i=>i!==!0,!0))}function jb(n,e){return n!==null&&e&&e(new _u(n)),U(!0)}function Bb(n,e){return n!==null&&e&&e(new mu(n)),U(!0)}function $b(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return U(!0);let i=r.map(s=>Al(()=>{let a=Es(e)??t,c=Br(s,a),l=Mb(c)?c.canActivate(e,n):Ft(a,()=>c(e,n));return wn(l).pipe(pn())}));return U(i).pipe(jr())}function zb(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(a=>Sb(a)).filter(a=>a!==null).map(a=>Al(()=>{let c=a.guards.map(l=>{let h=Es(a.node)??t,p=Br(l,h),m=Nb(p)?p.canActivateChild(r,n):Ft(h,()=>p(r,n));return wn(m).pipe(pn())});return U(c).pipe(jr())}));return U(s).pipe(jr())}function qb(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return U(!0);let a=s.map(c=>{let l=Es(e)??i,h=Br(c,l),p=xb(h)?h.canDeactivate(n,e,t,r):Ft(l,()=>h(n,e,t,r));return wn(p).pipe(pn())});return U(a).pipe(jr())}function Gb(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return U(!0);let s=i.map(a=>{let c=Br(a,n),l=kb(c)?c.canLoad(e,t):Ft(n,()=>c(e,t));return wn(l)});return U(s).pipe(jr(),u_(r))}function u_(n){return vl(ge(e=>{if(typeof e!="boolean")throw aa(n,e)}),B(e=>e===!0))}function Wb(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return U(!0);let s=i.map(a=>{let c=Br(a,n),l=Ob(c)?c.canMatch(e,t):Ft(n,()=>c(e,t));return wn(l)});return U(s).pipe(jr(),u_(r))}var vs=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},Is=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function Nr(n){return Ln(new vs(n))}function Hb(n){return Ln(new ue(4e3,!1))}function Kb(n){return Ln(a_(!1,et.GuardRejected))}var Au=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return U(r);if(i.numberOfChildren>1||!i.children[H])return Hb(`${e.redirectTo}`);i=i.children[H]}}applyRedirectCommands(e,t,r,i,s){if(typeof t!="string"){let c=t,{queryParams:l,fragment:h,routeConfig:p,url:m,outlet:E,params:S,data:P,title:x}=i,k=Ft(s,()=>c({params:S,data:P,queryParams:l,fragment:h,routeConfig:p,url:m,outlet:E,title:x}));if(k instanceof $t)throw new Is(k);t=k}let a=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new Is(a);return a}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new $t(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let c=s.substring(1);r[i]=t[c]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),a={};return Object.entries(t.children).forEach(([c,l])=>{a[c]=this.createSegmentGroup(e,l,r,i)}),new oe(s,a)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new ue(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Cu={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Qb(n,e,t,r,i){let s=d_(n,e,t);return s.matched?(r=_b(e,r),Wb(r,e,t,i).pipe(B(a=>a===!0?s:O({},Cu)))):U(s)}function d_(n,e,t){if(e.path==="**")return Yb(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?O({},Cu):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||GE)(t,n,e);if(!i)return O({},Cu);let s={};Object.entries(i.posParams??{}).forEach(([c,l])=>{s[c]=l.path});let a=i.consumed.length>0?O(O({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:a,positionalParamSegments:i.posParams??{}}}function Yb(n){return{matched:!0,parameters:n.length>0?qg(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function jg(n,e,t,r){return t.length>0&&Zb(n,t,r)?{segmentGroup:new oe(e,Xb(r,new oe(t,n.children))),slicedSegments:[]}:t.length===0&&eT(n,t,r)?{segmentGroup:new oe(n.segments,Jb(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new oe(n.segments,n.children),slicedSegments:t}}function Jb(n,e,t,r){let i={};for(let s of t)if(ua(n,e,s)&&!r[yt(s)]){let a=new oe([],{});i[yt(s)]=a}return O(O({},r),i)}function Xb(n,e){let t={};t[H]=e;for(let r of n)if(r.path===""&&yt(r)!==H){let i=new oe([],{});t[yt(r)]=i}return t}function Zb(n,e,t){return t.some(r=>ua(n,e,r)&&yt(r)!==H)}function eT(n,e,t){return t.some(r=>ua(n,e,r))}function ua(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function tT(n,e,t){return e.length===0&&!n.children[t]}var Su=class{};function nT(n,e,t,r,i,s,a="emptyOnly"){return new Ru(n,e,t,r,i,a,s).recognize()}var rT=31,Ru=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,s,a,c){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=a,this.urlSerializer=c,this.applyRedirects=new Au(this.urlSerializer,this.urlTree)}noMatchError(e){return new ue(4002,`'${e.segmentGroup}'`)}recognize(){let e=jg(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(B(({children:t,rootSnapshot:r})=>{let i=new Ze(r,t),s=new oa("",i),a=ub(r,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(a),{state:s,tree:a}}))}match(e){let t=new Vr([],Object.freeze({}),Object.freeze(O({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),H,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,H,t).pipe(B(r=>({children:r,rootSnapshot:t})),fn(r=>{if(r instanceof Is)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof vs?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,s):this.processSegment(e,t,r,r.segments,i,!0,s).pipe(B(a=>a instanceof Ze?[a]:[]))}processChildren(e,t,r,i){let s=[];for(let a of Object.keys(r.children))a==="primary"?s.unshift(a):s.push(a);return We(s).pipe(Un(a=>{let c=r.children[a],l=yb(t,a);return this.processSegmentGroup(e,l,c,a,i)}),Rl((a,c)=>(a.push(...c),a)),Cl(null),km(),st(a=>{if(a===null)return Nr(r);let c=h_(a);return iT(c),U(c)}))}processSegment(e,t,r,i,s,a,c){return We(t).pipe(Un(l=>this.processSegmentAgainstRoute(l._injector??e,t,l,r,i,s,a,c).pipe(fn(h=>{if(h instanceof vs)return U(null);throw h}))),pn(l=>!!l),fn(l=>{if(l_(l))return tT(r,i,s)?U(new Su):Nr(r);throw l}))}processSegmentAgainstRoute(e,t,r,i,s,a,c,l){return yt(r)!==a&&(a===H||!ua(i,s,r))?Nr(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,a,l):this.allowRedirects&&c?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,a,l):Nr(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,a,c){let{matched:l,parameters:h,consumedSegments:p,positionalParamSegments:m,remainingSegments:E}=d_(t,i,s);if(!l)return Nr(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>rT&&(this.allowRedirects=!1));let S=new Vr(s,h,Object.freeze(O({},this.urlTree.queryParams)),this.urlTree.fragment,Bg(i),yt(i),i.component??i._loadedComponent??null,i,$g(i)),P=sa(S,c,this.paramsInheritanceStrategy);S.params=Object.freeze(P.params),S.data=Object.freeze(P.data);let x=this.applyRedirects.applyRedirectCommands(p,i.redirectTo,m,S,e);return this.applyRedirects.lineralizeSegments(i,x).pipe(st(k=>this.processSegment(e,r,t,k.concat(E),a,!1,c)))}matchSegmentAgainstRoute(e,t,r,i,s,a){let c=Qb(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),c.pipe(ht(l=>l.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(ht(({routes:h})=>{let p=r._loadedInjector??e,{parameters:m,consumedSegments:E,remainingSegments:S}=l,P=new Vr(E,m,Object.freeze(O({},this.urlTree.queryParams)),this.urlTree.fragment,Bg(r),yt(r),r.component??r._loadedComponent??null,r,$g(r)),x=sa(P,a,this.paramsInheritanceStrategy);P.params=Object.freeze(x.params),P.data=Object.freeze(x.data);let{segmentGroup:k,slicedSegments:z}=jg(t,E,S,h);if(z.length===0&&k.hasChildren())return this.processChildren(p,h,k,P).pipe(B(K=>new Ze(P,K)));if(h.length===0&&z.length===0)return U(new Ze(P,[]));let Q=yt(r)===s;return this.processSegment(p,h,k,z,Q?H:s,!0,P).pipe(B(K=>new Ze(P,K instanceof Ze?[K]:[])))}))):Nr(t)))}getChildConfig(e,t,r){return t.children?U({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?U({routes:t._loadedRoutes,injector:t._loadedInjector}):Gb(e,t,r,this.urlSerializer).pipe(st(i=>i?this.configLoader.loadChildren(e,t).pipe(ge(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):Kb(t))):U({routes:[],injector:e})}};function iT(n){n.sort((e,t)=>e.value.outlet===H?-1:t.value.outlet===H?1:e.value.outlet.localeCompare(t.value.outlet))}function sT(n){let e=n.value.routeConfig;return e&&e.path===""}function h_(n){let e=[],t=new Set;for(let r of n){if(!sT(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=h_(r.children);e.push(new Ze(r.value,i))}return e.filter(r=>!t.has(r))}function Bg(n){return n.data||{}}function $g(n){return n.resolve||{}}function oT(n,e,t,r,i,s){return st(a=>nT(n,e,t,r,a.extractedUrl,i,s).pipe(B(({state:c,tree:l})=>se(O({},a),{targetSnapshot:c,urlAfterRedirects:l}))))}function aT(n,e){return st(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return U(t);let s=new Set(i.map(l=>l.route)),a=new Set;for(let l of s)if(!a.has(l))for(let h of f_(l))a.add(h);let c=0;return We(a).pipe(Un(l=>s.has(l)?cT(l,r,n,e):(l.data=sa(l,l.parent,n).resolve,U(void 0))),ge(()=>c++),Sl(1),st(l=>c===a.size?U(t):hn))})}function f_(n){let e=n.children.map(t=>f_(t)).flat();return[n,...e]}function cT(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!s_(i)&&(s[ws]=i.title),lT(s,n,e,r).pipe(B(a=>(n._resolvedData=a,n.data=sa(n,n.parent,t).resolve,null)))}function lT(n,e,t,r){let i=iu(n);if(i.length===0)return U({});let s={};return We(i).pipe(st(a=>uT(n[a],e,t,r).pipe(pn(),ge(c=>{if(c instanceof ys)throw aa(new hs,c);s[a]=c}))),Sl(1),Pm(s),fn(a=>l_(a)?hn:Ln(a)))}function uT(n,e,t,r){let i=Es(e)??r,s=Br(n,i),a=s.resolve?s.resolve(e,t):Ft(i,()=>s(e,t));return wn(a)}function nu(n){return ht(e=>{let t=n(e);return t?We(t).pipe(B(()=>e)):U(e)})}var p_=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===H);return r}getResolvedTitleForRoute(t){return t.data[ws]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=q({token:n,factory:()=>N(dT),providedIn:"root"})}return n})(),dT=(()=>{class n extends p_{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(ne(xg))};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Nu=new X("",{providedIn:"root",factory:()=>({})}),hT=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Pe({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(r,i){r&1&&at(0,"router-outlet")},dependencies:[bs],encapsulation:2})}return n})();function xu(n){let e=n.children&&n.children.map(xu),t=e?se(O({},n),{children:e}):O({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==H&&(t.component=hT),t}var Ou=new X(""),fT=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=N(Ol);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return U(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=wn(t.loadComponent()).pipe(B(m_),ge(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),jn(()=>{this.componentLoaders.delete(t)})),i=new wl(r,()=>new rt).pipe(Il());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return U({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=pT(r,this.compiler,t,this.onLoadEndListener).pipe(jn(()=>{this.childrenLoaders.delete(r)})),a=new wl(s,()=>new rt).pipe(Il());return this.childrenLoaders.set(r,a),a}static \u0275fac=function(r){return new(r||n)};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function pT(n,e,t,r){return wn(n.loadChildren()).pipe(B(m_),st(i=>i instanceof eg||Array.isArray(i)?U(i):We(e.compileModuleAsync(i))),B(i=>{r&&r(n);let s,a,c=!1;return Array.isArray(i)?(a=i,c=!0):(s=i.create(t).injector,a=s.get(Ou,[],{optional:!0,self:!0}).flat()),{routes:a.map(xu),injector:s}}))}function mT(n){return n&&typeof n=="object"&&"default"in n}function m_(n){return mT(n)?n.default:n}var Vu=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=q({token:n,factory:()=>N(gT),providedIn:"root"})}return n})(),gT=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),_T=new X("");var yT=new X(""),vT=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new rt;transitionAbortSubject=new rt;configLoader=N(fT);environmentInjector=N(Wi);urlSerializer=N(Pu);rootContexts=N(la);location=N(qo);inputBindingEnabled=N(Mu,{optional:!0})!==null;titleStrategy=N(p_);options=N(Nu,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=N(Vu);createViewTransition=N(_T,{optional:!0});navigationErrorHandler=N(yT,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>U(void 0);rootComponentType=null;constructor(){let t=i=>this.events.next(new fu(i)),r=i=>this.events.next(new pu(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(se(O(O({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new it({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:us,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Vt(s=>s.id!==0),B(s=>se(O({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),ht(s=>{let a=!1,c=!1;return U(s).pipe(ht(l=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",et.SupersededByNewNavigation),hn;this.currentTransition=s,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?se(O({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let h=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),p=l.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!h&&p!=="reload"){let m="";return this.events.next(new Hn(l.id,this.urlSerializer.serialize(l.rawUrl),m,cu.IgnoredSameUrlNavigation)),l.resolve(!1),hn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return U(l).pipe(ht(m=>{let E=this.transitions?.getValue();return this.events.next(new ps(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),E!==this.transitions?.getValue()?hn:Promise.resolve(m)}),oT(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),ge(m=>{s.targetSnapshot=m.targetSnapshot,s.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation=se(O({},this.currentNavigation),{finalUrl:m.urlAfterRedirects});let E=new na(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(E)}));if(h&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:m,extractedUrl:E,source:S,restoredState:P,extras:x}=l,k=new ps(m,this.urlSerializer.serialize(E),S,P);this.events.next(k);let z=r_(this.rootComponentType).snapshot;return this.currentTransition=s=se(O({},l),{targetSnapshot:z,urlAfterRedirects:E,extras:se(O({},x),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=E,U(s)}else{let m="";return this.events.next(new Hn(l.id,this.urlSerializer.serialize(l.extractedUrl),m,cu.IgnoredByUrlHandlingStrategy)),l.resolve(!1),hn}}),ge(l=>{let h=new lu(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}),B(l=>(this.currentTransition=s=se(O({},l),{guards:Cb(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),s)),Fb(this.environmentInjector,l=>this.events.next(l)),ge(l=>{if(s.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw aa(this.urlSerializer,l.guardsResult);let h=new uu(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(h)}),Vt(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",et.GuardRejected),!1)),nu(l=>{if(l.guards.canActivateChecks.length)return U(l).pipe(ge(h=>{let p=new du(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(p)}),ht(h=>{let p=!1;return U(h).pipe(aT(this.paramsInheritanceStrategy,this.environmentInjector),ge({next:()=>p=!0,complete:()=>{p||this.cancelNavigationTransition(h,"",et.NoDataFromResolver)}}))}),ge(h=>{let p=new hu(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(p)}))}),nu(l=>{let h=p=>{let m=[];p.routeConfig?.loadComponent&&!p.routeConfig._loadedComponent&&m.push(this.configLoader.loadComponent(p.routeConfig).pipe(ge(E=>{p.component=E}),B(()=>{})));for(let E of p.children)m.push(...h(E));return m};return qi(h(l.targetSnapshot.root)).pipe(Cl(null),bt(1))}),nu(()=>this.afterPreactivation()),ht(()=>{let{currentSnapshot:l,targetSnapshot:h}=s,p=this.createViewTransition?.(this.environmentInjector,l.root,h.root);return p?We(p).pipe(B(()=>s)):U(s)}),B(l=>{let h=wb(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s=se(O({},l),{targetRouterState:h}),this.currentNavigation.targetRouterState=h,s}),ge(()=>{this.events.next(new gs)}),Ab(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),bt(1),ge({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new In(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),Oo(this.transitionAbortSubject.pipe(ge(l=>{throw l}))),jn(()=>{!a&&!c&&this.cancelNavigationTransition(s,"",et.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),fn(l=>{if(c=!0,c_(l))this.events.next(new Bt(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),Tb(l)?this.events.next(new Ur(l.url,l.navigationBehaviorOptions)):s.resolve(!1);else{let h=new ms(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0);try{let p=Ft(this.environmentInjector,()=>this.navigationErrorHandler?.(h));if(p instanceof ys){let{message:m,cancellationCode:E}=aa(this.urlSerializer,p);this.events.next(new Bt(s.id,this.urlSerializer.serialize(s.extractedUrl),m,E)),this.events.next(new Ur(p.redirectTo,p.navigationBehaviorOptions))}else throw this.events.next(h),l}catch(p){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(p)}}return hn}))}))}cancelNavigationTransition(t,r,i){let s=new Bt(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function IT(n){return n!==us}var wT=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=q({token:n,factory:()=>N(ET),providedIn:"root"})}return n})(),Du=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},ET=(()=>{class n extends Du{static \u0275fac=(()=>{let t;return function(i){return(t||(t=$n(n)))(i||n)}})();static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),g_=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=q({token:n,factory:()=>N(bT),providedIn:"root"})}return n})(),bT=(()=>{class n extends g_{location=N(qo);urlSerializer=N(Pu);options=N(Nu,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";urlHandlingStrategy=N(Vu);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new $t;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}routerState=r_(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof ps)this.stateMemento=this.createStateMemento();else if(t instanceof Hn)this.rawUrlTree=r.initialUrl;else if(t instanceof na){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else t instanceof gs?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):t instanceof Bt&&(t.code===et.GuardRejected||t.code===et.NoDataFromResolver)?this.restoreHistory(r):t instanceof ms?this.restoreHistory(r,!0):t instanceof In&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=t instanceof $t?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let s=this.browserPageId,a=O(O({},r.extras.state),this.generateNgRouterState(r.id,s));this.location.replaceState(i,"",a)}else{let s=O(O({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",s)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=$n(n)))(i||n)}})();static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),cs=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(cs||{});function TT(n,e){n.events.pipe(Vt(t=>t instanceof In||t instanceof Bt||t instanceof ms||t instanceof Hn),B(t=>t instanceof In||t instanceof Hn?cs.COMPLETE:(t instanceof Bt?t.code===et.Redirect||t.code===et.SupersededByNewNavigation:!1)?cs.REDIRECTING:cs.FAILED),Vt(t=>t!==cs.REDIRECTING),bt(1)).subscribe(()=>{e()})}var AT={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},CT={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Fu=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=N(Uo);stateManager=N(g_);options=N(Nu,{optional:!0})||{};pendingTasks=N(Um);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=N(vT);urlSerializer=N(Pu);location=N(qo);urlHandlingStrategy=N(Vu);_events=new rt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=N(wT);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=N(Ou,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!N(Mu,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Mo;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof Bt&&r.code!==et.Redirect&&r.code!==et.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof In)this.navigated=!0;else if(r instanceof Ur){let a=r.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),l=O({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||IT(i.source)},a);this.scheduleNavigation(c,us,null,l,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}RT(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),us,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},a=i?.navigationId?i:null;if(i){let l=O({},i);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(s.state=l)}let c=this.parseUrl(t);this.scheduleNavigation(c,r,a,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(xu),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:a,queryParamsHandling:c,preserveFragment:l}=r,h=l?this.currentUrlTree.fragment:a,p=null;switch(c??this.options.defaultQueryParamsHandling){case"merge":p=O(O({},this.currentUrlTree.queryParams),s);break;case"preserve":p=this.currentUrlTree.queryParams;break;default:p=s||null}p!==null&&(p=this.removeEmptyProps(p));let m;try{let E=i?i.snapshot:this.routerState.snapshot.root;m=Zg(E)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),m=this.currentUrlTree.root}return e_(m,t,p,h??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Wn(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,us,null,r)}navigate(t,r={skipLocationChange:!1}){return ST(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=O({},AT):r===!1?i=O({},CT):i=r,Wn(t))return Vg(this.currentUrlTree,t,i);let s=this.parseUrl(t);return Vg(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,a){if(this.disposed)return Promise.resolve(!1);let c,l,h;a?(c=a.resolve,l=a.reject,h=a.promise):h=new Promise((m,E)=>{c=m,l=E});let p=this.pendingTasks.add();return TT(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(p))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:c,reject:l,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(m=>Promise.reject(m))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ST(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new ue(4008,!1)}function RT(n){return!(n instanceof gs)&&!(n instanceof Ur)}var da=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;href=null;target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new rt;constructor(t,r,i,s,a,c){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=a,this.locationStrategy=c;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=t.events.subscribe(h=>{h instanceof In&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Wn(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,r,i,s,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(t!==0||r||i||s||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.href=t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;let r=this.href===null?null:Xm(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(t,r){let i=this.renderer,s=this.el.nativeElement;r!==null?i.setAttribute(s,t,r):i.removeAttribute(s,t)}get urlTree(){return this.routerLinkInput===null?null:Wn(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(r){return new(r||n)(_e(Fu),_e(Kn),Vm("tabindex"),_e(Yi),_e(mt),_e(Vl))};static \u0275dir=fe({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,i){r&1&&jt("click",function(a){return i.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),r&2&&mn("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",_t],skipLocationChange:[2,"skipLocationChange","skipLocationChange",_t],replaceUrl:[2,"replaceUrl","replaceUrl",_t],routerLink:"routerLink"},features:[Sr,Bn]})}return n})();var DT=new X("");function __(n,...e){return ft([{provide:Ou,multi:!0,useValue:n},[],{provide:Kn,useFactory:PT,deps:[Fu]},{provide:ng,multi:!0,useFactory:kT},e.map(t=>t.\u0275providers)])}function PT(n){return n.routerState.root}function kT(){let n=N(pt);return e=>{let t=n.get(Ml);if(e!==t.components[0])return;let r=n.get(Fu),i=n.get(MT);n.get(NT)===1&&r.initialNavigation(),n.get(xT,null,Dl.Optional)?.setUpPreloading(),n.get(DT,null,Dl.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var MT=new X("",{factory:()=>new rt}),NT=new X("",{providedIn:"root",factory:()=>1});var xT=new X("");var v_=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},OT=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],a=n[t++],c=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},I_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],a=i+1<n.length,c=a?n[i+1]:0,l=i+2<n.length,h=l?n[i+2]:0,p=s>>2,m=(s&3)<<4|c>>4,E=(c&15)<<2|h>>6,S=h&63;l||(S=64,a||(E=64)),r.push(t[p],t[m],t[E],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(v_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):OT(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let h=i<n.length?t[n.charAt(i)]:64;++i;let m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||h==null||m==null)throw new Uu;let E=s<<2|c>>4;if(r.push(E),h!==64){let S=c<<4&240|h>>2;if(r.push(S),m!==64){let P=h<<6&192|m;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Uu=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},VT=function(n){let e=v_(n);return I_.encodeByteArray(e,!0)},As=function(n){return VT(n).replace(/\./g,"")},Bu=function(n){try{return I_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function FT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var LT=()=>FT().__FIREBASE_DEFAULTS__,UT=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},jT=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Bu(n[1]);return e&&JSON.parse(e)},fa=()=>{try{return LT()||UT()||jT()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},$u=n=>{var e,t;return(t=(e=fa())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},w_=n=>{let e=$u(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},zu=()=>{var n;return(n=fa())===null||n===void 0?void 0:n.config},qu=n=>{var e;return(e=fa())===null||e===void 0?void 0:e[`_${n}`]};var ha=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function E_(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[As(JSON.stringify(t)),As(JSON.stringify(a)),""].join(".")}function Me(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function b_(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Me())}function BT(){var n;let e=(n=fa())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function T_(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function A_(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function C_(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function S_(){let n=Me();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function R_(){return!BT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Gu(){try{return typeof indexedDB=="object"}catch{return!1}}function D_(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var $T="FirebaseError",tt=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=$T,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,zt.prototype.create)}},zt=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?zT(s,r):"Error",c=`${this.serviceName}: ${a} (${i}).`;return new tt(i,c,r)}};function zT(n,e){return n.replace(qT,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var qT=/\{\$([^}]+)}/g;function P_(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Qn(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],a=e[i];if(y_(s)&&y_(a)){if(!Qn(s,a))return!1}else if(s!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function y_(n){return n!==null&&typeof n=="object"}function Cs(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function k_(n,e){let t=new ju(n,e);return t.subscribe.bind(t)}var ju=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");GT(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Lu),i.error===void 0&&(i.error=Lu),i.complete===void 0&&(i.complete=Lu);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function GT(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Lu(){}var Wk=4*60*60*1e3;function Qe(n){return n&&n._delegate?n._delegate:n}var lt=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Yn="[DEFAULT]";var Wu=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new ha;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HT(e))try{this.getOrInitializeService({instanceIdentifier:Yn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Yn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return v(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Yn){return this.instances.has(e)}getOptions(e=Yn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,a]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);r===c&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:WT(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Yn){return this.component?this.component.multipleInstances?e:Yn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function WT(n){return n===Yn?void 0:n}function HT(n){return n.instantiationMode==="EAGER"}var pa=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Wu(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var KT=[],Y=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(Y||{}),QT={debug:Y.DEBUG,verbose:Y.VERBOSE,info:Y.INFO,warn:Y.WARN,error:Y.ERROR,silent:Y.SILENT},YT=Y.INFO,JT={[Y.DEBUG]:"log",[Y.VERBOSE]:"log",[Y.INFO]:"info",[Y.WARN]:"warn",[Y.ERROR]:"error"},XT=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=JT[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},En=class{constructor(e){this.name=e,this._logLevel=YT,this._logHandler=XT,this._userLogHandler=null,KT.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Y))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?QT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Y.DEBUG,...e),this._logHandler(this,Y.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Y.VERBOSE,...e),this._logHandler(this,Y.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Y.INFO,...e),this._logHandler(this,Y.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Y.WARN,...e),this._logHandler(this,Y.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Y.ERROR,...e),this._logHandler(this,Y.ERROR,...e)}};var ZT=(n,e)=>e.some(t=>n instanceof t),M_,N_;function eA(){return M_||(M_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function tA(){return N_||(N_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var x_=new WeakMap,Ku=new WeakMap,O_=new WeakMap,Hu=new WeakMap,Yu=new WeakMap;function nA(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Ct(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&x_.set(t,n)}).catch(()=>{}),Yu.set(e,n),e}function rA(n){if(Ku.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});Ku.set(n,e)}var Qu={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Ku.get(n);if(e==="objectStoreNames")return n.objectStoreNames||O_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ct(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function V_(n){Qu=n(Qu)}function iA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(ma(this),e,...t);return O_.set(r,e.sort?e.sort():[e]),Ct(r)}:tA().includes(n)?function(...e){return n.apply(ma(this),e),Ct(x_.get(this))}:function(...e){return Ct(n.apply(ma(this),e))}}function sA(n){return typeof n=="function"?iA(n):(n instanceof IDBTransaction&&rA(n),ZT(n,eA())?new Proxy(n,Qu):n)}function Ct(n){if(n instanceof IDBRequest)return nA(n);if(Hu.has(n))return Hu.get(n);let e=sA(n);return e!==n&&(Hu.set(n,e),Yu.set(e,n)),e}var ma=n=>Yu.get(n);function L_(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(n,e),c=Ct(a);return r&&a.addEventListener("upgradeneeded",l=>{r(Ct(a.result),l.oldVersion,l.newVersion,Ct(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}var oA=["get","getKey","getAll","getAllKeys","count"],aA=["put","add","delete","clear"],Ju=new Map;function F_(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ju.get(e))return Ju.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=aA.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||oA.includes(t)))return;let s=function(a,...c){return v(this,null,function*(){let l=this.transaction(a,i?"readwrite":"readonly"),h=l.store;return r&&(h=h.index(c.shift())),(yield Promise.all([h[t](...c),i&&l.done]))[0]})};return Ju.set(e,s),s}V_(n=>se(O({},n),{get:(e,t,r)=>F_(e,t)||n.get(e,t,r),has:(e,t)=>!!F_(e,t)||n.has(e,t)}));var Zu=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(cA(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function cA(n){let e=n.getComponent();return e?.type==="VERSION"}var ed="@firebase/app",U_="0.10.16";var qt=new En("@firebase/app"),lA="@firebase/app-compat",uA="@firebase/analytics-compat",dA="@firebase/analytics",hA="@firebase/app-check-compat",fA="@firebase/app-check",pA="@firebase/auth",mA="@firebase/auth-compat",gA="@firebase/database",_A="@firebase/data-connect",yA="@firebase/database-compat",vA="@firebase/functions",IA="@firebase/functions-compat",wA="@firebase/installations",EA="@firebase/installations-compat",bA="@firebase/messaging",TA="@firebase/messaging-compat",AA="@firebase/performance",CA="@firebase/performance-compat",SA="@firebase/remote-config",RA="@firebase/remote-config-compat",DA="@firebase/storage",PA="@firebase/storage-compat",kA="@firebase/firestore",MA="@firebase/vertexai",NA="@firebase/firestore-compat",xA="firebase",OA="11.0.2";var td="[DEFAULT]",VA={[ed]:"fire-core",[lA]:"fire-core-compat",[dA]:"fire-analytics",[uA]:"fire-analytics-compat",[fA]:"fire-app-check",[hA]:"fire-app-check-compat",[pA]:"fire-auth",[mA]:"fire-auth-compat",[gA]:"fire-rtdb",[_A]:"fire-data-connect",[yA]:"fire-rtdb-compat",[vA]:"fire-fn",[IA]:"fire-fn-compat",[wA]:"fire-iid",[EA]:"fire-iid-compat",[bA]:"fire-fcm",[TA]:"fire-fcm-compat",[AA]:"fire-perf",[CA]:"fire-perf-compat",[SA]:"fire-rc",[RA]:"fire-rc-compat",[DA]:"fire-gcs",[PA]:"fire-gcs-compat",[kA]:"fire-fst",[NA]:"fire-fst-compat",[MA]:"fire-vertex","fire-js":"fire-js",[xA]:"fire-js-all"};var Ss=new Map,FA=new Map,nd=new Map;function j_(n,e){try{n.container.addComponent(e)}catch(t){qt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Tn(n){let e=n.name;if(nd.has(e))return qt.debug(`There were multiple attempts to register component ${e}.`),!1;nd.set(e,n);for(let t of Ss.values())j_(t,n);for(let t of FA.values())j_(t,n);return!0}function Ds(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Gt(n){return n.settings!==void 0}var LA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bn=new zt("app","Firebase",LA);var rd=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new lt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bn.create("app-deleted",{appName:this._name})}};var An=OA;function od(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:td,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw bn.create("bad-app-name",{appName:String(i)});if(t||(t=zu()),!t)throw bn.create("no-options");let s=Ss.get(i);if(s){if(Qn(t,s.options)&&Qn(r,s.config))return s;throw bn.create("duplicate-app",{appName:i})}let a=new pa(i);for(let l of nd.values())a.addComponent(l);let c=new rd(t,r,a);return Ss.set(i,c),c}function $r(n=td){let e=Ss.get(n);if(!e&&n===td&&zu())return od();if(!e)throw bn.create("no-app",{appName:n});return e}function ga(){return Array.from(Ss.values())}function Re(n,e,t){var r;let i=(r=VA[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let c=[`Unable to register library "${i}" with version "${e}":`];s&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&c.push("and"),a&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qt.warn(c.join(" "));return}Tn(new lt(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var UA="firebase-heartbeat-database",jA=1,Rs="firebase-heartbeat-store",Xu=null;function q_(){return Xu||(Xu=L_(UA,jA,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Rs)}catch(t){console.warn(t)}}}}).catch(n=>{throw bn.create("idb-open",{originalErrorMessage:n.message})})),Xu}function BA(n){return v(this,null,function*(){try{let t=(yield q_()).transaction(Rs),r=yield t.objectStore(Rs).get(G_(n));return yield t.done,r}catch(e){if(e instanceof tt)qt.warn(e.message);else{let t=bn.create("idb-get",{originalErrorMessage:e?.message});qt.warn(t.message)}}})}function B_(n,e){return v(this,null,function*(){try{let r=(yield q_()).transaction(Rs,"readwrite");yield r.objectStore(Rs).put(e,G_(n)),yield r.done}catch(t){if(t instanceof tt)qt.warn(t.message);else{let r=bn.create("idb-set",{originalErrorMessage:t?.message});qt.warn(r.message)}}})}function G_(n){return`${n.name}!${n.options.appId}`}var $A=1024,zA=30*24*60*60*1e3,id=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new sd(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return v(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=$_();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let c=new Date(a.date).valueOf();return Date.now()-c<=zA}),this._storage.overwrite(this._heartbeatsCache))}catch(r){qt.warn(r)}})}getHeartbeatsHeader(){return v(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=$_(),{heartbeatsToSend:r,unsentEntries:i}=qA(this._heartbeatsCache.heartbeats),s=As(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return qt.warn(t),""}})}};function $_(){return new Date().toISOString().substring(0,10)}function qA(n,e=$A){let t=[],r=n.slice();for(let i of n){let s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),z_(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),z_(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var sd=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return v(this,null,function*(){return Gu()?D_().then(()=>!0).catch(()=>!1):!1})}read(){return v(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield BA(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return v(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return B_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return v(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return B_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function z_(n){return As(JSON.stringify({version:2,heartbeats:n})).length}function GA(n){Tn(new lt("platform-logger",e=>new Zu(e),"PRIVATE")),Tn(new lt("heartbeat",e=>new id(e),"PRIVATE")),Re(ed,U_,n),Re(ed,U_,"esm2017"),Re("fire-js","")}GA("");var WA="firebase",HA="11.0.2";Re(WA,HA,"app");var Xn=new Dr("ANGULARFIRE2_VERSION");function ya(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var ks=(n,e)=>{let t=e?[e]:ga(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},zr=class{constructor(){return ks(KA)}},KA="app-check",_a=class{zone;delegate;constructor(e,t=Cm){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(a){i?i.runGuarded(()=>{e.apply(this,[a])}):e.apply(this,[a])};return this.delegate.schedule(s,t,r)}},ad=class{zone;pendingTasks;constructor(e,t){this.zone=e,this.pendingTasks=t}call(e,t){let r=this.zone.run(()=>this.pendingTasks.add()),i=()=>setTimeout(r,10);return t.pipe(ge({next:i,complete:i,error:i})).subscribe(e).add(i)}},qr=(()=>{class n{ngZone;pendingTasks;outsideAngular;insideAngular;constructor(t,r){this.ngZone=t,this.pendingTasks=r,this.outsideAngular=t.runOutsideAngular(()=>new _a(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new _a(typeof Zone>"u"?void 0:Zone.current,Am)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(ne(we),ne(jm))};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Ps(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function QA(n){return Ps().ngZone.runOutsideAngular(()=>n())}function Jn(n){return Ps().ngZone.run(()=>n())}function YA(n){return JA(Ps())(n)}function JA(n){return function(t){return t=t.lift(new ad(n.ngZone,n.pendingTasks)),t.pipe(Tl(n.outsideAngular),bl(n.insideAngular))}}var XA=(n,e)=>(...t)=>(e&&setTimeout(e,10),Jn(()=>n.apply(void 0,t))),vt=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=Jn(()=>Ps().pendingTasks.add())),r[s]=XA(r[s],t));let i=QA(()=>n.apply(this,r));if(!e)if(i instanceof dn){let s=Ps();return i.pipe(Tl(s.outsideAngular),bl(s.insideAngular))}else return Jn(()=>i);return i instanceof dn?i.pipe(YA):i instanceof Promise?Jn(()=>new Promise((s,a)=>{i.then(c=>Jn(()=>s(c)),c=>Jn(()=>a(c)))})):typeof i=="function"&&t?function(){return setTimeout(t,10),i.apply(this,arguments)}:Jn(()=>i)};var Wt=class{constructor(e){return e}},Zn=class{constructor(){return ga()}};function ZA(n){return n&&n.length===1?n[0]:new Wt($r())}var cd=new X("angularfire2._apps"),e0={provide:Wt,useFactory:ZA,deps:[[new He,cd]]},t0={provide:Zn,deps:[[new He,cd]]};function n0(n){return(e,t)=>{let r=t.get(Lt);Re("angularfire",Xn.full,"core"),Re("angularfire",Xn.full,"app"),Re("angular",lg.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Wt(i)}}function W_(n,...e){return ft([e0,t0,{provide:cd,useFactory:n0(n),multi:!0,deps:[we,pt,qr,...e]}])}var H_=vt(od,!0);function cy(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var ly=cy,uy=new zt("auth","Firebase",cy());var Ta=new En("@firebase/auth");function r0(n,...e){Ta.logLevel<=Y.WARN&&Ta.warn(`Auth (${An}): ${n}`,...e)}function Ia(n,...e){Ta.logLevel<=Y.ERROR&&Ta.error(`Auth (${An}): ${n}`,...e)}function Sn(n,...e){throw Rd(n,...e)}function tr(n,...e){return Rd(n,...e)}function dy(n,e,t){let r=Object.assign(Object.assign({},ly()),{[e]:t});return new zt("auth","Firebase",r).create(e,{appName:n.name})}function er(n){return dy(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Rd(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return uy.create(n,...e)}function $(n,e,...t){if(!n)throw Rd(e,...t)}function Ht(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Ia(e),new Error(e)}function Rn(n,e){n||Ht(e)}function hd(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function i0(){return K_()==="http:"||K_()==="https:"}function K_(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function s0(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(i0()||A_()||"connection"in navigator)?navigator.onLine:!0}function o0(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var nr=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Rn(t>e,"Short delay should be less than long delay!"),this.isMobile=b_()||C_()}get(){return s0()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Dd(n,e){Rn(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Aa=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ht("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ht("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ht("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var a0={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var c0=new nr(3e4,6e4);function Pd(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function Wr(s,a,c,l){return v(this,arguments,function*(n,e,t,r,i={}){return hy(n,i,()=>v(this,null,function*(){let h={},p={};r&&(e==="GET"?p=r:h={body:JSON.stringify(r)});let m=Cs(Object.assign({key:n.config.apiKey},p)).slice(1),E=yield n._getAdditionalHeaders();E["Content-Type"]="application/json",n.languageCode&&(E["X-Firebase-Locale"]=n.languageCode);let S=Object.assign({method:e,headers:E},h);return T_()||(S.referrerPolicy="no-referrer"),Aa.fetch()(fy(n,n.config.apiHost,t,m),S)}))})}function hy(n,e,t){return v(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},a0),e);try{let i=new fd(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw va(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let c=s.ok?a.errorMessage:a.error.message,[l,h]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw va(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw va(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw va(n,"user-disabled",a);let p=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw dy(n,p,h);Sn(n,p)}}catch(i){if(i instanceof tt)throw i;Sn(n,"network-request-failed",{message:String(i)})}})}function l0(s,a,c,l){return v(this,arguments,function*(n,e,t,r,i={}){let h=yield Wr(n,e,t,r,i);return"mfaPendingCredential"in h&&Sn(n,"multi-factor-auth-required",{_serverResponse:h}),h})}function fy(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?Dd(n.config,i):`${n.config.apiScheme}://${i}`}var fd=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(tr(this.auth,"network-request-failed")),c0.get())})}};function va(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=tr(n,e,r);return i.customData._tokenResponse=t,i}function u0(n,e){return v(this,null,function*(){return Wr(n,"POST","/v1/accounts:delete",e)})}function py(n,e){return v(this,null,function*(){return Wr(n,"POST","/v1/accounts:lookup",e)})}function Ms(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function kd(n,e=!1){return v(this,null,function*(){let t=Qe(n),r=yield t.getIdToken(e),i=Md(r);$(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:Ms(ld(i.auth_time)),issuedAtTime:Ms(ld(i.iat)),expirationTime:Ms(ld(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function ld(n){return Number(n)*1e3}function Md(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ia("JWT malformed, contained fewer than 3 sections"),null;try{let i=Bu(t);return i?JSON.parse(i):(Ia("Failed to decode base64 JWT payload"),null)}catch(i){return Ia("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Q_(n){let e=Md(n);return $(e,"internal-error"),$(typeof e.exp<"u","internal-error"),$(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function xs(n,e,t=!1){return v(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof tt&&d0(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function d0({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var pd=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>v(this,null,function*(){yield this.iteration()}),t)}iteration(){return v(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Os=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ms(this.lastLoginAt),this.creationTime=Ms(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Ca(n){return v(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield xs(n,py(t,{idToken:r}));$(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?my(s.providerUserInfo):[],c=h0(n.providerData,a),l=n.isAnonymous,h=!(n.email&&s.passwordHash)&&!c?.length,p=l?h:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new Os(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,m)})}function Nd(n){return v(this,null,function*(){let e=Qe(n);yield Ca(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function h0(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function my(n){return n.map(e=>{var{providerId:t}=e,r=El(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function f0(n,e){return v(this,null,function*(){let t=yield hy(n,{},()=>v(this,null,function*(){let r=Cs({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=fy(n,i,"/v1/token",`key=${s}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",Aa.fetch()(a,{method:"POST",headers:c,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function p0(n,e){return v(this,null,function*(){return Wr(n,"POST","/v2/accounts:revokeToken",Pd(n,e))})}var Ns=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){$(e.idToken,"internal-error"),$(typeof e.idToken<"u","internal-error"),$(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Q_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){$(e.length!==0,"internal-error");let t=Q_(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return v(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:($(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return v(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield f0(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new n;return r&&($(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&($(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&($(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Ht("not implemented")}};function Cn(n,e){$(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Gr=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=El(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new pd(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Os(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return v(this,null,function*(){let t=yield xs(this,this.stsTokenManager.getToken(this.auth,e));return $(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return kd(this,e)}reload(){return Nd(this)}_assign(e){this!==e&&($(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){$(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return v(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Ca(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return v(this,null,function*(){if(Gt(this.auth.app))return Promise.reject(er(this.auth));let e=yield this.getIdToken();return yield xs(this,u0(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,c,l,h,p;let m=(r=t.displayName)!==null&&r!==void 0?r:void 0,E=(i=t.email)!==null&&i!==void 0?i:void 0,S=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,P=(a=t.photoURL)!==null&&a!==void 0?a:void 0,x=(c=t.tenantId)!==null&&c!==void 0?c:void 0,k=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,z=(h=t.createdAt)!==null&&h!==void 0?h:void 0,Q=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:K,emailVerified:de,isAnonymous:ze,providerData:ce,stsTokenManager:w}=t;$(K&&w,e,"internal-error");let g=Ns.fromJSON(this.name,w);$(typeof K=="string",e,"internal-error"),Cn(m,e.name),Cn(E,e.name),$(typeof de=="boolean",e,"internal-error"),$(typeof ze=="boolean",e,"internal-error"),Cn(S,e.name),Cn(P,e.name),Cn(x,e.name),Cn(k,e.name),Cn(z,e.name),Cn(Q,e.name);let y=new n({uid:K,auth:e,email:E,emailVerified:de,displayName:m,isAnonymous:ze,photoURL:P,phoneNumber:S,tenantId:x,stsTokenManager:g,createdAt:z,lastLoginAt:Q});return ce&&Array.isArray(ce)&&(y.providerData=ce.map(I=>Object.assign({},I))),k&&(y._redirectEventId=k),y}static _fromIdTokenResponse(e,t,r=!1){return v(this,null,function*(){let i=new Ns;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Ca(s),s})}static _fromGetAccountInfoResponse(e,t,r){return v(this,null,function*(){let i=t.users[0];$(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?my(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,c=new Ns;c.updateFromIdToken(r);let l=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:a}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Os(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,h),l})}};var Y_=new Map;function Kt(n){Rn(n instanceof Function,"Expected a class definition");let e=Y_.get(n);return e?(Rn(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Y_.set(n,e),e)}var m0=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return v(this,null,function*(){return!0})}_set(t,r){return v(this,null,function*(){this.storage[t]=r})}_get(t){return v(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return v(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),md=m0;function wa(n,e,t){return`firebase:${n}:${e}:${t}`}var Sa=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=wa(this.userKey,i.apiKey,s),this.fullPersistenceKey=wa("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return v(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Gr._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return v(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return v(this,null,function*(){if(!t.length)return new n(Kt(md),e,r);let i=(yield Promise.all(t.map(h=>v(this,null,function*(){if(yield h._isAvailable())return h})))).filter(h=>h),s=i[0]||Kt(md),a=wa(r,e.config.apiKey,e.name),c=null;for(let h of t)try{let p=yield h._get(a);if(p){let m=Gr._fromJSON(e,p);h!==s&&(c=m),s=h;break}}catch{}let l=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new n(s,e,r):(s=l[0],c&&(yield s._set(a,c.toJSON())),yield Promise.all(t.map(h=>v(this,null,function*(){if(h!==s)try{yield h._remove(a)}catch{}}))),new n(s,e,r))})}};function J_(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(vy(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(gy(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(wy(e))return"Blackberry";if(Ey(e))return"Webos";if(_y(e))return"Safari";if((e.includes("chrome/")||yy(e))&&!e.includes("edge/"))return"Chrome";if(Iy(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function gy(n=Me()){return/firefox\//i.test(n)}function _y(n=Me()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function yy(n=Me()){return/crios\//i.test(n)}function vy(n=Me()){return/iemobile/i.test(n)}function Iy(n=Me()){return/android/i.test(n)}function wy(n=Me()){return/blackberry/i.test(n)}function Ey(n=Me()){return/webos/i.test(n)}function xd(n=Me()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function g0(n=Me()){var e;return xd(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function _0(){return S_()&&document.documentMode===10}function by(n=Me()){return xd(n)||Iy(n)||Ey(n)||wy(n)||/windows phone/i.test(n)||vy(n)}function Ty(n,e=[]){let t;switch(n){case"Browser":t=J_(Me());break;case"Worker":t=`${J_(Me())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${An}/${r}`}var gd=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((a,c)=>{try{let l=e(s);a(l)}catch(l){c(l)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return v(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function y0(t){return v(this,arguments,function*(n,e={}){return Wr(n,"GET","/v2/passwordPolicy",Pd(n,e))})}var v0=6,_d=class{constructor(e){var t,r,i,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:v0,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,c;let l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(c=l.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),l}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var yd=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ra(this),this.idTokenSubscription=new Ra(this),this.beforeStateQueue=new gd(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=uy,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Kt(t)),this._initializationPromise=this.queue(()=>v(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield Sa.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return v(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return v(this,null,function*(){try{let t=yield py(this,{idToken:e}),r=yield Gr._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return v(this,null,function*(){var t;if(Gt(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=i?._redirectEventId,l=yield this.tryRedirectSignIn(e);(!a||a===c)&&l?.user&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return $(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return v(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return v(this,null,function*(){try{yield Ca(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=o0()}_delete(){return v(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return v(this,null,function*(){if(Gt(this.app))return Promise.reject(er(this));let t=e?Qe(e):null;return t&&$(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return v(this,null,function*(){if(!this._deleted)return e&&$(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>v(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return v(this,null,function*(){return Gt(this.app)?Promise.reject(er(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Gt(this.app)?Promise.reject(er(this)):this.queue(()=>v(this,null,function*(){yield this.assertedPersistence.setPersistence(Kt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return v(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return v(this,null,function*(){let e=yield y0(this),t=new _d(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new zt("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return v(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield p0(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return v(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return v(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Kt(e)||this._popupRedirectResolver;$(t,this,"argument-error"),this.redirectPersistenceManager=yield Sa.create(this,[Kt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return v(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>v(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return v(this,null,function*(){if(e===this.currentUser)return this.queue(()=>v(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),a=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if($(c,this,"internal-error"),c.then(()=>{a||s(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{let l=e.addObserver(t);return()=>{a=!0,l()}}}directlySetCurrentUser(e){return v(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return $(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ty(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return v(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return v(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&r0(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Od(n){return Qe(n)}var Ra=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=k_(t=>this.observer=t)}get next(){return $(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Vd={loadJS(){return v(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function I0(n){Vd=n}function w0(n){return Vd.loadJS(n)}function E0(){return Vd.gapiScript}function Ay(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function Fd(n,e){let t=Ds(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(Qn(s,e??{}))return i;Sn(i,"already-initialized")}return t.initialize({options:e})}function b0(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Kt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function Ld(n,e,t){let r=Od(n);$(r._canInitEmulator,r,"emulator-config-failed"),$(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=Cy(e),{host:a,port:c}=T0(e),l=c===null?"":`:${c}`;r.config.emulator={url:`${s}//${a}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||A0()}function Cy(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function T0(n){let e=Cy(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:X_(r.substr(s.length+1))}}else{let[s,a]=r.split(":");return{host:s,port:X_(a)}}}function X_(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function A0(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Da=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ht("not implemented")}_getIdTokenResponse(e){return Ht("not implemented")}_linkToIdToken(e,t){return Ht("not implemented")}_getReauthenticationResolver(e){return Ht("not implemented")}};function ud(n,e){return v(this,null,function*(){return l0(n,"POST","/v1/accounts:signInWithIdp",Pd(n,e))})}var Pa=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var vd=class extends Pa{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var Vs=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return v(this,null,function*(){let s=yield Gr._fromIdTokenResponse(e,r,i),a=Z_(r);return new n({user:s,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return v(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=Z_(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function Z_(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var Id=class n extends tt{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Sy(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Id._fromErrorAndOperation(n,s,e,r):s})}function C0(n,e,t=!1){return v(this,null,function*(){let r=yield xs(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return Vs._forOperation(n,"link",r)})}function S0(n,e,t=!1){return v(this,null,function*(){let{auth:r}=n;if(Gt(r.app))return Promise.reject(er(r));let i="reauthenticate";try{let s=yield xs(n,Sy(r,i,e,n),t);$(s.idToken,r,"internal-error");let a=Md(s.idToken);$(a,r,"internal-error");let{sub:c}=a;return $(n.uid===c,r,"user-mismatch"),Vs._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Sn(r,"user-mismatch"),s}})}function R0(n,e,t=!1){return v(this,null,function*(){if(Gt(n.app))return Promise.reject(er(n));let r="signIn",i=yield Sy(n,r,e),s=yield Vs._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function Ud(n,e,t,r){return Qe(n).onIdTokenChanged(e,t,r)}function jd(n,e,t){return Qe(n).beforeAuthStateChanged(e,t)}var ka="__sak";var Ma=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ka,"1"),this.storage.removeItem(ka),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var D0=1e3,P0=10,k0=(()=>{class n extends Ma{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=by(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((c,l,h)=>{this.notifyListeners(c,h)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let c=this.storage.getItem(i);!r&&this.localCache[i]===c||this.notifyListeners(i,c)},a=this.storage.getItem(i);_0()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,P0):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},D0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return v(this,null,function*(){yield un(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return v(this,null,function*(){let r=yield un(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return v(this,null,function*(){yield un(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),Ry=k0;var M0=(()=>{class n extends Ma{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Bd=M0;function N0(n){return Promise.all(n.map(e=>v(this,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var x0=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return v(this,null,function*(){let r=t,{eventId:i,eventType:s,data:a}=r.data,c=this.handlersMap[s];if(!c?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let l=Array.from(c).map(p=>v(this,null,function*(){return p(r.origin,a)})),h=yield N0(l);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:h})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function Dy(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var wd=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return v(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((c,l)=>{let h=Dy("",20);i.port1.start();let p=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(m){let E=m;if(E.data.eventId===h)switch(E.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(E.data.response);break;default:clearTimeout(p),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function St(){return window}function O0(n){St().location.href=n}function Py(){return typeof St().WorkerGlobalScope<"u"&&typeof St().importScripts=="function"}function V0(){return v(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function F0(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function L0(){return Py()?self:null}var ky="firebaseLocalStorageDb",U0=1,Na="firebaseLocalStorage",My="fbase_key",rr=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Oa(n,e){return n.transaction([Na],e?"readwrite":"readonly").objectStore(Na)}function j0(){let n=indexedDB.deleteDatabase(ky);return new rr(n).toPromise()}function Ed(){let n=indexedDB.open(ky,U0);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Na,{keyPath:My})}catch(i){t(i)}}),n.addEventListener("success",()=>v(this,null,function*(){let r=n.result;r.objectStoreNames.contains(Na)?e(r):(r.close(),yield j0(),e(yield Ed()))}))})}function ey(n,e,t){return v(this,null,function*(){let r=Oa(n,!0).put({[My]:e,value:t});return new rr(r).toPromise()})}function B0(n,e){return v(this,null,function*(){let t=Oa(n,!1).get(e),r=yield new rr(t).toPromise();return r===void 0?null:r.value})}function ty(n,e){let t=Oa(n,!0).delete(e);return new rr(t).toPromise()}var $0=800,z0=3,q0=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return v(this,null,function*(){return this.db?this.db:(this.db=yield Ed(),this.db)})}_withRetries(t){return v(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>z0)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return v(this,null,function*(){return Py()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return v(this,null,function*(){this.receiver=x0._getInstance(L0()),this.receiver._subscribe("keyChanged",(t,r)=>v(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>v(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return v(this,null,function*(){var t,r;if(this.activeServiceWorker=yield V0(),!this.activeServiceWorker)return;this.sender=new wd(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return v(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||F0()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return v(this,null,function*(){try{if(!indexedDB)return!1;let t=yield Ed();return yield ey(t,ka,"1"),yield ty(t,ka),!0}catch{}return!1})}_withPendingWrite(t){return v(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return v(this,null,function*(){return this._withPendingWrite(()=>v(this,null,function*(){return yield this._withRetries(i=>ey(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return v(this,null,function*(){let r=yield this._withRetries(i=>B0(i,t));return this.localCache[t]=r,r})}_remove(t){return v(this,null,function*(){return this._withPendingWrite(()=>v(this,null,function*(){return yield this._withRetries(r=>ty(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return v(this,null,function*(){let t=yield this._withRetries(s=>{let a=Oa(s,!1).getAll();return new rr(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:a}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>v(this,null,function*(){return this._poll()}),$0)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),Ny=q0;var BM=Ay("rcb"),$M=new nr(3e4,6e4);function G0(n,e){return e?Kt(e):($(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Fs=class extends Da{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ud(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ud(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ud(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function W0(n){return R0(n.auth,new Fs(n),n.bypassAuthState)}function H0(n){let{auth:e,user:t}=n;return $(t,e,"internal-error"),S0(t,new Fs(n),n.bypassAuthState)}function K0(n){return v(this,null,function*(){let{auth:e,user:t}=n;return $(t,e,"internal-error"),C0(t,new Fs(n),n.bypassAuthState)})}var bd=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>v(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return v(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:c}=e;if(a){this.reject(a);return}let l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(c)(l))}catch(h){this.reject(h)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return W0;case"linkViaPopup":case"linkViaRedirect":return K0;case"reauthViaPopup":case"reauthViaRedirect":return H0;default:Sn(this.auth,"internal-error")}}resolve(e){Rn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Rn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var zM=new nr(2e3,1e4);var Q0="pendingRedirect",Ea=new Map,Td=class n extends bd{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return v(this,null,function*(){let e=Ea.get(this.auth._key());if(!e){try{let r=(yield Y0(this.resolver,this.auth))?yield un(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Ea.set(this.auth._key(),e)}return this.bypassAuthState||Ea.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return v(this,null,function*(){if(e.type==="signInViaRedirect")return un(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,un(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return v(this,null,function*(){})}cleanUp(){}};function Y0(n,e){return v(this,null,function*(){let t=Z0(e),r=X0(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function J0(n,e){Ea.set(n._key(),e)}function X0(n){return Kt(n._redirectPersistence)}function Z0(n){return wa(Q0,n.config.apiKey,n.name)}function eC(n,e,t=!1){return v(this,null,function*(){if(Gt(n.app))return Promise.reject(er(n));let r=Od(n),i=G0(r,e),a=yield new Td(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var tC=10*60*1e3,Ad=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!nC(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!xy(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(tr(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=tC&&this.cachedEventUids.clear(),this.cachedEventUids.has(ny(e))}saveEventToCache(e){this.cachedEventUids.add(ny(e)),this.lastProcessedEventTime=Date.now()}};function ny(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function xy({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function nC(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xy(n);default:return!1}}function rC(t){return v(this,arguments,function*(n,e={}){return Wr(n,"GET","/v1/projects",e)})}var iC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,sC=/^https?/;function oC(n){return v(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield rC(n);for(let t of e)try{if(aC(t))return}catch{}Sn(n,"unauthorized-domain")})}function aC(n){let e=hd(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!sC.test(t))return!1;if(iC.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var cC=new nr(3e4,6e4);function ry(){let n=St().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function lC(n){return new Promise((e,t)=>{var r,i,s;function a(){ry(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ry(),t(tr(n,"network-request-failed"))},timeout:cC.get()})}if(!((i=(r=St().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=St().gapi)===null||s===void 0)&&s.load)a();else{let c=Ay("iframefcb");return St()[c]=()=>{gapi.load?a():t(tr(n,"network-request-failed"))},w0(`${E0()}?onload=${c}`).catch(l=>t(l))}}).catch(e=>{throw ba=null,e})}var ba=null;function uC(n){return ba=ba||lC(n),ba}var dC=new nr(5e3,15e3),hC="__/auth/iframe",fC="emulator/auth/iframe",pC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},mC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gC(n){let e=n.config;$(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Dd(e,fC):`https://${n.config.authDomain}/${hC}`,r={apiKey:e.apiKey,appName:n.name,v:An},i=mC.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Cs(r).slice(1)}`}function _C(n){return v(this,null,function*(){let e=yield uC(n),t=St().gapi;return $(t,n,"internal-error"),e.open({where:document.body,url:gC(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pC,dontclear:!0},r=>new Promise((i,s)=>v(this,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=tr(n,"network-request-failed"),c=St().setTimeout(()=>{s(a)},dC.get());function l(){St().clearTimeout(c),i(r)}r.ping(l).then(l,()=>{s(a)})})))})}var yC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},vC=500,IC=600,wC="_blank",EC="http://localhost",xa=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function bC(n,e,t,r=vC,i=IC){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),c="",l=Object.assign(Object.assign({},yC),{width:r.toString(),height:i.toString(),top:s,left:a}),h=Me().toLowerCase();t&&(c=yy(h)?wC:t),gy(h)&&(e=e||EC,l.scrollbars="yes");let p=Object.entries(l).reduce((E,[S,P])=>`${E}${S}=${P},`,"");if(g0(h)&&c!=="_self")return TC(e||"",c),new xa(null);let m=window.open(e||"",c,p);$(m,n,"popup-blocked");try{m.focus()}catch{}return new xa(m)}function TC(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var AC="__/auth/handler",CC="emulator/auth/handler",SC=encodeURIComponent("fac");function iy(n,e,t,r,i,s){return v(this,null,function*(){$(n.config.authDomain,n,"auth-domain-config-required"),$(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:An,eventId:i};if(e instanceof Pa){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",P_(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,m]of Object.entries(s||{}))a[p]=m}if(e instanceof vd){let p=e.getScopes().filter(m=>m!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let c=a;for(let p of Object.keys(c))c[p]===void 0&&delete c[p];let l=yield n._getAppCheckToken(),h=l?`#${SC}=${encodeURIComponent(l)}`:"";return`${RC(n)}?${Cs(c).slice(1)}${h}`})}function RC({config:n}){return n.emulator?Dd(n,CC):`https://${n.authDomain}/${AC}`}var dd="webStorageSupport",Cd=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Bd,this._completeRedirectFn=eC,this._overrideRedirectResult=J0}_openPopup(e,t,r,i){return v(this,null,function*(){var s;Rn((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let a=yield iy(e,t,r,hd(),i);return bC(e,a,Dy())})}_openRedirect(e,t,r,i){return v(this,null,function*(){yield this._originValidation(e);let s=yield iy(e,t,r,hd(),i);return O0(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Rn(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return v(this,null,function*(){let t=yield _C(e),r=new Ad(e);return t.register("authEvent",i=>($(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(dd,{type:dd},i=>{var s;let a=(s=i?.[0])===null||s===void 0?void 0:s[dd];a!==void 0&&t(!!a),Sn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=oC(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return by()||_y()||xd()}},Oy=Cd;var sy="@firebase/auth",oy="1.8.1";var Sd=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return v(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){$(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function DC(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function PC(n){Tn(new lt("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;$(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let l={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ty(n)},h=new yd(r,i,s,l);return b0(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Tn(new lt("auth-internal",e=>{let t=Od(e.getProvider("auth").getImmediate());return(r=>new Sd(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Re(sy,oy,DC(n)),Re(sy,oy,"esm2017")}var kC=5*60,MC=qu("authIdTokenMaxAge")||kC,ay=null,NC=n=>e=>v(void 0,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>MC)return;let i=t?.token;ay!==i&&(ay=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function $d(n=$r()){let e=Ds(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Fd(n,{popupRedirectResolver:Oy,persistence:[Ny,Ry,Bd]}),r=qu("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let a=NC(s.toString());jd(t,a,()=>a(t.currentUser)),Ud(t,c=>a(c))}}let i=$u("auth");return i&&Ld(t,`http://${i}`),t}function xC(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}I0({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=tr("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",xC().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});PC("Browser");var Vy="auth",Ls=class{constructor(e){return e}},Us=class{constructor(){return ks(Vy)}};var zd=new X("angularfire2.auth-instances");function RS(n,e){let t=ya(Vy,n,e);return t&&new Ls(t)}function DS(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Ls(r)}}var PS={provide:Us,deps:[[new He,zd]]},kS={provide:Ls,useFactory:RS,deps:[[new He,zd],Wt]};function Fy(n,...e){return Re("angularfire",Xn.full,"auth"),ft([kS,PS,{provide:zd,useFactory:DS(n),multi:!0,deps:[we,pt,qr,Zn,[new He,zr],...e]}])}var Va=vt($d,!0);var Ly=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Uy={};var Dn,qd;(function(){var n;function e(w,g){function y(){}y.prototype=g.prototype,w.D=g.prototype,w.prototype=new y,w.prototype.constructor=w,w.C=function(I,b,A){for(var _=Array(arguments.length-2),Nt=2;Nt<arguments.length;Nt++)_[Nt-2]=arguments[Nt];return g.prototype[b].apply(I,_)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,g,y){y||(y=0);var I=Array(16);if(typeof g=="string")for(var b=0;16>b;++b)I[b]=g.charCodeAt(y++)|g.charCodeAt(y++)<<8|g.charCodeAt(y++)<<16|g.charCodeAt(y++)<<24;else for(b=0;16>b;++b)I[b]=g[y++]|g[y++]<<8|g[y++]<<16|g[y++]<<24;g=w.g[0],y=w.g[1],b=w.g[2];var A=w.g[3],_=g+(A^y&(b^A))+I[0]+3614090360&4294967295;g=y+(_<<7&4294967295|_>>>25),_=A+(b^g&(y^b))+I[1]+3905402710&4294967295,A=g+(_<<12&4294967295|_>>>20),_=b+(y^A&(g^y))+I[2]+606105819&4294967295,b=A+(_<<17&4294967295|_>>>15),_=y+(g^b&(A^g))+I[3]+3250441966&4294967295,y=b+(_<<22&4294967295|_>>>10),_=g+(A^y&(b^A))+I[4]+4118548399&4294967295,g=y+(_<<7&4294967295|_>>>25),_=A+(b^g&(y^b))+I[5]+1200080426&4294967295,A=g+(_<<12&4294967295|_>>>20),_=b+(y^A&(g^y))+I[6]+2821735955&4294967295,b=A+(_<<17&4294967295|_>>>15),_=y+(g^b&(A^g))+I[7]+4249261313&4294967295,y=b+(_<<22&4294967295|_>>>10),_=g+(A^y&(b^A))+I[8]+1770035416&4294967295,g=y+(_<<7&4294967295|_>>>25),_=A+(b^g&(y^b))+I[9]+2336552879&4294967295,A=g+(_<<12&4294967295|_>>>20),_=b+(y^A&(g^y))+I[10]+4294925233&4294967295,b=A+(_<<17&4294967295|_>>>15),_=y+(g^b&(A^g))+I[11]+2304563134&4294967295,y=b+(_<<22&4294967295|_>>>10),_=g+(A^y&(b^A))+I[12]+1804603682&4294967295,g=y+(_<<7&4294967295|_>>>25),_=A+(b^g&(y^b))+I[13]+4254626195&4294967295,A=g+(_<<12&4294967295|_>>>20),_=b+(y^A&(g^y))+I[14]+2792965006&4294967295,b=A+(_<<17&4294967295|_>>>15),_=y+(g^b&(A^g))+I[15]+1236535329&4294967295,y=b+(_<<22&4294967295|_>>>10),_=g+(b^A&(y^b))+I[1]+4129170786&4294967295,g=y+(_<<5&4294967295|_>>>27),_=A+(y^b&(g^y))+I[6]+3225465664&4294967295,A=g+(_<<9&4294967295|_>>>23),_=b+(g^y&(A^g))+I[11]+643717713&4294967295,b=A+(_<<14&4294967295|_>>>18),_=y+(A^g&(b^A))+I[0]+3921069994&4294967295,y=b+(_<<20&4294967295|_>>>12),_=g+(b^A&(y^b))+I[5]+3593408605&4294967295,g=y+(_<<5&4294967295|_>>>27),_=A+(y^b&(g^y))+I[10]+38016083&4294967295,A=g+(_<<9&4294967295|_>>>23),_=b+(g^y&(A^g))+I[15]+3634488961&4294967295,b=A+(_<<14&4294967295|_>>>18),_=y+(A^g&(b^A))+I[4]+3889429448&4294967295,y=b+(_<<20&4294967295|_>>>12),_=g+(b^A&(y^b))+I[9]+568446438&4294967295,g=y+(_<<5&4294967295|_>>>27),_=A+(y^b&(g^y))+I[14]+3275163606&4294967295,A=g+(_<<9&4294967295|_>>>23),_=b+(g^y&(A^g))+I[3]+4107603335&4294967295,b=A+(_<<14&4294967295|_>>>18),_=y+(A^g&(b^A))+I[8]+1163531501&4294967295,y=b+(_<<20&4294967295|_>>>12),_=g+(b^A&(y^b))+I[13]+2850285829&4294967295,g=y+(_<<5&4294967295|_>>>27),_=A+(y^b&(g^y))+I[2]+4243563512&4294967295,A=g+(_<<9&4294967295|_>>>23),_=b+(g^y&(A^g))+I[7]+1735328473&4294967295,b=A+(_<<14&4294967295|_>>>18),_=y+(A^g&(b^A))+I[12]+2368359562&4294967295,y=b+(_<<20&4294967295|_>>>12),_=g+(y^b^A)+I[5]+4294588738&4294967295,g=y+(_<<4&4294967295|_>>>28),_=A+(g^y^b)+I[8]+2272392833&4294967295,A=g+(_<<11&4294967295|_>>>21),_=b+(A^g^y)+I[11]+1839030562&4294967295,b=A+(_<<16&4294967295|_>>>16),_=y+(b^A^g)+I[14]+4259657740&4294967295,y=b+(_<<23&4294967295|_>>>9),_=g+(y^b^A)+I[1]+2763975236&4294967295,g=y+(_<<4&4294967295|_>>>28),_=A+(g^y^b)+I[4]+1272893353&4294967295,A=g+(_<<11&4294967295|_>>>21),_=b+(A^g^y)+I[7]+4139469664&4294967295,b=A+(_<<16&4294967295|_>>>16),_=y+(b^A^g)+I[10]+3200236656&4294967295,y=b+(_<<23&4294967295|_>>>9),_=g+(y^b^A)+I[13]+681279174&4294967295,g=y+(_<<4&4294967295|_>>>28),_=A+(g^y^b)+I[0]+3936430074&4294967295,A=g+(_<<11&4294967295|_>>>21),_=b+(A^g^y)+I[3]+3572445317&4294967295,b=A+(_<<16&4294967295|_>>>16),_=y+(b^A^g)+I[6]+76029189&4294967295,y=b+(_<<23&4294967295|_>>>9),_=g+(y^b^A)+I[9]+3654602809&4294967295,g=y+(_<<4&4294967295|_>>>28),_=A+(g^y^b)+I[12]+3873151461&4294967295,A=g+(_<<11&4294967295|_>>>21),_=b+(A^g^y)+I[15]+530742520&4294967295,b=A+(_<<16&4294967295|_>>>16),_=y+(b^A^g)+I[2]+3299628645&4294967295,y=b+(_<<23&4294967295|_>>>9),_=g+(b^(y|~A))+I[0]+4096336452&4294967295,g=y+(_<<6&4294967295|_>>>26),_=A+(y^(g|~b))+I[7]+1126891415&4294967295,A=g+(_<<10&4294967295|_>>>22),_=b+(g^(A|~y))+I[14]+2878612391&4294967295,b=A+(_<<15&4294967295|_>>>17),_=y+(A^(b|~g))+I[5]+4237533241&4294967295,y=b+(_<<21&4294967295|_>>>11),_=g+(b^(y|~A))+I[12]+1700485571&4294967295,g=y+(_<<6&4294967295|_>>>26),_=A+(y^(g|~b))+I[3]+2399980690&4294967295,A=g+(_<<10&4294967295|_>>>22),_=b+(g^(A|~y))+I[10]+4293915773&4294967295,b=A+(_<<15&4294967295|_>>>17),_=y+(A^(b|~g))+I[1]+2240044497&4294967295,y=b+(_<<21&4294967295|_>>>11),_=g+(b^(y|~A))+I[8]+1873313359&4294967295,g=y+(_<<6&4294967295|_>>>26),_=A+(y^(g|~b))+I[15]+4264355552&4294967295,A=g+(_<<10&4294967295|_>>>22),_=b+(g^(A|~y))+I[6]+2734768916&4294967295,b=A+(_<<15&4294967295|_>>>17),_=y+(A^(b|~g))+I[13]+1309151649&4294967295,y=b+(_<<21&4294967295|_>>>11),_=g+(b^(y|~A))+I[4]+4149444226&4294967295,g=y+(_<<6&4294967295|_>>>26),_=A+(y^(g|~b))+I[11]+3174756917&4294967295,A=g+(_<<10&4294967295|_>>>22),_=b+(g^(A|~y))+I[2]+718787259&4294967295,b=A+(_<<15&4294967295|_>>>17),_=y+(A^(b|~g))+I[9]+3951481745&4294967295,w.g[0]=w.g[0]+g&4294967295,w.g[1]=w.g[1]+(b+(_<<21&4294967295|_>>>11))&4294967295,w.g[2]=w.g[2]+b&4294967295,w.g[3]=w.g[3]+A&4294967295}r.prototype.u=function(w,g){g===void 0&&(g=w.length);for(var y=g-this.blockSize,I=this.B,b=this.h,A=0;A<g;){if(b==0)for(;A<=y;)i(this,w,A),A+=this.blockSize;if(typeof w=="string"){for(;A<g;)if(I[b++]=w.charCodeAt(A++),b==this.blockSize){i(this,I),b=0;break}}else for(;A<g;)if(I[b++]=w[A++],b==this.blockSize){i(this,I),b=0;break}}this.h=b,this.o+=g},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var g=1;g<w.length-8;++g)w[g]=0;var y=8*this.o;for(g=w.length-8;g<w.length;++g)w[g]=y&255,y/=256;for(this.u(w),w=Array(16),g=y=0;4>g;++g)for(var I=0;32>I;I+=8)w[y++]=this.g[g]>>>I&255;return w};function s(w,g){var y=c;return Object.prototype.hasOwnProperty.call(y,w)?y[w]:y[w]=g(w)}function a(w,g){this.h=g;for(var y=[],I=!0,b=w.length-1;0<=b;b--){var A=w[b]|0;I&&A==g||(y[b]=A,I=!1)}this.g=y}var c={};function l(w){return-128<=w&&128>w?s(w,function(g){return new a([g|0],0>g?-1:0)}):new a([w|0],0>w?-1:0)}function h(w){if(isNaN(w)||!isFinite(w))return m;if(0>w)return k(h(-w));for(var g=[],y=1,I=0;w>=y;I++)g[I]=w/y|0,y*=4294967296;return new a(g,0)}function p(w,g){if(w.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(w.charAt(0)=="-")return k(p(w.substring(1),g));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var y=h(Math.pow(g,8)),I=m,b=0;b<w.length;b+=8){var A=Math.min(8,w.length-b),_=parseInt(w.substring(b,b+A),g);8>A?(A=h(Math.pow(g,A)),I=I.j(A).add(h(_))):(I=I.j(y),I=I.add(h(_)))}return I}var m=l(0),E=l(1),S=l(16777216);n=a.prototype,n.m=function(){if(x(this))return-k(this).m();for(var w=0,g=1,y=0;y<this.g.length;y++){var I=this.i(y);w+=(0<=I?I:4294967296+I)*g,g*=4294967296}return w},n.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(P(this))return"0";if(x(this))return"-"+k(this).toString(w);for(var g=h(Math.pow(w,6)),y=this,I="";;){var b=de(y,g).g;y=z(y,b.j(g));var A=((0<y.g.length?y.g[0]:y.h)>>>0).toString(w);if(y=b,P(y))return A+I;for(;6>A.length;)A="0"+A;I=A+I}},n.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function P(w){if(w.h!=0)return!1;for(var g=0;g<w.g.length;g++)if(w.g[g]!=0)return!1;return!0}function x(w){return w.h==-1}n.l=function(w){return w=z(this,w),x(w)?-1:P(w)?0:1};function k(w){for(var g=w.g.length,y=[],I=0;I<g;I++)y[I]=~w.g[I];return new a(y,~w.h).add(E)}n.abs=function(){return x(this)?k(this):this},n.add=function(w){for(var g=Math.max(this.g.length,w.g.length),y=[],I=0,b=0;b<=g;b++){var A=I+(this.i(b)&65535)+(w.i(b)&65535),_=(A>>>16)+(this.i(b)>>>16)+(w.i(b)>>>16);I=_>>>16,A&=65535,_&=65535,y[b]=_<<16|A}return new a(y,y[y.length-1]&-2147483648?-1:0)};function z(w,g){return w.add(k(g))}n.j=function(w){if(P(this)||P(w))return m;if(x(this))return x(w)?k(this).j(k(w)):k(k(this).j(w));if(x(w))return k(this.j(k(w)));if(0>this.l(S)&&0>w.l(S))return h(this.m()*w.m());for(var g=this.g.length+w.g.length,y=[],I=0;I<2*g;I++)y[I]=0;for(I=0;I<this.g.length;I++)for(var b=0;b<w.g.length;b++){var A=this.i(I)>>>16,_=this.i(I)&65535,Nt=w.i(b)>>>16,Ai=w.i(b)&65535;y[2*I+2*b]+=_*Ai,Q(y,2*I+2*b),y[2*I+2*b+1]+=A*Ai,Q(y,2*I+2*b+1),y[2*I+2*b+1]+=_*Nt,Q(y,2*I+2*b+1),y[2*I+2*b+2]+=A*Nt,Q(y,2*I+2*b+2)}for(I=0;I<g;I++)y[I]=y[2*I+1]<<16|y[2*I];for(I=g;I<2*g;I++)y[I]=0;return new a(y,0)};function Q(w,g){for(;(w[g]&65535)!=w[g];)w[g+1]+=w[g]>>>16,w[g]&=65535,g++}function K(w,g){this.g=w,this.h=g}function de(w,g){if(P(g))throw Error("division by zero");if(P(w))return new K(m,m);if(x(w))return g=de(k(w),g),new K(k(g.g),k(g.h));if(x(g))return g=de(w,k(g)),new K(k(g.g),g.h);if(30<w.g.length){if(x(w)||x(g))throw Error("slowDivide_ only works with positive integers.");for(var y=E,I=g;0>=I.l(w);)y=ze(y),I=ze(I);var b=ce(y,1),A=ce(I,1);for(I=ce(I,2),y=ce(y,2);!P(I);){var _=A.add(I);0>=_.l(w)&&(b=b.add(y),A=_),I=ce(I,1),y=ce(y,1)}return g=z(w,b.j(g)),new K(b,g)}for(b=m;0<=w.l(g);){for(y=Math.max(1,Math.floor(w.m()/g.m())),I=Math.ceil(Math.log(y)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),A=h(y),_=A.j(g);x(_)||0<_.l(w);)y-=I,A=h(y),_=A.j(g);P(A)&&(A=E),b=b.add(A),w=z(w,_)}return new K(b,w)}n.A=function(w){return de(this,w).h},n.and=function(w){for(var g=Math.max(this.g.length,w.g.length),y=[],I=0;I<g;I++)y[I]=this.i(I)&w.i(I);return new a(y,this.h&w.h)},n.or=function(w){for(var g=Math.max(this.g.length,w.g.length),y=[],I=0;I<g;I++)y[I]=this.i(I)|w.i(I);return new a(y,this.h|w.h)},n.xor=function(w){for(var g=Math.max(this.g.length,w.g.length),y=[],I=0;I<g;I++)y[I]=this.i(I)^w.i(I);return new a(y,this.h^w.h)};function ze(w){for(var g=w.g.length+1,y=[],I=0;I<g;I++)y[I]=w.i(I)<<1|w.i(I-1)>>>31;return new a(y,w.h)}function ce(w,g){var y=g>>5;g%=32;for(var I=w.g.length-y,b=[],A=0;A<I;A++)b[A]=0<g?w.i(A+y)>>>g|w.i(A+y+1)<<32-g:w.i(A+y);return new a(b,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,qd=Uy.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=p,Dn=Uy.Integer=a}).apply(typeof Ly<"u"?Ly:typeof self<"u"?self:typeof window<"u"?window:{});var Fa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Qt={};var Gd,MS,Hr,Wd,js,La,Hd,Kd,Qd;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,u,d){return o==Array.prototype||o==Object.prototype||(o[u]=d.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Fa=="object"&&Fa];for(var u=0;u<o.length;++u){var d=o[u];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=t(this);function i(o,u){if(u)e:{var d=r;o=o.split(".");for(var f=0;f<o.length-1;f++){var T=o[f];if(!(T in d))break e;d=d[T]}o=o[o.length-1],f=d[o],u=u(f),u!=f&&u!=null&&e(d,o,{configurable:!0,writable:!0,value:u})}}function s(o,u){o instanceof String&&(o+="");var d=0,f=!1,T={next:function(){if(!f&&d<o.length){var C=d++;return{value:u(C,o[C]),done:!1}}return f=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(o){return o||function(){return s(this,function(u,d){return d})}});var a=a||{},c=this||self;function l(o){var u=typeof o;return u=u!="object"?u:o?Array.isArray(o)?"array":u:"null",u=="array"||u=="object"&&typeof o.length=="number"}function h(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function p(o,u,d){return o.call.apply(o.bind,arguments)}function m(o,u,d){if(!o)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,f),o.apply(u,T)}}return function(){return o.apply(u,arguments)}}function E(o,u,d){return E=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:m,E.apply(null,arguments)}function S(o,u){var d=Array.prototype.slice.call(arguments,1);return function(){var f=d.slice();return f.push.apply(f,arguments),o.apply(this,f)}}function P(o,u){function d(){}d.prototype=u.prototype,o.aa=u.prototype,o.prototype=new d,o.prototype.constructor=o,o.Qb=function(f,T,C){for(var M=Array(arguments.length-2),le=2;le<arguments.length;le++)M[le-2]=arguments[le];return u.prototype[T].apply(f,M)}}function x(o){let u=o.length;if(0<u){let d=Array(u);for(let f=0;f<u;f++)d[f]=o[f];return d}return[]}function k(o,u){for(let d=1;d<arguments.length;d++){let f=arguments[d];if(l(f)){let T=o.length||0,C=f.length||0;o.length=T+C;for(let M=0;M<C;M++)o[T+M]=f[M]}else o.push(f)}}class z{constructor(u,d){this.i=u,this.j=d,this.h=0,this.g=null}get(){let u;return 0<this.h?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function Q(o){return/^[\s\xa0]*$/.test(o)}function K(){var o=c.navigator;return o&&(o=o.userAgent)?o:""}function de(o){return de[" "](o),o}de[" "]=function(){};var ze=K().indexOf("Gecko")!=-1&&!(K().toLowerCase().indexOf("webkit")!=-1&&K().indexOf("Edge")==-1)&&!(K().indexOf("Trident")!=-1||K().indexOf("MSIE")!=-1)&&K().indexOf("Edge")==-1;function ce(o,u,d){for(let f in o)u.call(d,o[f],f,o)}function w(o,u){for(let d in o)u.call(void 0,o[d],d,o)}function g(o){let u={};for(let d in o)u[d]=o[d];return u}let y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(o,u){let d,f;for(let T=1;T<arguments.length;T++){f=arguments[T];for(d in f)o[d]=f[d];for(let C=0;C<y.length;C++)d=y[C],Object.prototype.hasOwnProperty.call(f,d)&&(o[d]=f[d])}}function b(o){var u=1;o=o.split(":");let d=[];for(;0<u&&o.length;)d.push(o.shift()),u--;return o.length&&d.push(o.join(":")),d}function A(o){c.setTimeout(()=>{throw o},0)}function _(){var o=Kc;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class Nt{constructor(){this.h=this.g=null}add(u,d){let f=Ai.get();f.set(u,d),this.h?this.h.next=f:this.g=f,this.h=f}}var Ai=new z(()=>new Ow,o=>o.reset());class Ow{constructor(){this.next=this.g=this.h=null}set(u,d){this.h=u,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let Ci,Si=!1,Kc=new Nt,Tp=()=>{let o=c.Promise.resolve(void 0);Ci=()=>{o.then(Vw)}};var Vw=()=>{for(var o;o=_();){try{o.h.call(o.g)}catch(d){A(d)}var u=Ai;u.j(o),100>u.h&&(u.h++,o.next=u.g,u.g=o)}Si=!1};function on(){this.s=this.s,this.C=this.C}on.prototype.s=!1,on.prototype.ma=function(){this.s||(this.s=!0,this.N())},on.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Fe(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}Fe.prototype.h=function(){this.defaultPrevented=!0};var Fw=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let d=()=>{};c.addEventListener("test",d,u),c.removeEventListener("test",d,u)}catch{}return o}();function Ri(o,u){if(Fe.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var d=this.type=o.type,f=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget){if(ze){e:{try{de(u.nodeName);var T=!0;break e}catch{}T=!1}T||(u=null)}}else d=="mouseover"?u=o.fromElement:d=="mouseout"&&(u=o.toElement);this.relatedTarget=u,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:Lw[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&Ri.aa.h.call(this)}}P(Ri,Fe);var Lw={2:"touch",3:"pen",4:"mouse"};Ri.prototype.h=function(){Ri.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Di="closure_listenable_"+(1e6*Math.random()|0),Uw=0;function jw(o,u,d,f,T){this.listener=o,this.proxy=null,this.src=u,this.type=d,this.capture=!!f,this.ha=T,this.key=++Uw,this.da=this.fa=!1}function mo(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function go(o){this.src=o,this.g={},this.h=0}go.prototype.add=function(o,u,d,f,T){var C=o.toString();o=this.g[C],o||(o=this.g[C]=[],this.h++);var M=Yc(o,u,f,T);return-1<M?(u=o[M],d||(u.fa=!1)):(u=new jw(u,this.src,C,!!f,T),u.fa=d,o.push(u)),u};function Qc(o,u){var d=u.type;if(d in o.g){var f=o.g[d],T=Array.prototype.indexOf.call(f,u,void 0),C;(C=0<=T)&&Array.prototype.splice.call(f,T,1),C&&(mo(u),o.g[d].length==0&&(delete o.g[d],o.h--))}}function Yc(o,u,d,f){for(var T=0;T<o.length;++T){var C=o[T];if(!C.da&&C.listener==u&&C.capture==!!d&&C.ha==f)return T}return-1}var Jc="closure_lm_"+(1e6*Math.random()|0),Xc={};function Ap(o,u,d,f,T){if(f&&f.once)return Sp(o,u,d,f,T);if(Array.isArray(u)){for(var C=0;C<u.length;C++)Ap(o,u[C],d,f,T);return null}return d=nl(d),o&&o[Di]?o.K(u,d,h(f)?!!f.capture:!!f,T):Cp(o,u,d,!1,f,T)}function Cp(o,u,d,f,T,C){if(!u)throw Error("Invalid event type");var M=h(T)?!!T.capture:!!T,le=el(o);if(le||(o[Jc]=le=new go(o)),d=le.add(u,d,f,M,C),d.proxy)return d;if(f=Bw(),d.proxy=f,f.src=o,f.listener=d,o.addEventListener)Fw||(T=M),T===void 0&&(T=!1),o.addEventListener(u.toString(),f,T);else if(o.attachEvent)o.attachEvent(Dp(u.toString()),f);else if(o.addListener&&o.removeListener)o.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return d}function Bw(){function o(d){return u.call(o.src,o.listener,d)}let u=$w;return o}function Sp(o,u,d,f,T){if(Array.isArray(u)){for(var C=0;C<u.length;C++)Sp(o,u[C],d,f,T);return null}return d=nl(d),o&&o[Di]?o.L(u,d,h(f)?!!f.capture:!!f,T):Cp(o,u,d,!0,f,T)}function Rp(o,u,d,f,T){if(Array.isArray(u))for(var C=0;C<u.length;C++)Rp(o,u[C],d,f,T);else f=h(f)?!!f.capture:!!f,d=nl(d),o&&o[Di]?(o=o.i,u=String(u).toString(),u in o.g&&(C=o.g[u],d=Yc(C,d,f,T),-1<d&&(mo(C[d]),Array.prototype.splice.call(C,d,1),C.length==0&&(delete o.g[u],o.h--)))):o&&(o=el(o))&&(u=o.g[u.toString()],o=-1,u&&(o=Yc(u,d,f,T)),(d=-1<o?u[o]:null)&&Zc(d))}function Zc(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[Di])Qc(u.i,o);else{var d=o.type,f=o.proxy;u.removeEventListener?u.removeEventListener(d,f,o.capture):u.detachEvent?u.detachEvent(Dp(d),f):u.addListener&&u.removeListener&&u.removeListener(f),(d=el(u))?(Qc(d,o),d.h==0&&(d.src=null,u[Jc]=null)):mo(o)}}}function Dp(o){return o in Xc?Xc[o]:Xc[o]="on"+o}function $w(o,u){if(o.da)o=!0;else{u=new Ri(u,this);var d=o.listener,f=o.ha||o.src;o.fa&&Zc(o),o=d.call(f,u)}return o}function el(o){return o=o[Jc],o instanceof go?o:null}var tl="__closure_events_fn_"+(1e9*Math.random()>>>0);function nl(o){return typeof o=="function"?o:(o[tl]||(o[tl]=function(u){return o.handleEvent(u)}),o[tl])}function Le(){on.call(this),this.i=new go(this),this.M=this,this.F=null}P(Le,on),Le.prototype[Di]=!0,Le.prototype.removeEventListener=function(o,u,d,f){Rp(this,o,u,d,f)};function qe(o,u){var d,f=o.F;if(f)for(d=[];f;f=f.F)d.push(f);if(o=o.M,f=u.type||u,typeof u=="string")u=new Fe(u,o);else if(u instanceof Fe)u.target=u.target||o;else{var T=u;u=new Fe(f,o),I(u,T)}if(T=!0,d)for(var C=d.length-1;0<=C;C--){var M=u.g=d[C];T=_o(M,f,!0,u)&&T}if(M=u.g=o,T=_o(M,f,!0,u)&&T,T=_o(M,f,!1,u)&&T,d)for(C=0;C<d.length;C++)M=u.g=d[C],T=_o(M,f,!1,u)&&T}Le.prototype.N=function(){if(Le.aa.N.call(this),this.i){var o=this.i,u;for(u in o.g){for(var d=o.g[u],f=0;f<d.length;f++)mo(d[f]);delete o.g[u],o.h--}}this.F=null},Le.prototype.K=function(o,u,d,f){return this.i.add(String(o),u,!1,d,f)},Le.prototype.L=function(o,u,d,f){return this.i.add(String(o),u,!0,d,f)};function _o(o,u,d,f){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();for(var T=!0,C=0;C<u.length;++C){var M=u[C];if(M&&!M.da&&M.capture==d){var le=M.listener,Oe=M.ha||M.src;M.fa&&Qc(o.i,M),T=le.call(Oe,f)!==!1&&T}}return T&&!f.defaultPrevented}function Pp(o,u,d){if(typeof o=="function")d&&(o=E(o,d));else if(o&&typeof o.handleEvent=="function")o=E(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(u)?-1:c.setTimeout(o,u||0)}function kp(o){o.g=Pp(()=>{o.g=null,o.i&&(o.i=!1,kp(o))},o.l);let u=o.h;o.h=null,o.m.apply(null,u)}class zw extends on{constructor(u,d){super(),this.m=u,this.l=d,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:kp(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Pi(o){on.call(this),this.h=o,this.g={}}P(Pi,on);var Mp=[];function Np(o){ce(o.g,function(u,d){this.g.hasOwnProperty(d)&&Zc(u)},o),o.g={}}Pi.prototype.N=function(){Pi.aa.N.call(this),Np(this)},Pi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rl=c.JSON.stringify,qw=c.JSON.parse,Gw=class{stringify(o){return c.JSON.stringify(o,void 0)}parse(o){return c.JSON.parse(o,void 0)}};function il(){}il.prototype.h=null;function xp(o){return o.h||(o.h=o.i())}function Op(){}var ki={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function sl(){Fe.call(this,"d")}P(sl,Fe);function ol(){Fe.call(this,"c")}P(ol,Fe);var xn={},Vp=null;function yo(){return Vp=Vp||new Le}xn.La="serverreachability";function Fp(o){Fe.call(this,xn.La,o)}P(Fp,Fe);function Mi(o){let u=yo();qe(u,new Fp(u))}xn.STAT_EVENT="statevent";function Lp(o,u){Fe.call(this,xn.STAT_EVENT,o),this.stat=u}P(Lp,Fe);function Ge(o){let u=yo();qe(u,new Lp(u,o))}xn.Ma="timingevent";function Up(o,u){Fe.call(this,xn.Ma,o),this.size=u}P(Up,Fe);function Ni(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){o()},u)}function xi(){this.g=!0}xi.prototype.xa=function(){this.g=!1};function Ww(o,u,d,f,T,C){o.info(function(){if(o.g)if(C)for(var M="",le=C.split("&"),Oe=0;Oe<le.length;Oe++){var re=le[Oe].split("=");if(1<re.length){var Ue=re[0];re=re[1];var je=Ue.split("_");M=2<=je.length&&je[1]=="type"?M+(Ue+"="+re+"&"):M+(Ue+"=redacted&")}}else M=null;else M=C;return"XMLHTTP REQ ("+f+") [attempt "+T+"]: "+u+`
`+d+`
`+M})}function Hw(o,u,d,f,T,C,M){o.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+T+"]: "+u+`
`+d+`
`+C+" "+M})}function vr(o,u,d,f){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+Qw(o,d)+(f?" "+f:"")})}function Kw(o,u){o.info(function(){return"TIMEOUT: "+u})}xi.prototype.info=function(){};function Qw(o,u){if(!o.g)return u;if(!u)return null;try{var d=JSON.parse(u);if(d){for(o=0;o<d.length;o++)if(Array.isArray(d[o])){var f=d[o];if(!(2>f.length)){var T=f[1];if(Array.isArray(T)&&!(1>T.length)){var C=T[0];if(C!="noop"&&C!="stop"&&C!="close")for(var M=1;M<T.length;M++)T[M]=""}}}}return rl(d)}catch{return u}}var vo={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},jp={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},al;function Io(){}P(Io,il),Io.prototype.g=function(){return new XMLHttpRequest},Io.prototype.i=function(){return{}},al=new Io;function an(o,u,d,f){this.j=o,this.i=u,this.l=d,this.R=f||1,this.U=new Pi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Bp}function Bp(){this.i=null,this.g="",this.h=!1}var $p={},cl={};function ll(o,u,d){o.L=1,o.v=To(xt(u)),o.m=d,o.P=!0,zp(o,null)}function zp(o,u){o.F=Date.now(),wo(o),o.A=xt(o.v);var d=o.A,f=o.R;Array.isArray(f)||(f=[String(f)]),rm(d.i,"t",f),o.C=0,d=o.j.J,o.h=new Bp,o.g=wm(o.j,d?u:null,!o.m),0<o.O&&(o.M=new zw(E(o.Y,o,o.g),o.O)),u=o.U,d=o.g,f=o.ca;var T="readystatechange";Array.isArray(T)||(T&&(Mp[0]=T.toString()),T=Mp);for(var C=0;C<T.length;C++){var M=Ap(d,T[C],f||u.handleEvent,!1,u.h||u);if(!M)break;u.g[M.key]=M}u=o.H?g(o.H):{},o.m?(o.u||(o.u="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,u)):(o.u="GET",o.g.ea(o.A,o.u,null,u)),Mi(),Ww(o.i,o.u,o.A,o.l,o.R,o.m)}an.prototype.ca=function(o){o=o.target;let u=this.M;u&&Ot(o)==3?u.j():this.Y(o)},an.prototype.Y=function(o){try{if(o==this.g)e:{let je=Ot(this.g);var u=this.g.Ba();let Er=this.g.Z();if(!(3>je)&&(je!=3||this.g&&(this.h.h||this.g.oa()||um(this.g)))){this.J||je!=4||u==7||(u==8||0>=Er?Mi(3):Mi(2)),ul(this);var d=this.g.Z();this.X=d;t:if(qp(this)){var f=um(this.g);o="";var T=f.length,C=Ot(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){On(this),Oi(this);var M="";break t}this.h.i=new c.TextDecoder}for(u=0;u<T;u++)this.h.h=!0,o+=this.h.i.decode(f[u],{stream:!(C&&u==T-1)});f.length=0,this.h.g+=o,this.C=0,M=this.h.g}else M=this.g.oa();if(this.o=d==200,Hw(this.i,this.u,this.A,this.l,this.R,je,d),this.o){if(this.T&&!this.K){t:{if(this.g){var le,Oe=this.g;if((le=Oe.g?Oe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(le)){var re=le;break t}}re=null}if(d=re)vr(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,dl(this,d);else{this.o=!1,this.s=3,Ge(12),On(this),Oi(this);break e}}if(this.P){d=!0;let dt;for(;!this.J&&this.C<M.length;)if(dt=Yw(this,M),dt==cl){je==4&&(this.s=4,Ge(14),d=!1),vr(this.i,this.l,null,"[Incomplete Response]");break}else if(dt==$p){this.s=4,Ge(15),vr(this.i,this.l,M,"[Invalid Chunk]"),d=!1;break}else vr(this.i,this.l,dt,null),dl(this,dt);if(qp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),je!=4||M.length!=0||this.h.h||(this.s=1,Ge(16),d=!1),this.o=this.o&&d,!d)vr(this.i,this.l,M,"[Invalid Chunked Response]"),On(this),Oi(this);else if(0<M.length&&!this.W){this.W=!0;var Ue=this.j;Ue.g==this&&Ue.ba&&!Ue.M&&(Ue.j.info("Great, no buffering proxy detected. Bytes received: "+M.length),_l(Ue),Ue.M=!0,Ge(11))}}else vr(this.i,this.l,M,null),dl(this,M);je==4&&On(this),this.o&&!this.J&&(je==4?_m(this.j,this):(this.o=!1,wo(this)))}else fE(this.g),d==400&&0<M.indexOf("Unknown SID")?(this.s=3,Ge(12)):(this.s=0,Ge(13)),On(this),Oi(this)}}}catch{}finally{}};function qp(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function Yw(o,u){var d=o.C,f=u.indexOf(`
`,d);return f==-1?cl:(d=Number(u.substring(d,f)),isNaN(d)?$p:(f+=1,f+d>u.length?cl:(u=u.slice(f,f+d),o.C=f+d,u)))}an.prototype.cancel=function(){this.J=!0,On(this)};function wo(o){o.S=Date.now()+o.I,Gp(o,o.I)}function Gp(o,u){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Ni(E(o.ba,o),u)}function ul(o){o.B&&(c.clearTimeout(o.B),o.B=null)}an.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(Kw(this.i,this.A),this.L!=2&&(Mi(),Ge(17)),On(this),this.s=2,Oi(this)):Gp(this,this.S-o)};function Oi(o){o.j.G==0||o.J||_m(o.j,o)}function On(o){ul(o);var u=o.M;u&&typeof u.ma=="function"&&u.ma(),o.M=null,Np(o.U),o.g&&(u=o.g,o.g=null,u.abort(),u.ma())}function dl(o,u){try{var d=o.j;if(d.G!=0&&(d.g==o||hl(d.h,o))){if(!o.K&&hl(d.h,o)&&d.G==3){try{var f=d.Da.g.parse(u)}catch{f=null}if(Array.isArray(f)&&f.length==3){var T=f;if(T[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<o.F)Do(d),So(d);else break e;gl(d),Ge(18)}}else d.za=T[1],0<d.za-d.T&&37500>T[2]&&d.F&&d.v==0&&!d.C&&(d.C=Ni(E(d.Za,d),6e3));if(1>=Kp(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else Fn(d,11)}else if((o.K||d.g==o)&&Do(d),!Q(u))for(T=d.Da.g.parse(u),u=0;u<T.length;u++){let re=T[u];if(d.T=re[0],re=re[1],d.G==2)if(re[0]=="c"){d.K=re[1],d.ia=re[2];let Ue=re[3];Ue!=null&&(d.la=Ue,d.j.info("VER="+d.la));let je=re[4];je!=null&&(d.Aa=je,d.j.info("SVER="+d.Aa));let Er=re[5];Er!=null&&typeof Er=="number"&&0<Er&&(f=1.5*Er,d.L=f,d.j.info("backChannelRequestTimeoutMs_="+f)),f=d;let dt=o.g;if(dt){let ko=dt.g?dt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ko){var C=f.h;C.g||ko.indexOf("spdy")==-1&&ko.indexOf("quic")==-1&&ko.indexOf("h2")==-1||(C.j=C.l,C.g=new Set,C.h&&(fl(C,C.h),C.h=null))}if(f.D){let yl=dt.g?dt.g.getResponseHeader("X-HTTP-Session-Id"):null;yl&&(f.ya=yl,he(f.I,f.D,yl))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-o.F,d.j.info("Handshake RTT: "+d.R+"ms")),f=d;var M=o;if(f.qa=Im(f,f.J?f.ia:null,f.W),M.K){Qp(f.h,M);var le=M,Oe=f.L;Oe&&(le.I=Oe),le.B&&(ul(le),wo(le)),f.g=M}else mm(f);0<d.i.length&&Ro(d)}else re[0]!="stop"&&re[0]!="close"||Fn(d,7);else d.G==3&&(re[0]=="stop"||re[0]=="close"?re[0]=="stop"?Fn(d,7):ml(d):re[0]!="noop"&&d.l&&d.l.ta(re),d.v=0)}}Mi(4)}catch{}}var Jw=class{constructor(o,u){this.g=o,this.map=u}};function Wp(o){this.l=o||10,c.PerformanceNavigationTiming?(o=c.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Hp(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Kp(o){return o.h?1:o.g?o.g.size:0}function hl(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function fl(o,u){o.g?o.g.add(u):o.h=u}function Qp(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}Wp.prototype.cancel=function(){if(this.i=Yp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function Yp(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let u=o.i;for(let d of o.g.values())u=u.concat(d.D);return u}return x(o.i)}function Xw(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(l(o)){for(var u=[],d=o.length,f=0;f<d;f++)u.push(o[f]);return u}u=[],d=0;for(f in o)u[d++]=o[f];return u}function Zw(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(l(o)||typeof o=="string"){var u=[];o=o.length;for(var d=0;d<o;d++)u.push(d);return u}u=[],d=0;for(let f in o)u[d++]=f;return u}}}function Jp(o,u){if(o.forEach&&typeof o.forEach=="function")o.forEach(u,void 0);else if(l(o)||typeof o=="string")Array.prototype.forEach.call(o,u,void 0);else for(var d=Zw(o),f=Xw(o),T=f.length,C=0;C<T;C++)u.call(void 0,f[C],d&&d[C],o)}var Xp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function eE(o,u){if(o){o=o.split("&");for(var d=0;d<o.length;d++){var f=o[d].indexOf("="),T=null;if(0<=f){var C=o[d].substring(0,f);T=o[d].substring(f+1)}else C=o[d];u(C,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function Vn(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Vn){this.h=o.h,Eo(this,o.j),this.o=o.o,this.g=o.g,bo(this,o.s),this.l=o.l;var u=o.i,d=new Li;d.i=u.i,u.g&&(d.g=new Map(u.g),d.h=u.h),Zp(this,d),this.m=o.m}else o&&(u=String(o).match(Xp))?(this.h=!1,Eo(this,u[1]||"",!0),this.o=Vi(u[2]||""),this.g=Vi(u[3]||"",!0),bo(this,u[4]),this.l=Vi(u[5]||"",!0),Zp(this,u[6]||"",!0),this.m=Vi(u[7]||"")):(this.h=!1,this.i=new Li(null,this.h))}Vn.prototype.toString=function(){var o=[],u=this.j;u&&o.push(Fi(u,em,!0),":");var d=this.g;return(d||u=="file")&&(o.push("//"),(u=this.o)&&o.push(Fi(u,em,!0),"@"),o.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&o.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&o.push("/"),o.push(Fi(d,d.charAt(0)=="/"?rE:nE,!0))),(d=this.i.toString())&&o.push("?",d),(d=this.m)&&o.push("#",Fi(d,sE)),o.join("")};function xt(o){return new Vn(o)}function Eo(o,u,d){o.j=d?Vi(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function bo(o,u){if(u){if(u=Number(u),isNaN(u)||0>u)throw Error("Bad port number "+u);o.s=u}else o.s=null}function Zp(o,u,d){u instanceof Li?(o.i=u,oE(o.i,o.h)):(d||(u=Fi(u,iE)),o.i=new Li(u,o.h))}function he(o,u,d){o.i.set(u,d)}function To(o){return he(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function Vi(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Fi(o,u,d){return typeof o=="string"?(o=encodeURI(o).replace(u,tE),d&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function tE(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var em=/[#\/\?@]/g,nE=/[#\?:]/g,rE=/[#\?]/g,iE=/[#\?@]/g,sE=/#/g;function Li(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function cn(o){o.g||(o.g=new Map,o.h=0,o.i&&eE(o.i,function(u,d){o.add(decodeURIComponent(u.replace(/\+/g," ")),d)}))}n=Li.prototype,n.add=function(o,u){cn(this),this.i=null,o=Ir(this,o);var d=this.g.get(o);return d||this.g.set(o,d=[]),d.push(u),this.h+=1,this};function tm(o,u){cn(o),u=Ir(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function nm(o,u){return cn(o),u=Ir(o,u),o.g.has(u)}n.forEach=function(o,u){cn(this),this.g.forEach(function(d,f){d.forEach(function(T){o.call(u,T,f,this)},this)},this)},n.na=function(){cn(this);let o=Array.from(this.g.values()),u=Array.from(this.g.keys()),d=[];for(let f=0;f<u.length;f++){let T=o[f];for(let C=0;C<T.length;C++)d.push(u[f])}return d},n.V=function(o){cn(this);let u=[];if(typeof o=="string")nm(this,o)&&(u=u.concat(this.g.get(Ir(this,o))));else{o=Array.from(this.g.values());for(let d=0;d<o.length;d++)u=u.concat(o[d])}return u},n.set=function(o,u){return cn(this),this.i=null,o=Ir(this,o),nm(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},n.get=function(o,u){return o?(o=this.V(o),0<o.length?String(o[0]):u):u};function rm(o,u,d){tm(o,u),0<d.length&&(o.i=null,o.g.set(Ir(o,u),x(d)),o.h+=d.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],u=Array.from(this.g.keys());for(var d=0;d<u.length;d++){var f=u[d];let C=encodeURIComponent(String(f)),M=this.V(f);for(f=0;f<M.length;f++){var T=C;M[f]!==""&&(T+="="+encodeURIComponent(String(M[f]))),o.push(T)}}return this.i=o.join("&")};function Ir(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function oE(o,u){u&&!o.j&&(cn(o),o.i=null,o.g.forEach(function(d,f){var T=f.toLowerCase();f!=T&&(tm(this,f),rm(this,T,d))},o)),o.j=u}function aE(o,u){let d=new xi;if(c.Image){let f=new Image;f.onload=S(ln,d,"TestLoadImage: loaded",!0,u,f),f.onerror=S(ln,d,"TestLoadImage: error",!1,u,f),f.onabort=S(ln,d,"TestLoadImage: abort",!1,u,f),f.ontimeout=S(ln,d,"TestLoadImage: timeout",!1,u,f),c.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=o}else u(!1)}function cE(o,u){let d=new xi,f=new AbortController,T=setTimeout(()=>{f.abort(),ln(d,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:f.signal}).then(C=>{clearTimeout(T),C.ok?ln(d,"TestPingServer: ok",!0,u):ln(d,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(T),ln(d,"TestPingServer: error",!1,u)})}function ln(o,u,d,f,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),f(d)}catch{}}function lE(){this.g=new Gw}function uE(o,u,d){let f=d||"";try{Jp(o,function(T,C){let M=T;h(T)&&(M=rl(T)),u.push(f+C+"="+encodeURIComponent(M))})}catch(T){throw u.push(f+"type="+encodeURIComponent("_badmap")),T}}function Ui(o){this.l=o.Ub||null,this.j=o.eb||!1}P(Ui,il),Ui.prototype.g=function(){return new Ao(this.l,this.j)},Ui.prototype.i=function(o){return function(){return o}}({});function Ao(o,u){Le.call(this),this.D=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}P(Ao,Le),n=Ao.prototype,n.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=u,this.readyState=1,Bi(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let u={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(u.body=o),(this.D||c).fetch(new Request(this.A,u)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ji(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Bi(this)),this.g&&(this.readyState=3,Bi(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;im(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function im(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.v.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?ji(this):Bi(this),this.readyState==3&&im(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,ji(this))},n.Qa=function(o){this.g&&(this.response=o,ji(this))},n.ga=function(){this.g&&ji(this)};function ji(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Bi(o)}n.setRequestHeader=function(o,u){this.u.append(o,u)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],u=this.h.entries();for(var d=u.next();!d.done;)d=d.value,o.push(d[0]+": "+d[1]),d=u.next();return o.join(`\r
`)};function Bi(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Ao.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function sm(o){let u="";return ce(o,function(d,f){u+=f,u+=":",u+=d,u+=`\r
`}),u}function pl(o,u,d){e:{for(f in d){var f=!1;break e}f=!0}f||(d=sm(d),typeof o=="string"?d!=null&&encodeURIComponent(String(d)):he(o,u,d))}function ve(o){Le.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}P(ve,Le);var dE=/^https?$/i,hE=["POST","PUT"];n=ve.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,u,d,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():al.g(),this.v=this.o?xp(this.o):xp(al),this.g.onreadystatechange=E(this.Ea,this);try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(C){om(this,C);return}if(o=d||"",d=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var T in f)d.set(T,f[T]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let C of f.keys())d.set(C,f.get(C));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(d.keys()).find(C=>C.toLowerCase()=="content-type"),T=c.FormData&&o instanceof c.FormData,!(0<=Array.prototype.indexOf.call(hE,u,void 0))||f||T||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[C,M]of d)this.g.setRequestHeader(C,M);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{lm(this),this.u=!0,this.g.send(o),this.u=!1}catch(C){om(this,C)}};function om(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.m=5,am(o),Co(o)}function am(o){o.A||(o.A=!0,qe(o,"complete"),qe(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,qe(this,"complete"),qe(this,"abort"),Co(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Co(this,!0)),ve.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?cm(this):this.bb())},n.bb=function(){cm(this)};function cm(o){if(o.h&&typeof a<"u"&&(!o.v[1]||Ot(o)!=4||o.Z()!=2)){if(o.u&&Ot(o)==4)Pp(o.Ea,0,o);else if(qe(o,"readystatechange"),Ot(o)==4){o.h=!1;try{let M=o.Z();e:switch(M){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var d;if(!(d=u)){var f;if(f=M===0){var T=String(o.D).match(Xp)[1]||null;!T&&c.self&&c.self.location&&(T=c.self.location.protocol.slice(0,-1)),f=!dE.test(T?T.toLowerCase():"")}d=f}if(d)qe(o,"complete"),qe(o,"success");else{o.m=6;try{var C=2<Ot(o)?o.g.statusText:""}catch{C=""}o.l=C+" ["+o.Z()+"]",am(o)}}finally{Co(o)}}}}function Co(o,u){if(o.g){lm(o);let d=o.g,f=o.v[0]?()=>{}:null;o.g=null,o.v=null,u||qe(o,"ready");try{d.onreadystatechange=f}catch{}}}function lm(o){o.I&&(c.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function Ot(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<Ot(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),qw(u)}};function um(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function fE(o){let u={};o=(o.g&&2<=Ot(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<o.length;f++){if(Q(o[f]))continue;var d=b(o[f]);let T=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let C=u[T]||[];u[T]=C,C.push(d)}w(u,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function $i(o,u,d){return d&&d.internalChannelParams&&d.internalChannelParams[o]||u}function dm(o){this.Aa=0,this.i=[],this.j=new xi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=$i("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=$i("baseRetryDelayMs",5e3,o),this.cb=$i("retryDelaySeedMs",1e4,o),this.Wa=$i("forwardChannelMaxRetries",2,o),this.wa=$i("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Wp(o&&o.concurrentRequestLimit),this.Da=new lE,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=dm.prototype,n.la=8,n.G=1,n.connect=function(o,u,d,f){Ge(0),this.W=o,this.H=u||{},d&&f!==void 0&&(this.H.OSID=d,this.H.OAID=f),this.F=this.X,this.I=Im(this,null,this.W),Ro(this)};function ml(o){if(hm(o),o.G==3){var u=o.U++,d=xt(o.I);if(he(d,"SID",o.K),he(d,"RID",u),he(d,"TYPE","terminate"),zi(o,d),u=new an(o,o.j,u),u.L=2,u.v=To(xt(d)),d=!1,c.navigator&&c.navigator.sendBeacon)try{d=c.navigator.sendBeacon(u.v.toString(),"")}catch{}!d&&c.Image&&(new Image().src=u.v,d=!0),d||(u.g=wm(u.j,null),u.g.ea(u.v)),u.F=Date.now(),wo(u)}vm(o)}function So(o){o.g&&(_l(o),o.g.cancel(),o.g=null)}function hm(o){So(o),o.u&&(c.clearTimeout(o.u),o.u=null),Do(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&c.clearTimeout(o.s),o.s=null)}function Ro(o){if(!Hp(o.h)&&!o.s){o.s=!0;var u=o.Ga;Ci||Tp(),Si||(Ci(),Si=!0),Kc.add(u,o),o.B=0}}function pE(o,u){return Kp(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=u.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Ni(E(o.Ga,o,u),ym(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let T=new an(this,this.j,o),C=this.o;if(this.S&&(C?(C=g(C),I(C,this.S)):C=this.S),this.m!==null||this.O||(T.H=C,C=null),this.P)e:{for(var u=0,d=0;d<this.i.length;d++){t:{var f=this.i[d];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(u+=f,4096<u){u=d;break e}if(u===4096||d===this.i.length-1){u=d+1;break e}}u=1e3}else u=1e3;u=pm(this,T,u),d=xt(this.I),he(d,"RID",o),he(d,"CVER",22),this.D&&he(d,"X-HTTP-Session-Id",this.D),zi(this,d),C&&(this.O?u="headers="+encodeURIComponent(String(sm(C)))+"&"+u:this.m&&pl(d,this.m,C)),fl(this.h,T),this.Ua&&he(d,"TYPE","init"),this.P?(he(d,"$req",u),he(d,"SID","null"),T.T=!0,ll(T,d,null)):ll(T,d,u),this.G=2}}else this.G==3&&(o?fm(this,o):this.i.length==0||Hp(this.h)||fm(this))};function fm(o,u){var d;u?d=u.l:d=o.U++;let f=xt(o.I);he(f,"SID",o.K),he(f,"RID",d),he(f,"AID",o.T),zi(o,f),o.m&&o.o&&pl(f,o.m,o.o),d=new an(o,o.j,d,o.B+1),o.m===null&&(d.H=o.o),u&&(o.i=u.D.concat(o.i)),u=pm(o,d,1e3),d.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),fl(o.h,d),ll(d,f,u)}function zi(o,u){o.H&&ce(o.H,function(d,f){he(u,f,d)}),o.l&&Jp({},function(d,f){he(u,f,d)})}function pm(o,u,d){d=Math.min(o.i.length,d);var f=o.l?E(o.l.Na,o.l,o):null;e:{var T=o.i;let C=-1;for(;;){let M=["count="+d];C==-1?0<d?(C=T[0].g,M.push("ofs="+C)):C=0:M.push("ofs="+C);let le=!0;for(let Oe=0;Oe<d;Oe++){let re=T[Oe].g,Ue=T[Oe].map;if(re-=C,0>re)C=Math.max(0,T[Oe].g-100),le=!1;else try{uE(Ue,M,"req"+re+"_")}catch{f&&f(Ue)}}if(le){f=M.join("&");break e}}}return o=o.i.splice(0,d),u.D=o,f}function mm(o){if(!o.g&&!o.u){o.Y=1;var u=o.Fa;Ci||Tp(),Si||(Ci(),Si=!0),Kc.add(u,o),o.v=0}}function gl(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Ni(E(o.Fa,o),ym(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,gm(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Ni(E(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ge(10),So(this),gm(this))};function _l(o){o.A!=null&&(c.clearTimeout(o.A),o.A=null)}function gm(o){o.g=new an(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var u=xt(o.qa);he(u,"RID","rpc"),he(u,"SID",o.K),he(u,"AID",o.T),he(u,"CI",o.F?"0":"1"),!o.F&&o.ja&&he(u,"TO",o.ja),he(u,"TYPE","xmlhttp"),zi(o,u),o.m&&o.o&&pl(u,o.m,o.o),o.L&&(o.g.I=o.L);var d=o.g;o=o.ia,d.L=1,d.v=To(xt(u)),d.m=null,d.P=!0,zp(d,o)}n.Za=function(){this.C!=null&&(this.C=null,So(this),gl(this),Ge(19))};function Do(o){o.C!=null&&(c.clearTimeout(o.C),o.C=null)}function _m(o,u){var d=null;if(o.g==u){Do(o),_l(o),o.g=null;var f=2}else if(hl(o.h,u))d=u.D,Qp(o.h,u),f=1;else return;if(o.G!=0){if(u.o)if(f==1){d=u.m?u.m.length:0,u=Date.now()-u.F;var T=o.B;f=yo(),qe(f,new Up(f,d)),Ro(o)}else mm(o);else if(T=u.s,T==3||T==0&&0<u.X||!(f==1&&pE(o,u)||f==2&&gl(o)))switch(d&&0<d.length&&(u=o.h,u.i=u.i.concat(d)),T){case 1:Fn(o,5);break;case 4:Fn(o,10);break;case 3:Fn(o,6);break;default:Fn(o,2)}}}function ym(o,u){let d=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(d*=2),d*u}function Fn(o,u){if(o.j.info("Error code "+u),u==2){var d=E(o.fb,o),f=o.Xa;let T=!f;f=new Vn(f||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Eo(f,"https"),To(f),T?aE(f.toString(),d):cE(f.toString(),d)}else Ge(2);o.G=0,o.l&&o.l.sa(u),vm(o),hm(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Ge(2)):(this.j.info("Failed to ping google.com"),Ge(1))};function vm(o){if(o.G=0,o.ka=[],o.l){let u=Yp(o.h);(u.length!=0||o.i.length!=0)&&(k(o.ka,u),k(o.ka,o.i),o.h.i.length=0,x(o.i),o.i.length=0),o.l.ra()}}function Im(o,u,d){var f=d instanceof Vn?xt(d):new Vn(d);if(f.g!="")u&&(f.g=u+"."+f.g),bo(f,f.s);else{var T=c.location;f=T.protocol,u=u?u+"."+T.hostname:T.hostname,T=+T.port;var C=new Vn(null);f&&Eo(C,f),u&&(C.g=u),T&&bo(C,T),d&&(C.l=d),f=C}return d=o.D,u=o.ya,d&&u&&he(f,d,u),he(f,"VER",o.la),zi(o,f),f}function wm(o,u,d){if(u&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Ca&&!o.pa?new ve(new Ui({eb:d})):new ve(o.pa),u.Ha(o.J),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Em(){}n=Em.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Po(){}Po.prototype.g=function(o,u){return new Je(o,u)};function Je(o,u){Le.call(this),this.g=new dm(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.va&&(o?o["X-WebChannel-Client-Profile"]=u.va:o={"X-WebChannel-Client-Profile":u.va}),this.g.S=o,(o=u&&u.Sb)&&!Q(o)&&(this.g.m=o),this.v=u&&u.supportsCrossDomainXhr||!1,this.u=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!Q(u)&&(this.g.D=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new wr(this)}P(Je,Le),Je.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Je.prototype.close=function(){ml(this.g)},Je.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var d={};d.__data__=o,o=d}else this.u&&(d={},d.__data__=rl(o),o=d);u.i.push(new Jw(u.Ya++,o)),u.G==3&&Ro(u)},Je.prototype.N=function(){this.g.l=null,delete this.j,ml(this.g),delete this.g,Je.aa.N.call(this)};function bm(o){sl.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(let d in u){o=d;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}P(bm,sl);function Tm(){ol.call(this),this.status=1}P(Tm,ol);function wr(o){this.g=o}P(wr,Em),wr.prototype.ua=function(){qe(this.g,"a")},wr.prototype.ta=function(o){qe(this.g,new bm(o))},wr.prototype.sa=function(o){qe(this.g,new Tm)},wr.prototype.ra=function(){qe(this.g,"b")},Po.prototype.createWebChannel=Po.prototype.g,Je.prototype.send=Je.prototype.o,Je.prototype.open=Je.prototype.m,Je.prototype.close=Je.prototype.close,Qd=Qt.createWebChannelTransport=function(){return new Po},Kd=Qt.getStatEventTarget=function(){return yo()},Hd=Qt.Event=xn,La=Qt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},vo.NO_ERROR=0,vo.TIMEOUT=8,vo.HTTP_ERROR=6,js=Qt.ErrorCode=vo,jp.COMPLETE="complete",Wd=Qt.EventType=jp,Op.EventType=ki,ki.OPEN="a",ki.CLOSE="b",ki.ERROR="c",ki.MESSAGE="d",Le.prototype.listen=Le.prototype.K,Hr=Qt.WebChannel=Op,MS=Qt.FetchXmlHttpFactory=Ui,ve.prototype.listenOnce=ve.prototype.L,ve.prototype.getLastError=ve.prototype.Ka,ve.prototype.getLastErrorCode=ve.prototype.Ba,ve.prototype.getStatus=ve.prototype.Z,ve.prototype.getResponseJson=ve.prototype.Oa,ve.prototype.getResponseText=ve.prototype.oa,ve.prototype.send=ve.prototype.ea,ve.prototype.setWithCredentials=ve.prototype.Ha,Gd=Qt.XhrIo=ve}).apply(typeof Fa<"u"?Fa:typeof self<"u"?self:typeof window<"u"?window:{});var jy="@firebase/firestore";var Ne=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ne.UNAUTHENTICATED=new Ne(null),Ne.GOOGLE_CREDENTIALS=new Ne("google-credentials-uid"),Ne.FIRST_PARTY=new Ne("first-party-uid"),Ne.MOCK_USER=new Ne("mock-user");var gi="11.0.2";var cr=new En("@firebase/firestore");function Kr(){return cr.logLevel}function V(n,...e){if(cr.logLevel<=Y.DEBUG){let t=e.map(Lf);cr.debug(`Firestore (${gi}): ${n}`,...t)}}function Jt(n,...e){if(cr.logLevel<=Y.ERROR){let t=e.map(Lf);cr.error(`Firestore (${gi}): ${n}`,...t)}}function ni(n,...e){if(cr.logLevel<=Y.WARN){let t=e.map(Lf);cr.warn(`Firestore (${gi}): ${n}`,...t)}}function Lf(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function j(n="Unexpected state"){let e=`FIRESTORE (${gi}) INTERNAL ASSERTION FAILED: `+n;throw Jt(e),new Error(e)}function ae(n,e){n||j()}function G(n,e){return n}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},F=class extends tt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Yt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Ga=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},eh=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ne.UNAUTHENTICATED))}shutdown(){}},th=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},nh=class{constructor(e){this.t=e,this.currentUser=Ne.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ae(this.o===void 0);let r=this.i,i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve(),s=new Yt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Yt,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let l=s;e.enqueueRetryable(()=>v(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},c=l=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?c(l):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Yt)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ae(typeof r.accessToken=="string"),new Ga(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return ae(e===null||typeof e=="string"),new Ne(e)}},rh=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Ne.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);let e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}},ih=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new rh(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Ne.FIRST_PARTY))}shutdown(){}invalidateToken(){}},sh=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},oh=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){ae(this.o===void 0);let r=s=>{s.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,V("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ae(typeof t.token=="string"),this.R=t.token,new sh(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function NS(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Wa=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=NS(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function ee(n,e){return n<e?-1:n>e?1:0}function ri(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var De=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new F(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new F(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new F(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new F(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var W=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new De(0,0))}static max(){return new n(new De(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Ha=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&j(),r===void 0?r=e.length-t:r>e.length-t&&j(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},ye=class n extends Ha{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new F(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},xS=/^[_a-zA-Z][_a-zA-Z0-9]*$/,nt=class n extends Ha{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return xS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new F(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let c=e[i];if(c==="\\"){if(i+1===e.length)throw new F(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new F(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else c==="`"?(a=!a,i++):c!=="."||a?(r+=c,i++):(s(),i++)}if(s(),a)throw new F(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var L=class n{constructor(e){this.path=e}static fromPath(e){return new n(ye.fromString(e))}static fromName(e){return new n(ye.fromString(e).popFirst(5))}static empty(){return new n(ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ye.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ye(e.slice()))}};var ah=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};ah.UNKNOWN_ID=-1;function OS(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=W.fromTimestamp(r===1e9?new De(t+1,0):new De(t,r));return new lr(i,L.empty(),e)}function VS(n){return new lr(n.readTime,n.key,-1)}var lr=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(W.min(),L.empty(),-1)}static max(){return new n(W.max(),L.empty(),-1)}};function FS(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=L.comparator(n.documentKey,e.documentKey),t!==0?t:ee(n.largestBatchId,e.largestBatchId))}var LS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ch=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function _i(n){return v(this,null,function*(){if(n.code!==R.FAILED_PRECONDITION||n.message!==LS)throw n;V("LocalStore","Unexpectedly lost primary lease")})}var D=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&j(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,a=!1;e.forEach(c=>{++i,c.next(()=>{++s,a&&s===i&&t()},l=>r(l))}),a=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,a=new Array(s),c=0;for(let l=0;l<s;l++){let h=l;t(e[h]).next(p=>{a[h]=p,++c,c===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function US(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function yi(n){return n.name==="IndexedDbTransactionError"}var Uf=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function bc(n){return n==null}function Ws(n){return n===0&&1/n==-1/0}function jS(n){return typeof n=="number"&&Number.isInteger(n)&&!Ws(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function BS(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=By(e)),e=$S(n.get(t),e);return By(e)}function $S(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function By(n){return n+""}var zS=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],$N=[...zS,"documentOverlays"],qS=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],GS=qS,WS=[...GS,"indexConfiguration","indexState","indexEntries"];var zN=[...WS,"globals"];function $y(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function pr(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function bv(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ie=class n{constructor(e,t){this.comparator=e,this.root=t||Dt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Dt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Dt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Xr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Xr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Xr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Xr(this.root,e,this.comparator,!0)}},Xr=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Dt=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw j();let e=this.left.check();if(e!==this.right.check())throw j();return e+(this.isRed()?0:1)}};Dt.EMPTY=null,Dt.RED=!0,Dt.BLACK=!1;Dt.EMPTY=new class{constructor(){this.size=0}get key(){throw j()}get value(){throw j()}get color(){throw j()}get left(){throw j()}get right(){throw j()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Dt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var xe=class n{constructor(e){this.comparator=e,this.data=new Ie(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ka(this.data.getIterator())}getIteratorFrom(e){return new Ka(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Ka=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Rt=class n{constructor(e){this.fields=e,e.sort(nt.comparator)}static empty(){return new n([])}unionWith(e){let t=new xe(nt.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ri(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Qa=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var $e=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Qa("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};$e.EMPTY_BYTE_STRING=new $e("");var HS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xt(n){if(ae(!!n),typeof n=="string"){let e=0,t=HS.exec(n);if(ae(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:me(n.seconds),nanos:me(n.nanos)}}function me(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Zt(n){return typeof n=="string"?$e.fromBase64String(n):$e.fromUint8Array(n)}function jf(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Tc(n){let e=n.mapValue.fields.__previous_value__;return jf(e)?Tc(e):e}function Hs(n){let e=Xt(n.mapValue.fields.__local_write_time__.timestampValue);return new De(e.seconds,e.nanos)}var lh=class{constructor(e,t,r,i,s,a,c,l,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=h}},Ya=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Ua={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function kn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?jf(n)?4:Av(n)?9007199254740991:Tv(n)?10:11:j()}function Mt(n,e){if(n===e)return!0;let t=kn(n);if(t!==kn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Hs(n).isEqual(Hs(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=Xt(i.timestampValue),c=Xt(s.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Zt(i.bytesValue).isEqual(Zt(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return me(i.geoPointValue.latitude)===me(s.geoPointValue.latitude)&&me(i.geoPointValue.longitude)===me(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return me(i.integerValue)===me(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=me(i.doubleValue),c=me(s.doubleValue);return a===c?Ws(a)===Ws(c):isNaN(a)&&isNaN(c)}return!1}(n,e);case 9:return ri(n.arrayValue.values||[],e.arrayValue.values||[],Mt);case 10:case 11:return function(i,s){let a=i.mapValue.fields||{},c=s.mapValue.fields||{};if($y(a)!==$y(c))return!1;for(let l in a)if(a.hasOwnProperty(l)&&(c[l]===void 0||!Mt(a[l],c[l])))return!1;return!0}(n,e);default:return j()}}function Ks(n,e){return(n.values||[]).find(t=>Mt(t,e))!==void 0}function ii(n,e){if(n===e)return 0;let t=kn(n),r=kn(e);if(t!==r)return ee(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ee(n.booleanValue,e.booleanValue);case 2:return function(s,a){let c=me(s.integerValue||s.doubleValue),l=me(a.integerValue||a.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1}(n,e);case 3:return zy(n.timestampValue,e.timestampValue);case 4:return zy(Hs(n),Hs(e));case 5:return ee(n.stringValue,e.stringValue);case 6:return function(s,a){let c=Zt(s),l=Zt(a);return c.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){let c=s.split("/"),l=a.split("/");for(let h=0;h<c.length&&h<l.length;h++){let p=ee(c[h],l[h]);if(p!==0)return p}return ee(c.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){let c=ee(me(s.latitude),me(a.latitude));return c!==0?c:ee(me(s.longitude),me(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return qy(n.arrayValue,e.arrayValue);case 10:return function(s,a){var c,l,h,p;let m=s.fields||{},E=a.fields||{},S=(c=m.value)===null||c===void 0?void 0:c.arrayValue,P=(l=E.value)===null||l===void 0?void 0:l.arrayValue,x=ee(((h=S?.values)===null||h===void 0?void 0:h.length)||0,((p=P?.values)===null||p===void 0?void 0:p.length)||0);return x!==0?x:qy(S,P)}(n.mapValue,e.mapValue);case 11:return function(s,a){if(s===Ua.mapValue&&a===Ua.mapValue)return 0;if(s===Ua.mapValue)return 1;if(a===Ua.mapValue)return-1;let c=s.fields||{},l=Object.keys(c),h=a.fields||{},p=Object.keys(h);l.sort(),p.sort();for(let m=0;m<l.length&&m<p.length;++m){let E=ee(l[m],p[m]);if(E!==0)return E;let S=ii(c[l[m]],h[p[m]]);if(S!==0)return S}return ee(l.length,p.length)}(n.mapValue,e.mapValue);default:throw j()}}function zy(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ee(n,e);let t=Xt(n),r=Xt(e),i=ee(t.seconds,r.seconds);return i!==0?i:ee(t.nanos,r.nanos)}function qy(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=ii(t[i],r[i]);if(s)return s}return ee(t.length,r.length)}function si(n){return uh(n)}function uh(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Xt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Zt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return L.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=uh(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let a of r)s?s=!1:i+=",",i+=`${a}:${uh(t.fields[a])}`;return i+"}"}(n.mapValue):j()}function $a(n){switch(kn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Tc(n);return e?16+$a(e):16;case 5:return 2*n.stringValue.length;case 6:return Zt(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+$a(s),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return pr(r.fields,(s,a)=>{i+=s.length+$a(a)}),i}(n.mapValue);default:throw j()}}function Gy(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function dh(n){return!!n&&"integerValue"in n}function Bf(n){return!!n&&"arrayValue"in n}function Wy(n){return!!n&&"nullValue"in n}function Hy(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function za(n){return!!n&&"mapValue"in n}function Tv(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function $s(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return pr(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=$s(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=$s(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Av(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var It=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!za(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=$s(t)}setAll(e){let t=nt.emptyPath(),r={},i=[];e.forEach((a,c)=>{if(!t.isImmediateParentOf(c)){let l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=c.popLast()}a?r[c.lastSegment()]=$s(a):i.push(c.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());za(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Mt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];za(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){pr(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n($s(this.value))}};function Cv(n){let e=[];return pr(n.fields,(t,r)=>{let i=new nt([t]);if(za(r)){let s=Cv(r.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new Rt(e)}var wt=class n{constructor(e,t,r,i,s,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=c}static newInvalidDocument(e){return new n(e,0,W.min(),W.min(),W.min(),It.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,W.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,W.min(),W.min(),It.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,W.min(),W.min(),It.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(W.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=It.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=It.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=W.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var oi=class{constructor(e,t){this.position=e,this.inclusive=t}};function Ky(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],a=n.position[i];if(s.field.isKeyField()?r=L.comparator(L.fromName(a.referenceValue),t.key):r=ii(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Qy(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Mt(n.position[t],e.position[t]))return!1;return!0}var ai=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function KS(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Ja=class{},Ae=class n extends Ja{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new fh(e,t,r):t==="array-contains"?new gh(e,r):t==="in"?new _h(e,r):t==="not-in"?new yh(e,r):t==="array-contains-any"?new vh(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new ph(e,r):new mh(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ii(t,this.value)):t!==null&&kn(this.value)===kn(t)&&this.matchesComparison(ii(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return j()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Et=class n extends Ja{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return Sv(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Sv(n){return n.op==="and"}function Rv(n){return QS(n)&&Sv(n)}function QS(n){for(let e of n.filters)if(e instanceof Et)return!1;return!0}function hh(n){if(n instanceof Ae)return n.field.canonicalString()+n.op.toString()+si(n.value);if(Rv(n))return n.filters.map(e=>hh(e)).join(",");{let e=n.filters.map(t=>hh(t)).join(",");return`${n.op}(${e})`}}function Dv(n,e){return n instanceof Ae?function(r,i){return i instanceof Ae&&r.op===i.op&&r.field.isEqual(i.field)&&Mt(r.value,i.value)}(n,e):n instanceof Et?function(r,i){return i instanceof Et&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,c)=>s&&Dv(a,i.filters[c]),!0):!1}(n,e):void j()}function Pv(n){return n instanceof Ae?function(t){return`${t.field.canonicalString()} ${t.op} ${si(t.value)}`}(n):n instanceof Et?function(t){return t.op.toString()+" {"+t.getFilters().map(Pv).join(" ,")+"}"}(n):"Filter"}var fh=class extends Ae{constructor(e,t,r){super(e,t,r),this.key=L.fromName(r.referenceValue)}matches(e){let t=L.comparator(e.key,this.key);return this.matchesComparison(t)}},ph=class extends Ae{constructor(e,t){super(e,"in",t),this.keys=kv("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},mh=class extends Ae{constructor(e,t){super(e,"not-in",t),this.keys=kv("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function kv(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>L.fromName(r.referenceValue))}var gh=class extends Ae{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Bf(t)&&Ks(t.arrayValue,this.value)}},_h=class extends Ae{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ks(this.value.arrayValue,t)}},yh=class extends Ae{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ks(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Ks(this.value.arrayValue,t)}},vh=class extends Ae{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Bf(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ks(this.value.arrayValue,r))}};var Ih=class{constructor(e,t=null,r=[],i=[],s=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=c,this.ue=null}};function Yy(n,e=null,t=[],r=[],i=null,s=null,a=null){return new Ih(n,e,t,r,i,s,a)}function $f(n){let e=G(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>hh(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),bc(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>si(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>si(r)).join(",")),e.ue=t}return e.ue}function zf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!KS(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Dv(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Qy(n.startAt,e.startAt)&&Qy(n.endAt,e.endAt)}function wh(n){return L.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var ur=class{constructor(e,t=null,r=[],i=[],s=null,a="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=c,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function YS(n,e,t,r,i,s,a,c){return new ur(n,e,t,r,i,s,a,c)}function qf(n){return new ur(n)}function Jy(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Mv(n){return n.collectionGroup!==null}function zs(n){let e=G(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new xe(nt.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new ai(s,r))}),t.has(nt.keyField().canonicalString())||e.ce.push(new ai(nt.keyField(),r))}return e.ce}function Pt(n){let e=G(n);return e.le||(e.le=JS(e,zs(n))),e.le}function JS(n,e){if(n.limitType==="F")return Yy(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new ai(i.field,s)});let t=n.endAt?new oi(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new oi(n.startAt.position,n.startAt.inclusive):null;return Yy(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Eh(n,e){let t=n.filters.concat([e]);return new ur(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function bh(n,e,t){return new ur(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ac(n,e){return zf(Pt(n),Pt(e))&&n.limitType===e.limitType}function Nv(n){return`${$f(Pt(n))}|lt:${n.limitType}`}function Qr(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Pv(i)).join(", ")}]`),bc(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>si(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>si(i)).join(",")),`Target(${r})`}(Pt(n))}; limitType=${n.limitType})`}function Cc(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):L.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of zs(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,c,l){let h=Ky(a,c,l);return a.inclusive?h<=0:h<0}(r.startAt,zs(r),i)||r.endAt&&!function(a,c,l){let h=Ky(a,c,l);return a.inclusive?h>=0:h>0}(r.endAt,zs(r),i))}(n,e)}function XS(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function xv(n){return(e,t)=>{let r=!1;for(let i of zs(n)){let s=ZS(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function ZS(n,e,t){let r=n.field.isKeyField()?L.comparator(e.key,t.key):function(s,a,c){let l=a.data.field(s),h=c.data.field(s);return l!==null&&h!==null?ii(l,h):j()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return j()}}var en=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){pr(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return bv(this.inner)}size(){return this.innerSize}};var eR=new Ie(L.comparator);function tn(){return eR}var Ov=new Ie(L.comparator);function Bs(...n){let e=Ov;for(let t of n)e=e.insert(t.key,t);return e}function Vv(n){let e=Ov;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function ir(){return qs()}function Fv(){return qs()}function qs(){return new en(n=>n.toString(),(n,e)=>n.isEqual(e))}var tR=new Ie(L.comparator),nR=new xe(L.comparator);function J(...n){let e=nR;for(let t of n)e=e.add(t);return e}var rR=new xe(ee);function iR(){return rR}function Gf(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ws(e)?"-0":e}}function Lv(n){return{integerValue:""+n}}function sR(n,e){return jS(e)?Lv(e):Gf(n,e)}var ci=class{constructor(){this._=void 0}};function oR(n,e,t){return n instanceof li?function(i,s){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&jf(s)&&(s=Tc(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof dr?jv(n,e):n instanceof hr?Bv(n,e):function(i,s){let a=Uv(i,s),c=Xy(a)+Xy(i.Pe);return dh(a)&&dh(i.Pe)?Lv(c):Gf(i.serializer,c)}(n,e)}function aR(n,e,t){return n instanceof dr?jv(n,e):n instanceof hr?Bv(n,e):t}function Uv(n,e){return n instanceof ui?function(r){return dh(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var li=class extends ci{},dr=class extends ci{constructor(e){super(),this.elements=e}};function jv(n,e){let t=$v(e);for(let r of n.elements)t.some(i=>Mt(i,r))||t.push(r);return{arrayValue:{values:t}}}var hr=class extends ci{constructor(e){super(),this.elements=e}};function Bv(n,e){let t=$v(e);for(let r of n.elements)t=t.filter(i=>!Mt(i,r));return{arrayValue:{values:t}}}var ui=class extends ci{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function Xy(n){return me(n.integerValue||n.doubleValue)}function $v(n){return Bf(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function cR(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof dr&&i instanceof dr||r instanceof hr&&i instanceof hr?ri(r.elements,i.elements,Mt):r instanceof ui&&i instanceof ui?Mt(r.Pe,i.Pe):r instanceof li&&i instanceof li}(n.transform,e.transform)}var Th=class{constructor(e,t){this.version=e,this.transformResults=t}},ar=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function qa(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var di=class{};function zv(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Xa(n.key,ar.none()):new fr(n.key,n.data,ar.none());{let t=n.data,r=It.empty(),i=new xe(nt.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new nn(n.key,r,new Rt(i.toArray()),ar.none())}}function lR(n,e,t){n instanceof fr?function(i,s,a){let c=i.value.clone(),l=ev(i.fieldTransforms,s,a.transformResults);c.setAll(l),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(n,e,t):n instanceof nn?function(i,s,a){if(!qa(i.precondition,s))return void s.convertToUnknownDocument(a.version);let c=ev(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(qv(i)),l.setAll(c),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Gs(n,e,t,r){return n instanceof fr?function(s,a,c,l){if(!qa(s.precondition,a))return c;let h=s.value.clone(),p=tv(s.fieldTransforms,l,a);return h.setAll(p),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(n,e,t,r):n instanceof nn?function(s,a,c,l){if(!qa(s.precondition,a))return c;let h=tv(s.fieldTransforms,l,a),p=a.data;return p.setAll(qv(s)),p.setAll(h),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(n,e,t,r):function(s,a,c){return qa(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(n,e,t)}function uR(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=Uv(r.transform,i||null);s!=null&&(t===null&&(t=It.empty()),t.set(r.field,s))}return t||null}function Zy(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ri(r,i,(s,a)=>cR(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var fr=class extends di{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},nn=class extends di{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function qv(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function ev(n,e,t){let r=new Map;ae(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],a=s.transform,c=e.data.field(s.field);r.set(s.field,aR(a,c,t[i]))}return r}function tv(n,e,t){let r=new Map;for(let i of n){let s=i.transform,a=t.data.field(i.field);r.set(i.field,oR(s,a,e))}return r}var Xa=class extends di{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Ah=class extends di{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Ch=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&lR(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Gs(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Gs(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Fv();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,c=this.applyToLocalView(a,s.mutatedFields);c=t.has(i.key)?null:c;let l=zv(a,c);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(W.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),J())}isEqual(e){return this.batchId===e.batchId&&ri(this.mutations,e.mutations,(t,r)=>Zy(t,r))&&ri(this.baseMutations,e.baseMutations,(t,r)=>Zy(t,r))}},Sh=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ae(e.mutations.length===r.length);let i=function(){return tR}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new n(e,t,r,i)}};var Rh=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Dh=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var be,te;function dR(n){switch(n){default:return j();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0}}function Gv(n){if(n===void 0)return Jt("GRPC error has no .code"),R.UNKNOWN;switch(n){case be.OK:return R.OK;case be.CANCELLED:return R.CANCELLED;case be.UNKNOWN:return R.UNKNOWN;case be.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case be.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case be.INTERNAL:return R.INTERNAL;case be.UNAVAILABLE:return R.UNAVAILABLE;case be.UNAUTHENTICATED:return R.UNAUTHENTICATED;case be.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case be.NOT_FOUND:return R.NOT_FOUND;case be.ALREADY_EXISTS:return R.ALREADY_EXISTS;case be.PERMISSION_DENIED:return R.PERMISSION_DENIED;case be.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case be.ABORTED:return R.ABORTED;case be.OUT_OF_RANGE:return R.OUT_OF_RANGE;case be.UNIMPLEMENTED:return R.UNIMPLEMENTED;case be.DATA_LOSS:return R.DATA_LOSS;default:return j()}}(te=be||(be={}))[te.OK=0]="OK",te[te.CANCELLED=1]="CANCELLED",te[te.UNKNOWN=2]="UNKNOWN",te[te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",te[te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",te[te.NOT_FOUND=5]="NOT_FOUND",te[te.ALREADY_EXISTS=6]="ALREADY_EXISTS",te[te.PERMISSION_DENIED=7]="PERMISSION_DENIED",te[te.UNAUTHENTICATED=16]="UNAUTHENTICATED",te[te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",te[te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",te[te.ABORTED=10]="ABORTED",te[te.OUT_OF_RANGE=11]="OUT_OF_RANGE",te[te.UNIMPLEMENTED=12]="UNIMPLEMENTED",te[te.INTERNAL=13]="INTERNAL",te[te.UNAVAILABLE=14]="UNAVAILABLE",te[te.DATA_LOSS=15]="DATA_LOSS";var nv=null;function hR(){return new TextEncoder}var fR=new Dn([4294967295,4294967295],0);function rv(n){let e=hR().encode(n),t=new qd;return t.update(e),new Uint8Array(t.digest())}function iv(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Dn([t,r],0),new Dn([i,s],0)]}var Ph=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new sr(`Invalid padding: ${t}`);if(r<0)throw new sr(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new sr(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new sr(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ie=Dn.fromNumber(this.Te)}Ee(e,t,r){let i=e.add(t.multiply(Dn.fromNumber(r)));return i.compare(fR)===1&&(i=new Dn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ie).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let t=rv(e),[r,i]=iv(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(r,i,s);if(!this.de(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,i,t);return r.forEach(c=>a.insert(c)),a}insert(e){if(this.Te===0)return;let t=rv(e),[r,i]=iv(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(r,i,s);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},sr=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Za=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Qs.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(W.min(),i,new Ie(ee),tn(),J())}},Qs=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,J(),J(),J())}};var Zr=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},ec=class{constructor(e,t){this.targetId=e,this.me=t}},tc=class{constructor(e,t,r=$e.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},nc=class{constructor(){this.fe=0,this.ge=sv(),this.pe=$e.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=J(),t=J(),r=J();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:j()}}),new Qs(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=sv()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ae(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},kh=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=tn(),this.qe=ja(),this.Qe=ja(),this.Ke=new Ie(ee)}$e(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.Ue(t,e.Ve):this.We(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.We(t,e.key,e.Ve)}Ge(e){this.forEachTarget(e,t=>{let r=this.ze(t);switch(e.state){case 0:this.je(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.je(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),r.De(e.resumeToken));break;default:j()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.je(i)&&t(i)})}Je(e){let t=e.targetId,r=e.me.count,i=this.Ye(t);if(i){let s=i.target;if(wh(s))if(r===0){let a=new L(s.path);this.We(t,a,wt.newNoDocument(a,W.min()))}else ae(r===1);else{let a=this.Ze(t);if(a!==r){let c=this.Xe(e),l=c?this.et(c,e,a):1;if(l!==0){this.He(t);let h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,h)}nv?.tt(function(p,m,E,S,P){var x,k,z,Q,K,de;let ze={localCacheCount:p,existenceFilterCount:m.count,databaseId:E.database,projectId:E.projectId},ce=m.unchangedNames;return ce&&(ze.bloomFilter={applied:P===0,hashCount:(x=ce?.hashCount)!==null&&x!==void 0?x:0,bitmapLength:(Q=(z=(k=ce?.bits)===null||k===void 0?void 0:k.bitmap)===null||z===void 0?void 0:z.length)!==null&&Q!==void 0?Q:0,padding:(de=(K=ce?.bits)===null||K===void 0?void 0:K.padding)!==null&&de!==void 0?de:0,mightContain:w=>{var g;return(g=S?.mightContain(w))!==null&&g!==void 0&&g}}),ze}(a,e.me,this.Le.nt(),c,l))}}}}Xe(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,a,c;try{a=Zt(r).toUint8Array()}catch(l){if(l instanceof Qa)return ni("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new Ph(a,i,s)}catch(l){return ni(l instanceof sr?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.Te===0?null:c}et(e,t,r){return t.me.count===r-this.rt(e,t.targetId)?0:2}rt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let a=this.Le.nt(),c=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.We(t,s,null),i++)}),i}it(e){let t=new Map;this.Be.forEach((s,a)=>{let c=this.Ye(a);if(c){if(s.current&&wh(c.target)){let l=new L(c.target.path);this.st(l).has(a)||this.ot(a,l)||this.We(a,l,wt.newNoDocument(l,e))}s.be&&(t.set(a,s.ve()),s.Ce())}});let r=J();this.Qe.forEach((s,a)=>{let c=!0;a.forEachWhile(l=>{let h=this.Ye(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));let i=new Za(e,t,this.Ke,this.ke,r);return this.ke=tn(),this.qe=ja(),this.Qe=ja(),this.Ke=new Ie(ee),i}Ue(e,t){if(!this.je(e))return;let r=this.ot(e,t.key)?2:0;this.ze(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e)),this.Qe=this.Qe.insert(t.key,this._t(t.key).add(e))}We(e,t,r){if(!this.je(e))return;let i=this.ze(e);this.ot(e,t)?i.Fe(t,1):i.Me(t),this.Qe=this.Qe.insert(t,this._t(t).delete(e)),this.Qe=this.Qe.insert(t,this._t(t).add(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ze(e){let t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.ze(e).xe()}ze(e){let t=this.Be.get(e);return t||(t=new nc,this.Be.set(e,t)),t}_t(e){let t=this.Qe.get(e);return t||(t=new xe(ee),this.Qe=this.Qe.insert(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new xe(ee),this.qe=this.qe.insert(e,t)),t}je(e){let t=this.Ye(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ut(e)}He(e){this.Be.set(e,new nc),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}ot(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function ja(){return new Ie(L.comparator)}function sv(){return new Ie(L.comparator)}var pR={asc:"ASCENDING",desc:"DESCENDING"},mR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gR={and:"AND",or:"OR"},Mh=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Nh(n,e){return n.useProto3Json||bc(e)?e:{value:e}}function rc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Wv(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function _R(n,e){return rc(n,e.toTimestamp())}function kt(n){return ae(!!n),W.fromTimestamp(function(t){let r=Xt(t);return new De(r.seconds,r.nanos)}(n))}function Wf(n,e){return xh(n,e).canonicalString()}function xh(n,e){let t=function(i){return new ye(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Hv(n){let e=ye.fromString(n);return ae(Xv(e)),e}function Oh(n,e){return Wf(n.databaseId,e.path)}function Yd(n,e){let t=Hv(e);if(t.get(1)!==n.databaseId.projectId)throw new F(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new F(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new L(Qv(t))}function Kv(n,e){return Wf(n.databaseId,e)}function yR(n){let e=Hv(n);return e.length===4?ye.emptyPath():Qv(e)}function Vh(n){return new ye(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Qv(n){return ae(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function ov(n,e,t){return{name:Oh(n,e),fields:t.value.mapValue.fields}}function vR(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:j()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(h,p){return h.useProto3Json?(ae(p===void 0||typeof p=="string"),$e.fromBase64String(p||"")):(ae(p===void 0||p instanceof Buffer||p instanceof Uint8Array),$e.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(h){let p=h.code===void 0?R.UNKNOWN:Gv(h.code);return new F(p,h.message||"")}(a);t=new tc(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Yd(n,r.document.name),s=kt(r.document.updateTime),a=r.document.createTime?kt(r.document.createTime):W.min(),c=new It({mapValue:{fields:r.document.fields}}),l=wt.newFoundDocument(i,s,a,c),h=r.targetIds||[],p=r.removedTargetIds||[];t=new Zr(h,p,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Yd(n,r.document),s=r.readTime?kt(r.readTime):W.min(),a=wt.newNoDocument(i,s),c=r.removedTargetIds||[];t=new Zr([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Yd(n,r.document),s=r.removedTargetIds||[];t=new Zr([],s,i,null)}else{if(!("filter"in e))return j();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,a=new Dh(i,s),c=r.targetId;t=new ec(c,a)}}return t}function IR(n,e){let t;if(e instanceof fr)t={update:ov(n,e.key,e.value)};else if(e instanceof Xa)t={delete:Oh(n,e.key)};else if(e instanceof nn)t={update:ov(n,e.key,e.data),updateMask:DR(e.fieldMask)};else{if(!(e instanceof Ah))return j();t={verify:Oh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){let c=a.transform;if(c instanceof li)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof dr)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof hr)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof ui)return{fieldPath:a.field.canonicalString(),increment:c.Pe};throw j()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:_R(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:j()}(n,e.precondition)),t}function wR(n,e){return n&&n.length>0?(ae(e!==void 0),n.map(t=>function(i,s){let a=i.updateTime?kt(i.updateTime):kt(s);return a.isEqual(W.min())&&(a=kt(s)),new Th(a,i.transformResults||[])}(t,e))):[]}function ER(n,e){return{documents:[Kv(n,e.path)]}}function bR(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Kv(n,i);let s=function(h){if(h.length!==0)return Jv(Et.create(h,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let a=function(h){if(h.length!==0)return h.map(p=>function(E){return{field:Yr(E.field),direction:CR(E.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let c=Nh(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ct:t,parent:i}}function TR(n){let e=yR(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ae(r===1);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(m){let E=Yv(m);return E instanceof Et&&Rv(E)?E.getFilters():[E]}(t.where));let a=[];t.orderBy&&(a=function(m){return m.map(E=>function(P){return new ai(Jr(P.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(P.direction))}(E))}(t.orderBy));let c=null;t.limit&&(c=function(m){let E;return E=typeof m=="object"?m.value:m,bc(E)?null:E}(t.limit));let l=null;t.startAt&&(l=function(m){let E=!!m.before,S=m.values||[];return new oi(S,E)}(t.startAt));let h=null;return t.endAt&&(h=function(m){let E=!m.before,S=m.values||[];return new oi(S,E)}(t.endAt)),YS(e,i,a,s,c,"F",l,h)}function AR(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return j()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Yv(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Jr(t.unaryFilter.field);return Ae.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Jr(t.unaryFilter.field);return Ae.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Jr(t.unaryFilter.field);return Ae.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Jr(t.unaryFilter.field);return Ae.create(a,"!=",{nullValue:"NULL_VALUE"});default:return j()}}(n):n.fieldFilter!==void 0?function(t){return Ae.create(Jr(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return j()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Et.create(t.compositeFilter.filters.map(r=>Yv(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return j()}}(t.compositeFilter.op))}(n):j()}function CR(n){return pR[n]}function SR(n){return mR[n]}function RR(n){return gR[n]}function Yr(n){return{fieldPath:n.canonicalString()}}function Jr(n){return nt.fromServerFormat(n.fieldPath)}function Jv(n){return n instanceof Ae?function(t){if(t.op==="=="){if(Hy(t.value))return{unaryFilter:{field:Yr(t.field),op:"IS_NAN"}};if(Wy(t.value))return{unaryFilter:{field:Yr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Hy(t.value))return{unaryFilter:{field:Yr(t.field),op:"IS_NOT_NAN"}};if(Wy(t.value))return{unaryFilter:{field:Yr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yr(t.field),op:SR(t.op),value:t.value}}}(n):n instanceof Et?function(t){let r=t.getFilters().map(i=>Jv(i));return r.length===1?r[0]:{compositeFilter:{op:RR(t.op),filters:r}}}(n):j()}function DR(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Xv(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Ys=class n{constructor(e,t,r,i,s=W.min(),a=W.min(),c=$e.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Fh=class{constructor(e){this.ht=e}};function PR(n){let e=TR({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?bh(e,e.limit,"L"):e}var ic=class{constructor(){}Et(e,t){this.dt(e,t),t.At()}dt(e,t){if("nullValue"in e)this.Rt(t,5);else if("booleanValue"in e)this.Rt(t,10),t.Vt(e.booleanValue?1:0);else if("integerValue"in e)this.Rt(t,15),t.Vt(me(e.integerValue));else if("doubleValue"in e){let r=me(e.doubleValue);isNaN(r)?this.Rt(t,13):(this.Rt(t,15),Ws(r)?t.Vt(0):t.Vt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Rt(t,20),typeof r=="string"&&(r=Xt(r)),t.ft(`${r.seconds||""}`),t.Vt(r.nanos||0)}else if("stringValue"in e)this.gt(e.stringValue,t),this.yt(t);else if("bytesValue"in e)this.Rt(t,30),t.wt(Zt(e.bytesValue)),this.yt(t);else if("referenceValue"in e)this.St(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Rt(t,45),t.Vt(r.latitude||0),t.Vt(r.longitude||0)}else"mapValue"in e?Av(e)?this.Rt(t,Number.MAX_SAFE_INTEGER):Tv(e)?this.bt(e.mapValue,t):(this.Dt(e.mapValue,t),this.yt(t)):"arrayValue"in e?(this.vt(e.arrayValue,t),this.yt(t)):j()}gt(e,t){this.Rt(t,25),this.Ct(e,t)}Ct(e,t){t.ft(e)}Dt(e,t){let r=e.fields||{};this.Rt(t,55);for(let i of Object.keys(r))this.gt(i,t),this.dt(r[i],t)}bt(e,t){var r,i;let s=e.fields||{};this.Rt(t,53);let a="value",c=((i=(r=s[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Rt(t,15),t.Vt(me(c)),this.gt(a,t),this.dt(s[a],t)}vt(e,t){let r=e.values||[];this.Rt(t,50);for(let i of r)this.dt(i,t)}St(e,t){this.Rt(t,37),L.fromName(e).path.forEach(r=>{this.Rt(t,60),this.Ct(r,t)})}Rt(e,t){e.Vt(t)}yt(e){e.Vt(2)}};ic.Ft=new ic;var Lh=class{constructor(){this.ln=new Uh}addToCollectionParentIndex(e,t){return this.ln.add(t),D.resolve()}getCollectionParents(e,t){return D.resolve(this.ln.getEntries(t))}addFieldIndex(e,t){return D.resolve()}deleteFieldIndex(e,t){return D.resolve()}deleteAllFieldIndexes(e){return D.resolve()}createTargetIndexes(e,t){return D.resolve()}getDocumentsMatchingTarget(e,t){return D.resolve(null)}getIndexType(e,t){return D.resolve(0)}getFieldIndexes(e,t){return D.resolve([])}getNextCollectionGroupToUpdate(e){return D.resolve(null)}getMinOffset(e,t){return D.resolve(lr.min())}getMinOffsetFromCollectionGroup(e,t){return D.resolve(lr.min())}updateCollectionGroup(e,t,r){return D.resolve()}updateIndexEntries(e,t){return D.resolve()}},Uh=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new xe(ye.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new xe(ye.comparator)).toArray()}};var GN=new Uint8Array(0);var av={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ut=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};ut.DEFAULT_COLLECTION_PERCENTILE=10,ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ut.DEFAULT=new ut(41943040,ut.DEFAULT_COLLECTION_PERCENTILE,ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ut.DISABLED=new ut(-1,0,0);var Js=class n{constructor(e){this.kn=e}next(){return this.kn+=2,this.kn}static qn(){return new n(0)}static Qn(){return new n(-1)}};function cv([n,e],[t,r]){let i=ee(n,t);return i===0?ee(e,r):i}var jh=class{constructor(e){this.Gn=e,this.buffer=new xe(cv),this.zn=0}jn(){return++this.zn}Hn(e){let t=[e,this.jn()];if(this.buffer.size<this.Gn)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();cv(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Bh=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Yn(6e4)}stop(){this.Jn&&(this.Jn.cancel(),this.Jn=null)}get started(){return this.Jn!==null}Yn(e){V("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>v(this,null,function*(){this.Jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){yi(t)?V("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield _i(t)}yield this.Yn(3e5)}))}},$h=class{constructor(e,t){this.Zn=e,this.params=t}calculateTargetCount(e,t){return this.Zn.Xn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return D.resolve(Uf.oe);let r=new jh(t);return this.Zn.forEachTarget(e,i=>r.Hn(i.sequenceNumber)).next(()=>this.Zn.er(e,i=>r.Hn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Zn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Zn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(V("LruGarbageCollector","Garbage collection skipped; disabled"),D.resolve(av)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),av):this.tr(e,t))}getCacheSize(e){return this.Zn.getCacheSize(e)}tr(e,t){let r,i,s,a,c,l,h,p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,a=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,c=Date.now(),this.removeTargets(e,r,t))).next(m=>(s=m,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(h=Date.now(),Kr()<=Y.DEBUG&&V("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${i} in `+(c-a)+`ms
	Removed ${s} targets in `+(l-c)+`ms
	Removed ${m} documents in `+(h-l)+`ms
Total Duration: ${h-p}ms`),D.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}};function kR(n,e){return new $h(n,e)}var zh=class{constructor(){this.changes=new en(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,wt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?D.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var qh=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Gh=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Gs(r.mutation,i,Rt.empty(),De.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,J()).next(()=>r))}getLocalViewOfDocuments(e,t,r=J()){let i=ir();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=Bs();return s.forEach((c,l)=>{a=a.insert(c,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=ir();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,J()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,c)=>{t.set(a,c)})})}computeViews(e,t,r,i){let s=tn(),a=qs(),c=function(){return qs()}();return t.forEach((l,h)=>{let p=r.get(h.key);i.has(h.key)&&(p===void 0||p.mutation instanceof nn)?s=s.insert(h.key,h):p!==void 0?(a.set(h.key,p.mutation.getFieldMask()),Gs(p.mutation,h,p.mutation.getFieldMask(),De.now())):a.set(h.key,Rt.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((h,p)=>a.set(h,p)),t.forEach((h,p)=>{var m;return c.set(h,new qh(p,(m=a.get(h))!==null&&m!==void 0?m:null))}),c))}recalculateAndSaveOverlays(e,t){let r=qs(),i=new Ie((a,c)=>a-c),s=J();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let c of a)c.keys().forEach(l=>{let h=t.get(l);if(h===null)return;let p=r.get(l)||Rt.empty();p=c.applyToLocalView(h,p),r.set(l,p);let m=(i.get(c.batchId)||J()).add(l);i=i.insert(c.batchId,m)})}).next(()=>{let a=[],c=i.getReverseIterator();for(;c.hasNext();){let l=c.getNext(),h=l.key,p=l.value,m=Fv();p.forEach(E=>{if(!s.has(E)){let S=zv(t.get(E),r.get(E));S!==null&&m.set(E,S),s=s.add(E)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,m))}return D.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return L.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Mv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):D.resolve(ir()),c=-1,l=s;return a.next(h=>D.forEach(h,(p,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),s.get(p)?D.resolve():this.remoteDocumentCache.getEntry(e,p).next(E=>{l=l.insert(p,E)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,l,h,J())).next(p=>({batchId:c,changes:Vv(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new L(t)).next(r=>{let i=Bs();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,a=Bs();return this.indexManager.getCollectionParents(e,s).next(c=>D.forEach(c,l=>{let h=function(m,E){return new ur(E,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next(p=>{p.forEach((m,E)=>{a=a.insert(m,E)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((l,h)=>{let p=h.getKey();a.get(p)===null&&(a=a.insert(p,wt.newInvalidDocument(p)))});let c=Bs();return a.forEach((l,h)=>{let p=s.get(l);p!==void 0&&Gs(p.mutation,h,Rt.empty(),De.now()),Cc(t,h)&&(c=c.insert(l,h))}),c})}};var Wh=class{constructor(e){this.serializer=e,this.Tr=new Map,this.Ir=new Map}getBundleMetadata(e,t){return D.resolve(this.Tr.get(t))}saveBundleMetadata(e,t){return this.Tr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:kt(i.createTime)}}(t)),D.resolve()}getNamedQuery(e,t){return D.resolve(this.Ir.get(t))}saveNamedQuery(e,t){return this.Ir.set(t.name,function(i){return{name:i.name,query:PR(i.bundledQuery),readTime:kt(i.readTime)}}(t)),D.resolve()}};var Hh=class{constructor(){this.overlays=new Ie(L.comparator),this.Er=new Map}getOverlay(e,t){return D.resolve(this.overlays.get(t))}getOverlays(e,t){let r=ir();return D.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.Tt(e,t,s)}),D.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Er.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Er.delete(r)),D.resolve()}getOverlaysForCollection(e,t,r){let i=ir(),s=t.length+1,a=new L(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){let l=c.getNext().value,h=l.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return D.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Ie((h,p)=>h-p),a=this.overlays.getIterator();for(;a.hasNext();){let h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let p=s.get(h.largestBatchId);p===null&&(p=ir(),s=s.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}let c=ir(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((h,p)=>c.set(h,p)),!(c.size()>=i)););return D.resolve(c)}Tt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Er.get(i.largestBatchId).delete(r.key);this.Er.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Rh(t,r));let s=this.Er.get(t);s===void 0&&(s=J(),this.Er.set(t,s)),this.Er.set(t,s.add(r.key))}};var Kh=class{constructor(){this.sessionToken=$e.EMPTY_BYTE_STRING}getSessionToken(e){return D.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,D.resolve()}};var Xs=class{constructor(){this.dr=new xe(Te.Ar),this.Rr=new xe(Te.Vr)}isEmpty(){return this.dr.isEmpty()}addReference(e,t){let r=new Te(e,t);this.dr=this.dr.add(r),this.Rr=this.Rr.add(r)}mr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.gr(new Te(e,t))}pr(e,t){e.forEach(r=>this.removeReference(r,t))}yr(e){let t=new L(new ye([])),r=new Te(t,e),i=new Te(t,e+1),s=[];return this.Rr.forEachInRange([r,i],a=>{this.gr(a),s.push(a.key)}),s}wr(){this.dr.forEach(e=>this.gr(e))}gr(e){this.dr=this.dr.delete(e),this.Rr=this.Rr.delete(e)}Sr(e){let t=new L(new ye([])),r=new Te(t,e),i=new Te(t,e+1),s=J();return this.Rr.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new Te(e,0),r=this.dr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Te=class{constructor(e,t){this.key=e,this.br=t}static Ar(e,t){return L.comparator(e.key,t.key)||ee(e.br,t.br)}static Vr(e,t){return ee(e.br,t.br)||L.comparator(e.key,t.key)}};var Qh=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Dr=1,this.vr=new xe(Te.Ar)}checkEmpty(e){return D.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Dr;this.Dr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new Ch(s,t,r,i);this.mutationQueue.push(a);for(let c of i)this.vr=this.vr.add(new Te(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return D.resolve(a)}lookupMutationBatch(e,t){return D.resolve(this.Cr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Fr(r),s=i<0?0:i;return D.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return D.resolve(this.mutationQueue.length===0?-1:this.Dr-1)}getAllMutationBatches(e){return D.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Te(t,0),i=new Te(t,Number.POSITIVE_INFINITY),s=[];return this.vr.forEachInRange([r,i],a=>{let c=this.Cr(a.br);s.push(c)}),D.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new xe(ee);return t.forEach(i=>{let s=new Te(i,0),a=new Te(i,Number.POSITIVE_INFINITY);this.vr.forEachInRange([s,a],c=>{r=r.add(c.br)})}),D.resolve(this.Mr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;L.isDocumentKey(s)||(s=s.child(""));let a=new Te(new L(s),0),c=new xe(ee);return this.vr.forEachWhile(l=>{let h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(c=c.add(l.br)),!0)},a),D.resolve(this.Mr(c))}Mr(e){let t=[];return e.forEach(r=>{let i=this.Cr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ae(this.Or(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.vr;return D.forEach(t.mutations,i=>{let s=new Te(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.vr=r})}Ln(e){}containsKey(e,t){let r=new Te(t,0),i=this.vr.firstAfterOrEqual(r);return D.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,D.resolve()}Or(e,t){return this.Fr(e)}Fr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Cr(e){let t=this.Fr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Yh=class{constructor(e){this.Nr=e,this.docs=function(){return new Ie(L.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Nr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return D.resolve(r?r.document.mutableCopy():wt.newInvalidDocument(t))}getEntries(e,t){let r=tn();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():wt.newInvalidDocument(i))}),D.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=tn(),a=t.path,c=new L(a.child("")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){let{key:h,value:{document:p}}=l.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||FS(VS(p),r)<=0||(i.has(p.key)||Cc(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return D.resolve(s)}getAllFromCollectionGroup(e,t,r,i){j()}Lr(e,t){return D.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Jh(this)}getSize(e){return D.resolve(this.size)}},Jh=class extends zh{constructor(e){super(),this.hr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.hr.addEntry(e,i)):this.hr.removeEntry(r)}),D.waitFor(t)}getFromCache(e,t){return this.hr.getEntry(e,t)}getAllFromCache(e,t){return this.hr.getEntries(e,t)}};var Xh=class{constructor(e){this.persistence=e,this.Br=new en(t=>$f(t),zf),this.lastRemoteSnapshotVersion=W.min(),this.highestTargetId=0,this.kr=0,this.qr=new Xs,this.targetCount=0,this.Qr=Js.qn()}forEachTarget(e,t){return this.Br.forEach((r,i)=>t(i)),D.resolve()}getLastRemoteSnapshotVersion(e){return D.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return D.resolve(this.kr)}allocateTargetId(e){return this.highestTargetId=this.Qr.next(),D.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.kr&&(this.kr=t),D.resolve()}Un(e){this.Br.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Qr=new Js(t),this.highestTargetId=t),e.sequenceNumber>this.kr&&(this.kr=e.sequenceNumber)}addTargetData(e,t){return this.Un(t),this.targetCount+=1,D.resolve()}updateTargetData(e,t){return this.Un(t),D.resolve()}removeTargetData(e,t){return this.Br.delete(t.target),this.qr.yr(t.targetId),this.targetCount-=1,D.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Br.forEach((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.Br.delete(a),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),D.waitFor(s).next(()=>i)}getTargetCount(e){return D.resolve(this.targetCount)}getTargetData(e,t){let r=this.Br.get(t)||null;return D.resolve(r)}addMatchingKeys(e,t,r){return this.qr.mr(t,r),D.resolve()}removeMatchingKeys(e,t,r){this.qr.pr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),D.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.qr.yr(t),D.resolve()}getMatchingKeysForTargetId(e,t){let r=this.qr.Sr(t);return D.resolve(r)}containsKey(e,t){return D.resolve(this.qr.containsKey(t))}};var sc=class{constructor(e,t){this.Kr={},this.overlays={},this.$r=new Uf(0),this.Ur=!1,this.Ur=!0,this.Wr=new Kh,this.referenceDelegate=e(this),this.Gr=new Xh(this),this.indexManager=new Lh,this.remoteDocumentCache=function(i){return new Yh(i)}(r=>this.referenceDelegate.zr(r)),this.serializer=new Fh(t),this.jr=new Wh(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Ur=!1,Promise.resolve()}get started(){return this.Ur}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Hh,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Kr[e.toKey()];return r||(r=new Qh(t,this.referenceDelegate),this.Kr[e.toKey()]=r),r}getGlobalsCache(){return this.Wr}getTargetCache(){return this.Gr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.jr}runTransaction(e,t,r){V("MemoryPersistence","Starting transaction:",e);let i=new Zh(this.$r.next());return this.referenceDelegate.Hr(),r(i).next(s=>this.referenceDelegate.Jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Yr(e,t){return D.or(Object.values(this.Kr).map(r=>()=>r.containsKey(e,t)))}},Zh=class extends ch{constructor(e){super(),this.currentSequenceNumber=e}},ef=class n{constructor(e){this.persistence=e,this.Zr=new Xs,this.Xr=null}static ei(e){return new n(e)}get ti(){if(this.Xr)return this.Xr;throw j()}addReference(e,t,r){return this.Zr.addReference(r,t),this.ti.delete(r.toString()),D.resolve()}removeReference(e,t,r){return this.Zr.removeReference(r,t),this.ti.add(r.toString()),D.resolve()}markPotentiallyOrphaned(e,t){return this.ti.add(t.toString()),D.resolve()}removeTarget(e,t){this.Zr.yr(t.targetId).forEach(i=>this.ti.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.ti.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Hr(){this.Xr=new Set}Jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return D.forEach(this.ti,r=>{let i=L.fromPath(r);return this.ni(e,i).next(s=>{s||t.removeEntry(i,W.min())})}).next(()=>(this.Xr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ni(e,t).next(r=>{r?this.ti.delete(t.toString()):this.ti.add(t.toString())})}zr(e){return 0}ni(e,t){return D.or([()=>D.resolve(this.Zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Yr(e,t)])}},oc=class n{constructor(e,t){this.persistence=e,this.ri=new en(r=>BS(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=kR(this,t)}static ei(e,t){return new n(e,t)}Hr(){}Jr(e){return D.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Xn(e){let t=this.nr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}nr(e){let t=0;return this.er(e,r=>{t++}).next(()=>t)}er(e,t){return D.forEach(this.ri,(r,i)=>this.ir(e,r,i).next(s=>s?D.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.Lr(e,a=>this.ir(e,a,t).next(c=>{c||(r++,s.removeEntry(a,W.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.ri.set(t,e.currentSequenceNumber),D.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.ri.set(r,e.currentSequenceNumber),D.resolve()}removeReference(e,t,r){return this.ri.set(r,e.currentSequenceNumber),D.resolve()}updateLimboDocument(e,t){return this.ri.set(t,e.currentSequenceNumber),D.resolve()}zr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=$a(e.data.value)),t}ir(e,t,r){return D.or([()=>this.persistence.Yr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.ri.get(t);return D.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var tf=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Wi=r,this.Gi=i}static zi(e,t){let r=J(),i=J();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var nf=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var rf=class{constructor(){this.ji=!1,this.Hi=!1,this.Ji=100,this.Yi=function(){return R_()?8:US(Me())>0?6:4}()}initialize(e,t){this.Zi=e,this.indexManager=t,this.ji=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Xi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.es(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new nf;return this.ts(e,t,a).next(c=>{if(s.result=c,this.Hi)return this.ns(e,t,a,c.size)})}).next(()=>s.result)}ns(e,t,r,i){return r.documentReadCount<this.Ji?(Kr()<=Y.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",Qr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ji,"documents"),D.resolve()):(Kr()<=Y.DEBUG&&V("QueryEngine","Query:",Qr(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Yi*i?(Kr()<=Y.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",Qr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Pt(t))):D.resolve())}Xi(e,t){if(Jy(t))return D.resolve(null);let r=Pt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=bh(t,null,"F"),r=Pt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let a=J(...s);return this.Zi.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,r).next(l=>{let h=this.rs(t,c);return this.ss(t,h,a,l.readTime)?this.Xi(e,bh(t,null,"F")):this.os(e,h,t,l)}))})))}es(e,t,r,i){return Jy(t)||i.isEqual(W.min())?D.resolve(null):this.Zi.getDocuments(e,r).next(s=>{let a=this.rs(t,s);return this.ss(t,a,r,i)?D.resolve(null):(Kr()<=Y.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Qr(t)),this.os(e,a,t,OS(i,-1)).next(c=>c))})}rs(e,t){let r=new xe(xv(e));return t.forEach((i,s)=>{Cc(e,s)&&(r=r.add(s))}),r}ss(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ts(e,t,r){return Kr()<=Y.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",Qr(t)),this.Zi.getDocumentsMatchingQuery(e,t,lr.min(),r)}os(e,t,r,i){return this.Zi.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var sf=class{constructor(e,t,r,i){this.persistence=e,this._s=t,this.serializer=i,this.us=new Ie(ee),this.cs=new en(s=>$f(s),zf),this.ls=new Map,this.hs=e.getRemoteDocumentCache(),this.Gr=e.getTargetCache(),this.jr=e.getBundleCache(),this.Ps(r)}Ps(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Gh(this.hs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.hs.setIndexManager(this.indexManager),this._s.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.us))}};function MR(n,e,t,r){return new sf(n,e,t,r)}function Zv(n,e){return v(this,null,function*(){let t=G(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Ps(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let a=[],c=[],l=J();for(let h of i){a.push(h.batchId);for(let p of h.mutations)l=l.add(p.key)}for(let h of s){c.push(h.batchId);for(let p of h.mutations)l=l.add(p.key)}return t.localDocuments.getDocuments(r,l).next(h=>({Ts:h,removedBatchIds:a,addedBatchIds:c}))})})})}function NR(n,e){let t=G(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.hs.newChangeBuffer({trackRemovals:!0});return function(c,l,h,p){let m=h.batch,E=m.keys(),S=D.resolve();return E.forEach(P=>{S=S.next(()=>p.getEntry(l,P)).next(x=>{let k=h.docVersions.get(P);ae(k!==null),x.version.compareTo(k)<0&&(m.applyToRemoteDocument(x,h),x.isValidDocument()&&(x.setReadTime(h.commitVersion),p.addEntry(x)))})}),S.next(()=>c.mutationQueue.removeMutationBatch(l,m))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let l=J();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(l=l.add(c.batch.mutations[h].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function eI(n){let e=G(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Gr.getLastRemoteSnapshotVersion(t))}function xR(n,e){let t=G(n),r=e.snapshotVersion,i=t.us;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.hs.newChangeBuffer({trackRemovals:!0});i=t.us;let c=[];e.targetChanges.forEach((p,m)=>{let E=i.get(m);if(!E)return;c.push(t.Gr.removeMatchingKeys(s,p.removedDocuments,m).next(()=>t.Gr.addMatchingKeys(s,p.addedDocuments,m)));let S=E.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?S=S.withResumeToken($e.EMPTY_BYTE_STRING,W.min()).withLastLimboFreeSnapshotVersion(W.min()):p.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(p.resumeToken,r)),i=i.insert(m,S),function(x,k,z){return x.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0}(E,S,p)&&c.push(t.Gr.updateTargetData(s,S))});let l=tn(),h=J();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),c.push(OR(s,a,e.documentUpdates).next(p=>{l=p.Is,h=p.Es})),!r.isEqual(W.min())){let p=t.Gr.getLastRemoteSnapshotVersion(s).next(m=>t.Gr.setTargetsMetadata(s,s.currentSequenceNumber,r));c.push(p)}return D.waitFor(c).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,h)).next(()=>l)}).then(s=>(t.us=i,s))}function OR(n,e,t){let r=J(),i=J();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=tn();return t.forEach((c,l)=>{let h=s.get(c);l.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),l.isNoDocument()&&l.version.isEqual(W.min())?(e.removeEntry(c,l.readTime),a=a.insert(c,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),a=a.insert(c,l)):V("LocalStore","Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",l.version)}),{Is:a,Es:i}})}function VR(n,e){let t=G(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function FR(n,e){let t=G(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Gr.getTargetData(r,e).next(s=>s?(i=s,D.resolve(i)):t.Gr.allocateTargetId(r).next(a=>(i=new Ys(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Gr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.us.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.us=t.us.insert(r.targetId,r),t.cs.set(e,r.targetId)),r})}function of(n,e,t){return v(this,null,function*(){let r=G(n),i=r.us.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!yi(a))throw a;V("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.us=r.us.remove(e),r.cs.delete(i.target)})}function lv(n,e,t){let r=G(n),i=W.min(),s=J();return r.persistence.runTransaction("Execute query","readwrite",a=>function(l,h,p){let m=G(l),E=m.cs.get(p);return E!==void 0?D.resolve(m.us.get(E)):m.Gr.getTargetData(h,p)}(r,a,Pt(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Gr.getMatchingKeysForTargetId(a,c.targetId).next(l=>{s=l})}).next(()=>r._s.getDocumentsMatchingQuery(a,e,t?i:W.min(),t?s:J())).next(c=>(LR(r,XS(e),c),{documents:c,ds:s})))}function LR(n,e,t){let r=n.ls.get(e)||W.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.ls.set(e,r)}var ac=class{constructor(){this.activeTargetIds=iR()}ps(e){this.activeTargetIds=this.activeTargetIds.add(e)}ys(e){this.activeTargetIds=this.activeTargetIds.delete(e)}gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var af=class{constructor(){this._o=new ac,this.ao={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this._o.ps(e),this.ao[e]||"not-current"}updateQueryState(e,t,r){this.ao[e]=t}removeLocalQueryTarget(e){this._o.ys(e)}isLocalQueryTarget(e){return this._o.activeTargetIds.has(e)}clearQueryState(e){delete this.ao[e]}getAllActiveQueryTargets(){return this._o.activeTargetIds}isActiveQueryTarget(e){return this._o.activeTargetIds.has(e)}start(){return this._o=new ac,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var cf=class{uo(e){}shutdown(){}};var cc=class{constructor(){this.co=()=>this.lo(),this.ho=()=>this.Po(),this.To=[],this.Io()}uo(e){this.To.push(e)}shutdown(){window.removeEventListener("online",this.co),window.removeEventListener("offline",this.ho)}Io(){window.addEventListener("online",this.co),window.addEventListener("offline",this.ho)}lo(){V("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.To)e(0)}Po(){V("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.To)e(1)}static p(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ba=null;function Jd(){return Ba===null?Ba=function(){return 268435456+Math.round(2147483648*Math.random())}():Ba++,"0x"+Ba.toString(16)}var UR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var lf=class{constructor(e){this.Eo=e.Eo,this.Ao=e.Ao}Ro(e){this.Vo=e}mo(e){this.fo=e}po(e){this.yo=e}onMessage(e){this.wo=e}close(){this.Ao()}send(e){this.Eo(e)}So(){this.Vo()}bo(){this.fo()}Do(e){this.yo(e)}vo(e){this.wo(e)}};var Be="WebChannelConnection",uf=class extends class{get Co(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Fo=r+"://"+t.host,this.Mo=`projects/${i}/databases/${s}`,this.xo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Oo(t,r,i,s,a){let c=Jd(),l=this.No(t,r.toUriEncodedString());V("RestConnection",`Sending RPC '${t}' ${c}:`,l,i);let h={"google-cloud-resource-prefix":this.Mo,"x-goog-request-params":this.xo};return this.Lo(h,s,a),this.Bo(t,l,h,i).then(p=>(V("RestConnection",`Received RPC '${t}' ${c}: `,p),p),p=>{throw ni("RestConnection",`RPC '${t}' ${c} failed with error: `,p,"url: ",l,"request:",i),p})}ko(t,r,i,s,a,c){return this.Oo(t,r,i,s,a)}Lo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+gi}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}No(t,r){let i=UR[t];return`${this.Fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Bo(e,t,r,i){let s=Jd();return new Promise((a,c)=>{let l=new Gd;l.setWithCredentials(!0),l.listenOnce(Wd.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case js.NO_ERROR:let p=l.getResponseJson();V(Be,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case js.TIMEOUT:V(Be,`RPC '${e}' ${s} timed out`),c(new F(R.DEADLINE_EXCEEDED,"Request time out"));break;case js.HTTP_ERROR:let m=l.getStatus();if(V(Be,`RPC '${e}' ${s} failed with status:`,m,"response text:",l.getResponseText()),m>0){let E=l.getResponseJson();Array.isArray(E)&&(E=E[0]);let S=E?.error;if(S&&S.status&&S.message){let P=function(k){let z=k.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(z)>=0?z:R.UNKNOWN}(S.status);c(new F(P,S.message))}else c(new F(R.UNKNOWN,"Server responded with status "+l.getStatus()))}else c(new F(R.UNAVAILABLE,"Connection failed."));break;default:j()}}finally{V(Be,`RPC '${e}' ${s} completed.`)}});let h=JSON.stringify(i);V(Be,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",h,r,15)})}qo(e,t,r){let i=Jd(),s=[this.Fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Qd(),c=Kd(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Lo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;let p=s.join("");V(Be,`Creating RPC '${e}' stream ${i}: ${p}`,l);let m=a.createWebChannel(p,l),E=!1,S=!1,P=new lf({Eo:k=>{S?V(Be,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(E||(V(Be,`Opening RPC '${e}' stream ${i} transport.`),m.open(),E=!0),V(Be,`RPC '${e}' stream ${i} sending:`,k),m.send(k))},Ao:()=>m.close()}),x=(k,z,Q)=>{k.listen(z,K=>{try{Q(K)}catch(de){setTimeout(()=>{throw de},0)}})};return x(m,Hr.EventType.OPEN,()=>{S||(V(Be,`RPC '${e}' stream ${i} transport opened.`),P.So())}),x(m,Hr.EventType.CLOSE,()=>{S||(S=!0,V(Be,`RPC '${e}' stream ${i} transport closed`),P.Do())}),x(m,Hr.EventType.ERROR,k=>{S||(S=!0,ni(Be,`RPC '${e}' stream ${i} transport errored:`,k),P.Do(new F(R.UNAVAILABLE,"The operation could not be completed")))}),x(m,Hr.EventType.MESSAGE,k=>{var z;if(!S){let Q=k.data[0];ae(!!Q);let K=Q,de=K?.error||((z=K[0])===null||z===void 0?void 0:z.error);if(de){V(Be,`RPC '${e}' stream ${i} received error:`,de);let ze=de.status,ce=function(y){let I=be[y];if(I!==void 0)return Gv(I)}(ze),w=de.message;ce===void 0&&(ce=R.INTERNAL,w="Unknown error status: "+ze+" with message "+de.message),S=!0,P.Do(new F(ce,w)),m.close()}else V(Be,`RPC '${e}' stream ${i} received:`,Q),P.vo(Q)}}),x(c,Hd.STAT_EVENT,k=>{k.stat===La.PROXY?V(Be,`RPC '${e}' stream ${i} detected buffering proxy`):k.stat===La.NOPROXY&&V(Be,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{P.bo()},0),P}};function Xd(){return typeof document<"u"?document:null}function Sc(n){return new Mh(n,!0)}var lc=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.li=e,this.timerId=t,this.Qo=r,this.Ko=i,this.$o=s,this.Uo=0,this.Wo=null,this.Go=Date.now(),this.reset()}reset(){this.Uo=0}zo(){this.Uo=this.$o}jo(e){this.cancel();let t=Math.floor(this.Uo+this.Ho()),r=Math.max(0,Date.now()-this.Go),i=Math.max(0,t-r);i>0&&V("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Uo} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Wo=this.li.enqueueAfterDelay(this.timerId,i,()=>(this.Go=Date.now(),e())),this.Uo*=this.Ko,this.Uo<this.Qo&&(this.Uo=this.Qo),this.Uo>this.$o&&(this.Uo=this.$o)}Jo(){this.Wo!==null&&(this.Wo.skipDelay(),this.Wo=null)}cancel(){this.Wo!==null&&(this.Wo.cancel(),this.Wo=null)}Ho(){return(Math.random()-.5)*this.Uo}};var uc=class{constructor(e,t,r,i,s,a,c,l){this.li=e,this.Yo=r,this.Zo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.Xo=0,this.e_=null,this.t_=null,this.stream=null,this.n_=0,this.r_=new lc(e,t)}i_(){return this.state===1||this.state===5||this.s_()}s_(){return this.state===2||this.state===3}start(){this.n_=0,this.state!==4?this.auth():this.o_()}stop(){return v(this,null,function*(){this.i_()&&(yield this.close(0))})}__(){this.state=0,this.r_.reset()}a_(){this.s_()&&this.e_===null&&(this.e_=this.li.enqueueAfterDelay(this.Yo,6e4,()=>this.u_()))}c_(e){this.l_(),this.stream.send(e)}u_(){return v(this,null,function*(){if(this.s_())return this.close(0)})}l_(){this.e_&&(this.e_.cancel(),this.e_=null)}h_(){this.t_&&(this.t_.cancel(),this.t_=null)}close(e,t){return v(this,null,function*(){this.l_(),this.h_(),this.r_.cancel(),this.Xo++,e!==4?this.r_.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(Jt(t.toString()),Jt("Using maximum backoff delay to prevent overloading the backend."),this.r_.zo()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.P_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.po(t)})}P_(){}auth(){this.state=1;let e=this.T_(this.Xo),t=this.Xo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Xo===t&&this.I_(r,i)},r=>{e(()=>{let i=new F(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.E_(i)})})}I_(e,t){let r=this.T_(this.Xo);this.stream=this.d_(e,t),this.stream.Ro(()=>{r(()=>this.listener.Ro())}),this.stream.mo(()=>{r(()=>(this.state=2,this.t_=this.li.enqueueAfterDelay(this.Zo,1e4,()=>(this.s_()&&(this.state=3),Promise.resolve())),this.listener.mo()))}),this.stream.po(i=>{r(()=>this.E_(i))}),this.stream.onMessage(i=>{r(()=>++this.n_==1?this.A_(i):this.onNext(i))})}o_(){this.state=5,this.r_.jo(()=>v(this,null,function*(){this.state=0,this.start()}))}E_(e){return V("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}T_(e){return t=>{this.li.enqueueAndForget(()=>this.Xo===e?t():(V("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},df=class extends uc{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}d_(e,t){return this.connection.qo("Listen",e,t)}A_(e){return this.onNext(e)}onNext(e){this.r_.reset();let t=vR(this.serializer,e),r=function(s){if(!("targetChange"in s))return W.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?W.min():a.readTime?kt(a.readTime):W.min()}(e);return this.listener.R_(t,r)}V_(e){let t={};t.database=Vh(this.serializer),t.addTarget=function(s,a){let c,l=a.target;if(c=wh(l)?{documents:ER(s,l)}:{query:bR(s,l).ct},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=Wv(s,a.resumeToken);let h=Nh(s,a.expectedCount);h!==null&&(c.expectedCount=h)}else if(a.snapshotVersion.compareTo(W.min())>0){c.readTime=rc(s,a.snapshotVersion.toTimestamp());let h=Nh(s,a.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);let r=AR(this.serializer,e);r&&(t.labels=r),this.c_(t)}m_(e){let t={};t.database=Vh(this.serializer),t.removeTarget=e,this.c_(t)}},hf=class extends uc{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get f_(){return this.n_>0}start(){this.lastStreamToken=void 0,super.start()}P_(){this.f_&&this.g_([])}d_(e,t){return this.connection.qo("Write",e,t)}A_(e){return ae(!!e.streamToken),this.lastStreamToken=e.streamToken,ae(!e.writeResults||e.writeResults.length===0),this.listener.p_()}onNext(e){ae(!!e.streamToken),this.lastStreamToken=e.streamToken,this.r_.reset();let t=wR(e.writeResults,e.commitTime),r=kt(e.commitTime);return this.listener.y_(r,t)}w_(){let e={};e.database=Vh(this.serializer),this.c_(e)}g_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>IR(this.serializer,r))};this.c_(t)}};var ff=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.S_=!1}b_(){if(this.S_)throw new F(R.FAILED_PRECONDITION,"The client has already been terminated.")}Oo(e,t,r,i){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Oo(e,xh(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new F(R.UNKNOWN,s.toString())})}ko(e,t,r,i,s){return this.b_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.ko(e,xh(t,r),i,a,c,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new F(R.UNKNOWN,a.toString())})}terminate(){this.S_=!0,this.connection.terminate()}},pf=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.D_=0,this.v_=null,this.C_=!0}F_(){this.D_===0&&(this.M_("Unknown"),this.v_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.v_=null,this.x_("Backend didn't respond within 10 seconds."),this.M_("Offline"),Promise.resolve())))}O_(e){this.state==="Online"?this.M_("Unknown"):(this.D_++,this.D_>=1&&(this.N_(),this.x_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.M_("Offline")))}set(e){this.N_(),this.D_=0,e==="Online"&&(this.C_=!1),this.M_(e)}M_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}x_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.C_?(Jt(t),this.C_=!1):V("OnlineStateTracker",t)}N_(){this.v_!==null&&(this.v_.cancel(),this.v_=null)}};var mf=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.L_=[],this.B_=new Map,this.k_=new Set,this.q_=[],this.Q_=s,this.Q_.uo(a=>{r.enqueueAndForget(()=>v(this,null,function*(){mr(this)&&(V("RemoteStore","Restarting streams for network reachability change."),yield function(l){return v(this,null,function*(){let h=G(l);h.k_.add(4),yield io(h),h.K_.set("Unknown"),h.k_.delete(4),yield Rc(h)})}(this))}))}),this.K_=new pf(r,i)}};function Rc(n){return v(this,null,function*(){if(mr(n))for(let e of n.q_)yield e(!0)})}function io(n){return v(this,null,function*(){for(let e of n.q_)yield e(!1)})}function tI(n,e){let t=G(n);t.B_.has(e.targetId)||(t.B_.set(e.targetId,e),Yf(t)?Qf(t):vi(t).s_()&&Kf(t,e))}function Hf(n,e){let t=G(n),r=vi(t);t.B_.delete(e),r.s_()&&nI(t,e),t.B_.size===0&&(r.s_()?r.a_():mr(t)&&t.K_.set("Unknown"))}function Kf(n,e){if(n.U_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(W.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}vi(n).V_(e)}function nI(n,e){n.U_.xe(e),vi(n).m_(e)}function Qf(n){n.U_=new kh({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ut:e=>n.B_.get(e)||null,nt:()=>n.datastore.serializer.databaseId}),vi(n).start(),n.K_.F_()}function Yf(n){return mr(n)&&!vi(n).i_()&&n.B_.size>0}function mr(n){return G(n).k_.size===0}function rI(n){n.U_=void 0}function jR(n){return v(this,null,function*(){n.K_.set("Online")})}function BR(n){return v(this,null,function*(){n.B_.forEach((e,t)=>{Kf(n,e)})})}function $R(n,e){return v(this,null,function*(){rI(n),Yf(n)?(n.K_.O_(e),Qf(n)):n.K_.set("Unknown")})}function zR(n,e,t){return v(this,null,function*(){if(n.K_.set("Online"),e instanceof tc&&e.state===2&&e.cause)try{yield function(i,s){return v(this,null,function*(){let a=s.cause;for(let c of s.targetIds)i.B_.has(c)&&(yield i.remoteSyncer.rejectListen(c,a),i.B_.delete(c),i.U_.removeTarget(c))})}(n,e)}catch(r){V("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield dc(n,r)}else if(e instanceof Zr?n.U_.$e(e):e instanceof ec?n.U_.Je(e):n.U_.Ge(e),!t.isEqual(W.min()))try{let r=yield eI(n.localStore);t.compareTo(r)>=0&&(yield function(s,a){let c=s.U_.it(a);return c.targetChanges.forEach((l,h)=>{if(l.resumeToken.approximateByteSize()>0){let p=s.B_.get(h);p&&s.B_.set(h,p.withResumeToken(l.resumeToken,a))}}),c.targetMismatches.forEach((l,h)=>{let p=s.B_.get(l);if(!p)return;s.B_.set(l,p.withResumeToken($e.EMPTY_BYTE_STRING,p.snapshotVersion)),nI(s,l);let m=new Ys(p.target,l,h,p.sequenceNumber);Kf(s,m)}),s.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(r){V("RemoteStore","Failed to raise snapshot:",r),yield dc(n,r)}})}function dc(n,e,t){return v(this,null,function*(){if(!yi(e))throw e;n.k_.add(1),yield io(n),n.K_.set("Offline"),t||(t=()=>eI(n.localStore)),n.asyncQueue.enqueueRetryable(()=>v(this,null,function*(){V("RemoteStore","Retrying IndexedDB access"),yield t(),n.k_.delete(1),yield Rc(n)}))})}function iI(n,e){return e().catch(t=>dc(n,t,e))}function Dc(n){return v(this,null,function*(){let e=G(n),t=Mn(e),r=e.L_.length>0?e.L_[e.L_.length-1].batchId:-1;for(;qR(e);)try{let i=yield VR(e.localStore,r);if(i===null){e.L_.length===0&&t.a_();break}r=i.batchId,GR(e,i)}catch(i){yield dc(e,i)}sI(e)&&oI(e)})}function qR(n){return mr(n)&&n.L_.length<10}function GR(n,e){n.L_.push(e);let t=Mn(n);t.s_()&&t.f_&&t.g_(e.mutations)}function sI(n){return mr(n)&&!Mn(n).i_()&&n.L_.length>0}function oI(n){Mn(n).start()}function WR(n){return v(this,null,function*(){Mn(n).w_()})}function HR(n){return v(this,null,function*(){let e=Mn(n);for(let t of n.L_)e.g_(t.mutations)})}function KR(n,e,t){return v(this,null,function*(){let r=n.L_.shift(),i=Sh.from(r,e,t);yield iI(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Dc(n)})}function QR(n,e){return v(this,null,function*(){e&&Mn(n).f_&&(yield function(r,i){return v(this,null,function*(){if(function(a){return dR(a)&&a!==R.ABORTED}(i.code)){let s=r.L_.shift();Mn(r).__(),yield iI(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Dc(r)}})}(n,e)),sI(n)&&oI(n)})}function uv(n,e){return v(this,null,function*(){let t=G(n);t.asyncQueue.verifyOperationInProgress(),V("RemoteStore","RemoteStore received new credentials");let r=mr(t);t.k_.add(3),yield io(t),r&&t.K_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.k_.delete(3),yield Rc(t)})}function YR(n,e){return v(this,null,function*(){let t=G(n);e?(t.k_.delete(2),yield Rc(t)):e||(t.k_.add(2),yield io(t),t.K_.set("Unknown"))})}function vi(n){return n.W_||(n.W_=function(t,r,i){let s=G(t);return s.b_(),new df(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Ro:jR.bind(null,n),mo:BR.bind(null,n),po:$R.bind(null,n),R_:zR.bind(null,n)}),n.q_.push(e=>v(this,null,function*(){e?(n.W_.__(),Yf(n)?Qf(n):n.K_.set("Unknown")):(yield n.W_.stop(),rI(n))}))),n.W_}function Mn(n){return n.G_||(n.G_=function(t,r,i){let s=G(t);return s.b_(),new hf(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Ro:()=>Promise.resolve(),mo:WR.bind(null,n),po:QR.bind(null,n),p_:HR.bind(null,n),y_:KR.bind(null,n)}),n.q_.push(e=>v(this,null,function*(){e?(n.G_.__(),yield Dc(n)):(yield n.G_.stop(),n.L_.length>0&&(V("RemoteStore",`Stopping write stream with ${n.L_.length} pending writes`),n.L_=[]))}))),n.G_}var gf=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Yt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let a=Date.now()+r,c=new n(e,t,a,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new F(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Jf(n,e){if(Jt("AsyncQueue",`${e}: ${n}`),yi(n))return new F(R.UNAVAILABLE,`${e}: ${n}`);throw n}var hc=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||L.comparator(t.key,r.key):(t,r)=>L.comparator(t.key,r.key),this.keyedMap=Bs(),this.sortedSet=new Ie(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var fc=class{constructor(){this.z_=new Ie(L.comparator)}track(e){let t=e.doc.key,r=this.z_.get(t);r?e.type!==0&&r.type===3?this.z_=this.z_.insert(t,e):e.type===3&&r.type!==1?this.z_=this.z_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.z_=this.z_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.z_=this.z_.remove(t):e.type===1&&r.type===2?this.z_=this.z_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.z_=this.z_.insert(t,{type:2,doc:e.doc}):j():this.z_=this.z_.insert(t,e)}j_(){let e=[];return this.z_.inorderTraversal((t,r)=>{e.push(r)}),e}},hi=class n{constructor(e,t,r,i,s,a,c,l,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,i,s){let a=[];return t.forEach(c=>{a.push({type:0,doc:c})}),new n(e,t,hc.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ac(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var _f=class{constructor(){this.H_=void 0,this.J_=[]}Y_(){return this.J_.some(e=>e.Z_())}},yf=class{constructor(){this.queries=dv(),this.onlineState="Unknown",this.X_=new Set}terminate(){(function(t,r){let i=G(t),s=i.queries;i.queries=dv(),s.forEach((a,c)=>{for(let l of c.J_)l.onError(r)})})(this,new F(R.ABORTED,"Firestore shutting down"))}};function dv(){return new en(n=>Nv(n),Ac)}function JR(n,e){return v(this,null,function*(){let t=G(n),r=3,i=e.query,s=t.queries.get(i);s?!s.Y_()&&e.Z_()&&(r=2):(s=new _f,r=e.Z_()?0:1);try{switch(r){case 0:s.H_=yield t.onListen(i,!0);break;case 1:s.H_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let c=Jf(a,`Initialization of query '${Qr(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,s),s.J_.push(e),e.ea(t.onlineState),s.H_&&e.ta(s.H_)&&Xf(t)})}function XR(n,e){return v(this,null,function*(){let t=G(n),r=e.query,i=3,s=t.queries.get(r);if(s){let a=s.J_.indexOf(e);a>=0&&(s.J_.splice(a,1),s.J_.length===0?i=e.Z_()?0:1:!s.Y_()&&e.Z_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function ZR(n,e){let t=G(n),r=!1;for(let i of e){let s=i.query,a=t.queries.get(s);if(a){for(let c of a.J_)c.ta(i)&&(r=!0);a.H_=i}}r&&Xf(t)}function eD(n,e,t){let r=G(n),i=r.queries.get(e);if(i)for(let s of i.J_)s.onError(t);r.queries.delete(e)}function Xf(n){n.X_.forEach(e=>{e.next()})}var vf,hv;(hv=vf||(vf={})).na="default",hv.Cache="cache";var If=class{constructor(e,t,r){this.query=e,this.ra=t,this.ia=!1,this.sa=null,this.onlineState="Unknown",this.options=r||{}}ta(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new hi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ia?this.oa(e)&&(this.ra.next(e),t=!0):this._a(e,this.onlineState)&&(this.aa(e),t=!0),this.sa=e,t}onError(e){this.ra.error(e)}ea(e){this.onlineState=e;let t=!1;return this.sa&&!this.ia&&this._a(this.sa,e)&&(this.aa(this.sa),t=!0),t}_a(e,t){if(!e.fromCache||!this.Z_())return!0;let r=t!=="Offline";return(!this.options.ua||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}oa(e){if(e.docChanges.length>0)return!0;let t=this.sa&&this.sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}aa(e){e=hi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ia=!0,this.ra.next(e)}Z_(){return this.options.source!==vf.Cache}};var pc=class{constructor(e){this.key=e}},mc=class{constructor(e){this.key=e}},wf=class{constructor(e,t){this.query=e,this.da=t,this.Aa=null,this.hasCachedResults=!1,this.current=!1,this.Ra=J(),this.mutatedKeys=J(),this.Va=xv(e),this.ma=new hc(this.Va)}get fa(){return this.da}ga(e,t){let r=t?t.pa:new fc,i=t?t.ma:this.ma,s=t?t.mutatedKeys:this.mutatedKeys,a=i,c=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,m)=>{let E=i.get(p),S=Cc(this.query,m)?m:null,P=!!E&&this.mutatedKeys.has(E.key),x=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations),k=!1;E&&S?E.data.isEqual(S.data)?P!==x&&(r.track({type:3,doc:S}),k=!0):this.ya(E,S)||(r.track({type:2,doc:S}),k=!0,(l&&this.Va(S,l)>0||h&&this.Va(S,h)<0)&&(c=!0)):!E&&S?(r.track({type:0,doc:S}),k=!0):E&&!S&&(r.track({type:1,doc:E}),k=!0,(l||h)&&(c=!0)),k&&(S?(a=a.add(S),s=x?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{ma:a,pa:r,ss:c,mutatedKeys:s}}ya(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.ma;this.ma=e.ma,this.mutatedKeys=e.mutatedKeys;let a=e.pa.j_();a.sort((p,m)=>function(S,P){let x=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return j()}};return x(S)-x(P)}(p.type,m.type)||this.Va(p.doc,m.doc)),this.wa(r),i=i!=null&&i;let c=t&&!i?this.Sa():[],l=this.Ra.size===0&&this.current&&!i?1:0,h=l!==this.Aa;return this.Aa=l,a.length!==0||h?{snapshot:new hi(this.query,e.ma,s,a,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),ba:c}:{ba:c}}ea(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ma:this.ma,pa:new fc,mutatedKeys:this.mutatedKeys,ss:!1},!1)):{ba:[]}}Da(e){return!this.da.has(e)&&!!this.ma.has(e)&&!this.ma.get(e).hasLocalMutations}wa(e){e&&(e.addedDocuments.forEach(t=>this.da=this.da.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.da=this.da.delete(t)),this.current=e.current)}Sa(){if(!this.current)return[];let e=this.Ra;this.Ra=J(),this.ma.forEach(r=>{this.Da(r.key)&&(this.Ra=this.Ra.add(r.key))});let t=[];return e.forEach(r=>{this.Ra.has(r)||t.push(new mc(r))}),this.Ra.forEach(r=>{e.has(r)||t.push(new pc(r))}),t}va(e){this.da=e.ds,this.Ra=J();let t=this.ga(e.documents);return this.applyChanges(t,!0)}Ca(){return hi.fromInitialDocuments(this.query,this.ma,this.mutatedKeys,this.Aa===0,this.hasCachedResults)}},Ef=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},bf=class{constructor(e){this.key=e,this.Fa=!1}},Tf=class{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ma={},this.xa=new en(c=>Nv(c),Ac),this.Oa=new Map,this.Na=new Set,this.La=new Ie(L.comparator),this.Ba=new Map,this.ka=new Xs,this.qa={},this.Qa=new Map,this.Ka=Js.Qn(),this.onlineState="Unknown",this.$a=void 0}get isPrimaryClient(){return this.$a===!0}};function tD(n,e,t=!0){return v(this,null,function*(){let r=hI(n),i,s=r.xa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Ca()):i=yield aI(r,e,t,!0),i})}function nD(n,e){return v(this,null,function*(){let t=hI(n);yield aI(t,e,!0,!1)})}function aI(n,e,t,r){return v(this,null,function*(){let i=yield FR(n.localStore,Pt(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t),c;return r&&(c=yield rD(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&tI(n.remoteStore,i),c})}function rD(n,e,t,r,i){return v(this,null,function*(){n.Ua=(m,E,S)=>function(x,k,z,Q){return v(this,null,function*(){let K=k.view.ga(z);K.ss&&(K=yield lv(x.localStore,k.query,!1).then(({documents:w})=>k.view.ga(w,K)));let de=Q&&Q.targetChanges.get(k.targetId),ze=Q&&Q.targetMismatches.get(k.targetId)!=null,ce=k.view.applyChanges(K,x.isPrimaryClient,de,ze);return pv(x,k.targetId,ce.ba),ce.snapshot})}(n,m,E,S);let s=yield lv(n.localStore,e,!0),a=new wf(e,s.ds),c=a.ga(s.documents),l=Qs.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),h=a.applyChanges(c,n.isPrimaryClient,l);pv(n,t,h.ba);let p=new Ef(e,t,a);return n.xa.set(e,p),n.Oa.has(t)?n.Oa.get(t).push(e):n.Oa.set(t,[e]),h.snapshot})}function iD(n,e,t){return v(this,null,function*(){let r=G(n),i=r.xa.get(e),s=r.Oa.get(i.targetId);if(s.length>1)return r.Oa.set(i.targetId,s.filter(a=>!Ac(a,e))),void r.xa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield of(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Hf(r.remoteStore,i.targetId),Af(r,i.targetId)}).catch(_i))):(Af(r,i.targetId),yield of(r.localStore,i.targetId,!0))})}function sD(n,e){return v(this,null,function*(){let t=G(n),r=t.xa.get(e),i=t.Oa.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Hf(t.remoteStore,r.targetId))})}function oD(n,e,t){return v(this,null,function*(){let r=fD(n);try{let i=yield function(a,c){let l=G(a),h=De.now(),p=c.reduce((S,P)=>S.add(P.key),J()),m,E;return l.persistence.runTransaction("Locally write mutations","readwrite",S=>{let P=tn(),x=J();return l.hs.getEntries(S,p).next(k=>{P=k,P.forEach((z,Q)=>{Q.isValidDocument()||(x=x.add(z))})}).next(()=>l.localDocuments.getOverlayedDocuments(S,P)).next(k=>{m=k;let z=[];for(let Q of c){let K=uR(Q,m.get(Q.key).overlayedDocument);K!=null&&z.push(new nn(Q.key,K,Cv(K.value.mapValue),ar.exists(!0)))}return l.mutationQueue.addMutationBatch(S,h,z,c)}).next(k=>{E=k;let z=k.applyToLocalDocumentSet(m,x);return l.documentOverlayCache.saveOverlays(S,k.batchId,z)})}).then(()=>({batchId:E.batchId,changes:Vv(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,c,l){let h=a.qa[a.currentUser.toKey()];h||(h=new Ie(ee)),h=h.insert(c,l),a.qa[a.currentUser.toKey()]=h}(r,i.batchId,t),yield so(r,i.changes),yield Dc(r.remoteStore)}catch(i){let s=Jf(i,"Failed to persist write");t.reject(s)}})}function cI(n,e){return v(this,null,function*(){let t=G(n);try{let r=yield xR(t.localStore,e);e.targetChanges.forEach((i,s)=>{let a=t.Ba.get(s);a&&(ae(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.Fa=!0:i.modifiedDocuments.size>0?ae(a.Fa):i.removedDocuments.size>0&&(ae(a.Fa),a.Fa=!1))}),yield so(t,r,e)}catch(r){yield _i(r)}})}function fv(n,e,t){let r=G(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.xa.forEach((s,a)=>{let c=a.view.ea(e);c.snapshot&&i.push(c.snapshot)}),function(a,c){let l=G(a);l.onlineState=c;let h=!1;l.queries.forEach((p,m)=>{for(let E of m.J_)E.ea(c)&&(h=!0)}),h&&Xf(l)}(r.eventManager,e),i.length&&r.Ma.R_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function aD(n,e,t){return v(this,null,function*(){let r=G(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Ba.get(e),s=i&&i.key;if(s){let a=new Ie(L.comparator);a=a.insert(s,wt.newNoDocument(s,W.min()));let c=J().add(s),l=new Za(W.min(),new Map,new Ie(ee),a,c);yield cI(r,l),r.La=r.La.remove(s),r.Ba.delete(e),Zf(r)}else yield of(r.localStore,e,!1).then(()=>Af(r,e,t)).catch(_i)})}function cD(n,e){return v(this,null,function*(){let t=G(n),r=e.batch.batchId;try{let i=yield NR(t.localStore,e);uI(t,r,null),lI(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield so(t,i)}catch(i){yield _i(i)}})}function lD(n,e,t){return v(this,null,function*(){let r=G(n);try{let i=yield function(a,c){let l=G(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let p;return l.mutationQueue.lookupMutationBatch(h,c).next(m=>(ae(m!==null),p=m.keys(),l.mutationQueue.removeMutationBatch(h,m))).next(()=>l.mutationQueue.performConsistencyCheck(h)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(h,p,c)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p)).next(()=>l.localDocuments.getDocuments(h,p))})}(r.localStore,e);uI(r,e,t),lI(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield so(r,i)}catch(i){yield _i(i)}})}function lI(n,e){(n.Qa.get(e)||[]).forEach(t=>{t.resolve()}),n.Qa.delete(e)}function uI(n,e,t){let r=G(n),i=r.qa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.qa[r.currentUser.toKey()]=i}}function Af(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Oa.get(e))n.xa.delete(r),t&&n.Ma.Wa(r,t);n.Oa.delete(e),n.isPrimaryClient&&n.ka.yr(e).forEach(r=>{n.ka.containsKey(r)||dI(n,r)})}function dI(n,e){n.Na.delete(e.path.canonicalString());let t=n.La.get(e);t!==null&&(Hf(n.remoteStore,t),n.La=n.La.remove(e),n.Ba.delete(t),Zf(n))}function pv(n,e,t){for(let r of t)r instanceof pc?(n.ka.addReference(r.key,e),uD(n,r)):r instanceof mc?(V("SyncEngine","Document no longer in limbo: "+r.key),n.ka.removeReference(r.key,e),n.ka.containsKey(r.key)||dI(n,r.key)):j()}function uD(n,e){let t=e.key,r=t.path.canonicalString();n.La.get(t)||n.Na.has(r)||(V("SyncEngine","New document in limbo: "+t),n.Na.add(r),Zf(n))}function Zf(n){for(;n.Na.size>0&&n.La.size<n.maxConcurrentLimboResolutions;){let e=n.Na.values().next().value;n.Na.delete(e);let t=new L(ye.fromString(e)),r=n.Ka.next();n.Ba.set(r,new bf(t)),n.La=n.La.insert(t,r),tI(n.remoteStore,new Ys(Pt(qf(t.path)),r,"TargetPurposeLimboResolution",Uf.oe))}}function so(n,e,t){return v(this,null,function*(){let r=G(n),i=[],s=[],a=[];r.xa.isEmpty()||(r.xa.forEach((c,l)=>{a.push(r.Ua(l,e,t).then(h=>{var p;if((h||t)&&r.isPrimaryClient){let m=h?!h.fromCache:(p=t?.targetChanges.get(l.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(l.targetId,m?"current":"not-current")}if(h){i.push(h);let m=tf.zi(l.targetId,h);s.push(m)}}))}),yield Promise.all(a),r.Ma.R_(i),yield function(l,h){return v(this,null,function*(){let p=G(l);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>D.forEach(h,E=>D.forEach(E.Wi,S=>p.persistence.referenceDelegate.addReference(m,E.targetId,S)).next(()=>D.forEach(E.Gi,S=>p.persistence.referenceDelegate.removeReference(m,E.targetId,S)))))}catch(m){if(!yi(m))throw m;V("LocalStore","Failed to update sequence numbers: "+m)}for(let m of h){let E=m.targetId;if(!m.fromCache){let S=p.us.get(E),P=S.snapshotVersion,x=S.withLastLimboFreeSnapshotVersion(P);p.us=p.us.insert(E,x)}}})}(r.localStore,s))})}function dD(n,e){return v(this,null,function*(){let t=G(n);if(!t.currentUser.isEqual(e)){V("SyncEngine","User change. New user:",e.toKey());let r=yield Zv(t.localStore,e);t.currentUser=e,function(s,a){s.Qa.forEach(c=>{c.forEach(l=>{l.reject(new F(R.CANCELLED,a))})}),s.Qa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield so(t,r.Ts)}})}function hD(n,e){let t=G(n),r=t.Ba.get(e);if(r&&r.Fa)return J().add(r.key);{let i=J(),s=t.Oa.get(e);if(!s)return i;for(let a of s){let c=t.xa.get(a);i=i.unionWith(c.view.fa)}return i}}function hI(n){let e=G(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=cI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=hD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=aD.bind(null,e),e.Ma.R_=ZR.bind(null,e.eventManager),e.Ma.Wa=eD.bind(null,e.eventManager),e}function fD(n){let e=G(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=cD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=lD.bind(null,e),e}var fI=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return v(this,null,function*(){this.serializer=Sc(t.databaseInfo.databaseId),this.sharedClientState=this.za(t),this.persistence=this.ja(t),yield this.persistence.start(),this.localStore=this.Ha(t),this.gcScheduler=this.Ja(t,this.localStore),this.indexBackfillerScheduler=this.Ya(t,this.localStore)})}Ja(t,r){return null}Ya(t,r){return null}Ha(t){return MR(this.persistence,new rf,t.initialUser,this.serializer)}ja(t){return new sc(ef.ei,this.serializer)}za(t){return new af}terminate(){return v(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),Cf=class extends fI{constructor(e){super(),this.cacheSizeBytes=e}Ja(e,t){ae(this.persistence.referenceDelegate instanceof oc);let r=this.persistence.referenceDelegate.garbageCollector;return new Bh(r,e.asyncQueue,t)}ja(e){let t=this.cacheSizeBytes!==void 0?ut.withCacheSize(this.cacheSizeBytes):ut.DEFAULT;return new sc(r=>oc.ei(r,t),this.serializer)}};var pD=(()=>{class n{initialize(t,r){return v(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>fv(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=dD.bind(null,this.syncEngine),yield YR(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new yf}()}createDatastore(t){let r=Sc(t.databaseInfo.databaseId),i=function(a){return new uf(a)}(t.databaseInfo);return function(a,c,l,h){return new ff(a,c,l,h)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,a,c,l){return new mf(i,s,a,c,l)}(this.localStore,this.datastore,t.asyncQueue,r=>fv(this.syncEngine,r,0),function(){return cc.p()?new cc:new cf}())}createSyncEngine(t,r){return function(s,a,c,l,h,p,m){let E=new Tf(s,a,c,l,h,p);return m&&(E.$a=!0),E}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return v(this,null,function*(){var t,r;yield function(s){return v(this,null,function*(){let a=G(s);V("RemoteStore","RemoteStore shutting down."),a.k_.add(5),yield io(a),a.Q_.shutdown(),a.K_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var Sf=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Xa(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Xa(this.observer.error,e):Jt("Uncaught Error in snapshot listener:",e.toString()))}eu(){this.muted=!0}Xa(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Rf=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ne.UNAUTHENTICATED,this.clientId=Wa.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,a=>v(this,null,function*(){V("FirestoreClient","Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,a=>(V("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Yt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Jf(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Zd(n,e){return v(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),V("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>v(this,null,function*(){r.isEqual(i)||(yield Zv(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function mv(n,e){return v(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield mD(n);V("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>uv(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>uv(e.remoteStore,i)),n._onlineComponents=e})}function mD(n){return v(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Zd(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===R.FAILED_PRECONDITION||i.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;ni("Error using user provided cache. Falling back to memory cache: "+t),yield Zd(n,new fI)}}else V("FirestoreClient","Using default OfflineComponentProvider"),yield Zd(n,new Cf(void 0));return n._offlineComponents})}function pI(n){return v(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(V("FirestoreClient","Using user provided OnlineComponentProvider"),yield mv(n,n._uninitializedComponentsProvider._online)):(V("FirestoreClient","Using default OnlineComponentProvider"),yield mv(n,new pD))),n._onlineComponents})}function gD(n){return pI(n).then(e=>e.syncEngine)}function gv(n){return v(this,null,function*(){let e=yield pI(n),t=e.eventManager;return t.onListen=tD.bind(null,e.syncEngine),t.onUnlisten=iD.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=nD.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=sD.bind(null,e.syncEngine),t})}function mI(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var _v=new Map;function gI(n,e,t){if(!t)throw new F(R.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function _D(n,e,t,r){if(e===!0&&r===!0)throw new F(R.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function yv(n){if(!L.isDocumentKey(n))throw new F(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function vv(n){if(L.isDocumentKey(n))throw new F(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Pc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":j()}function ei(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new F(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Pc(n);throw new F(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var gc=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new F(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new F(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_D("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mI((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new F(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new F(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new F(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},fi=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gc({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new F(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new F(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gc(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new eh;switch(r.type){case"firstParty":return new ih(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new F(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return v(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=_v.get(t);r&&(V("ComponentProvider","Removing Datastore"),_v.delete(t),r.terminate())}(this),Promise.resolve()}};function _I(n,e,t,r={}){var i;let s=(n=ei(n,fi))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&ni("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let c,l;if(typeof r.mockUserToken=="string")c=r.mockUserToken,l=Ne.MOCK_USER;else{c=E_(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let h=r.mockUserToken.sub||r.mockUserToken.user_id;if(!h)throw new F(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Ne(h)}n._authCredentials=new th(new Ga(c,l))}}var pi=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ye=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Pn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Pn=class n extends pi{constructor(e,t,r){super(e,t,qf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ye(this.firestore,null,new L(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function yI(n,e,...t){if(n=Qe(n),gI("collection","path",e),n instanceof fi){let r=ye.fromString(e,...t);return vv(r),new Pn(n,null,r)}{if(!(n instanceof Ye||n instanceof Pn))throw new F(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ye.fromString(e,...t));return vv(r),new Pn(n.firestore,null,r)}}function vI(n,e,...t){if(n=Qe(n),arguments.length===1&&(e=Wa.newId()),gI("doc","path",e),n instanceof fi){let r=ye.fromString(e,...t);return yv(r),new Ye(n,null,new L(r))}{if(!(n instanceof Ye||n instanceof Pn))throw new F(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ye.fromString(e,...t));return yv(r),new Ye(n.firestore,n instanceof Pn?n.converter:null,new L(r))}}var _c=class{constructor(e=Promise.resolve()){this.Iu=[],this.Eu=!1,this.du=[],this.Au=null,this.Ru=!1,this.Vu=!1,this.mu=[],this.r_=new lc(this,"async_queue_retry"),this.fu=()=>{let r=Xd();r&&V("AsyncQueue","Visibility state changed to "+r.visibilityState),this.r_.Jo()},this.gu=e;let t=Xd();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.fu)}get isShuttingDown(){return this.Eu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.pu(),this.yu(e)}enterRestrictedMode(e){if(!this.Eu){this.Eu=!0,this.Vu=e||!1;let t=Xd();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.fu)}}enqueue(e){if(this.pu(),this.Eu)return new Promise(()=>{});let t=new Yt;return this.yu(()=>this.Eu&&this.Vu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Iu.push(e),this.wu()))}wu(){return v(this,null,function*(){if(this.Iu.length!==0){try{yield this.Iu[0](),this.Iu.shift(),this.r_.reset()}catch(e){if(!yi(e))throw e;V("AsyncQueue","Operation failed with retryable error: "+e)}this.Iu.length>0&&this.r_.jo(()=>this.wu())}})}yu(e){let t=this.gu.then(()=>(this.Ru=!0,e().catch(r=>{this.Au=r,this.Ru=!1;let i=function(a){let c=a.message||"";return a.stack&&(c=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),c}(r);throw Jt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Ru=!1,r))));return this.gu=t,t}enqueueAfterDelay(e,t,r){this.pu(),this.mu.indexOf(e)>-1&&(t=0);let i=gf.createAndSchedule(this,e,t,r,s=>this.Su(s));return this.du.push(i),i}pu(){this.Au&&j()}verifyOperationInProgress(){}bu(){return v(this,null,function*(){let e;do e=this.gu,yield e;while(e!==this.gu)})}Du(e){for(let t of this.du)if(t.timerId===e)return!0;return!1}vu(e){return this.bu().then(()=>{this.du.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.du)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.bu()})}Cu(e){this.mu.push(e)}Su(e){let t=this.du.indexOf(e);this.du.splice(t,1)}};function Iv(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var mi=class extends fi{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new _c,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return v(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new _c(e),this._firestoreClient=void 0,yield e}})}};function II(n,e){let t=typeof n=="object"?n:$r(),r=typeof n=="string"?n:e||"(default)",i=Ds(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=w_("firestore");s&&_I(i,...s)}return i}function wI(n){if(n._terminated)throw new F(R.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||yD(n),n._firestoreClient}function yD(n){var e,t,r;let i=n._freezeSettings(),s=function(c,l,h,p){return new lh(c,l,h,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,mI(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Rf(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(c){let l=c?._online.build();return{_offline:c?._offline.build(l),_online:l}}(n._componentsProvider))}var Zs=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n($e.fromBase64String(e))}catch(t){throw new F(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n($e.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var eo=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new F(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new nt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var yc=class{constructor(e){this._methodName=e}};var to=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new F(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new F(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}};var no=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var vD=/^__.*__$/,Df=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new nn(e,this.data,this.fieldMask,t,this.fieldTransforms):new fr(e,this.data,t,this.fieldTransforms)}};function EI(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw j()}}var Pf=class n{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Fu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Mu(){return this.settings.Mu}xu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ou(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.xu({path:r,Nu:!1});return i.Lu(e),i}Bu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.xu({path:r,Nu:!1});return i.Fu(),i}ku(e){return this.xu({path:void 0,Nu:!0})}qu(e){return vc(e,this.settings.methodName,this.settings.Qu||!1,this.path,this.settings.Ku)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Fu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Lu(this.path.get(e))}Lu(e){if(e.length===0)throw this.qu("Document fields must not be empty");if(EI(this.Mu)&&vD.test(e))throw this.qu('Document fields cannot begin and end with "__"')}},kf=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Sc(e)}$u(e,t,r,i=!1){return new Pf({Mu:e,methodName:t,Ku:r,path:nt.emptyPath(),Nu:!1,Qu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function bI(n){let e=n._freezeSettings(),t=Sc(n._databaseId);return new kf(n._databaseId,!!e.ignoreUndefinedProperties,t)}function ID(n,e,t,r,i,s={}){let a=n.$u(s.merge||s.mergeFields?2:0,e,t,i);CI("Data must be an object, but it was:",a,r);let c=TI(r,a),l,h;if(s.merge)l=new Rt(a.fieldMask),h=a.fieldTransforms;else if(s.mergeFields){let p=[];for(let m of s.mergeFields){let E=ED(e,m,t);if(!a.contains(E))throw new F(R.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);TD(p,E)||p.push(E)}l=new Rt(p),h=a.fieldTransforms.filter(m=>l.covers(m.field))}else l=null,h=a.fieldTransforms;return new Df(new It(c),l,h)}function wD(n,e,t,r=!1){return ep(t,n.$u(r?4:3,e))}function ep(n,e){if(AI(n=Qe(n)))return CI("Unsupported field value:",e,n),TI(n,e);if(n instanceof yc)return function(r,i){if(!EI(i.Mu))throw i.qu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.qu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Nu&&e.Mu!==4)throw e.qu("Nested arrays are not supported");return function(r,i){let s=[],a=0;for(let c of r){let l=ep(c,i.ku(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Qe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return sR(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=De.fromDate(r);return{timestampValue:rc(i.serializer,s)}}if(r instanceof De){let s=new De(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:rc(i.serializer,s)}}if(r instanceof to)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Zs)return{bytesValue:Wv(i.serializer,r._byteString)};if(r instanceof Ye){let s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.qu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Wf(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof no)return function(a,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw c.qu("VectorValues must only contain numeric values.");return Gf(c.serializer,l)})}}}}}}(r,i);throw i.qu(`Unsupported field value: ${Pc(r)}`)}(n,e)}function TI(n,e){let t={};return bv(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):pr(n,(r,i)=>{let s=ep(i,e.Ou(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function AI(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof De||n instanceof to||n instanceof Zs||n instanceof Ye||n instanceof yc||n instanceof no)}function CI(n,e,t){if(!AI(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Pc(t);throw r==="an object"?e.qu(n+" a custom object"):e.qu(n+" "+r)}}function ED(n,e,t){if((e=Qe(e))instanceof eo)return e._internalPath;if(typeof e=="string")return SI(n,e);throw vc("Field path arguments must be of type string or ",n,!1,void 0,t)}var bD=new RegExp("[~\\*/\\[\\]]");function SI(n,e,t){if(e.search(bD)>=0)throw vc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new eo(...e.split("."))._internalPath}catch{throw vc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function vc(n,e,t,r,i){let s=r&&!r.isEmpty(),a=i!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new F(R.INVALID_ARGUMENT,c+n+l)}function TD(n,e){return n.some(t=>t.isEqual(e))}var Ic=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ye(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Mf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(RI("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Mf=class extends Ic{data(){return super.data()}};function RI(n,e){return typeof e=="string"?SI(n,e):e instanceof eo?e._internalPath:e._delegate._internalPath}function AD(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new F(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ro=class{},Nf=class extends ro{};function DI(n,e,...t){let r=[];e instanceof ro&&r.push(e),r=r.concat(t),function(s){let a=s.filter(l=>l instanceof Of).length,c=s.filter(l=>l instanceof xf).length;if(a>1||a>0&&c>0)throw new F(R.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var xf=class n extends Nf{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return PI(e._query,t),new pi(e.firestore,e.converter,Eh(e._query,t))}_parse(e){let t=bI(e.firestore);return function(s,a,c,l,h,p,m){let E;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new F(R.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Ev(m,p);let S=[];for(let P of m)S.push(wv(l,s,P));E={arrayValue:{values:S}}}else E=wv(l,s,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Ev(m,p),E=wD(c,a,m,p==="in"||p==="not-in");return Ae.create(h,p,E)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};var Of=class n extends ro{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Et.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i,c=s.getFlattenedFilters();for(let l of c)PI(a,l),a=Eh(a,l)}(e._query,t),new pi(e.firestore,e.converter,Eh(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function wv(n,e,t){if(typeof(t=Qe(t))=="string"){if(t==="")throw new F(R.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Mv(e)&&t.indexOf("/")!==-1)throw new F(R.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(ye.fromString(t));if(!L.isDocumentKey(r))throw new F(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Gy(n,new L(r))}if(t instanceof Ye)return Gy(n,t._key);throw new F(R.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Pc(t)}.`)}function Ev(n,e){if(!Array.isArray(n)||n.length===0)throw new F(R.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function PI(n,e){let t=function(i,s){for(let a of i)for(let c of a.getFlattenedFilters())if(s.indexOf(c.op)>=0)return c.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new F(R.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new F(R.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Vf=class{convertValue(e,t="none"){switch(kn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return me(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Zt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw j()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return pr(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>me(a.doubleValue));return new no(s)}convertGeoPoint(e){return new to(me(e.latitude),me(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Tc(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Hs(e));default:return null}}convertTimestamp(e){let t=Xt(e);return new De(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ye.fromString(e);ae(Xv(r));let i=new Ya(r.get(1),r.get(3)),s=new L(r.popFirst(5));return i.isEqual(t)||Jt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function CD(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var or=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},wc=class extends Ic{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new ti(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(RI("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},ti=class extends wc{data(e={}){return super.data(e)}},Ff=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new or(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new ti(this._firestore,this._userDataWriter,r.key,r,new or(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new F(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(c=>{let l=new ti(i._firestore,i._userDataWriter,c.doc.key,c.doc,new or(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{let l=new ti(i._firestore,i._userDataWriter,c.doc.key,c.doc,new or(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),h=-1,p=-1;return c.type!==0&&(h=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),p=a.indexOf(c.doc.key)),{type:SD(c.type),doc:l,oldIndex:h,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function SD(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return j()}}var Ec=class extends Vf{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zs(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ye(this.firestore,null,t)}};function kI(n,e,t){n=ei(n,Ye);let r=ei(n.firestore,mi),i=CD(n.converter,e,t);return RD(r,[ID(bI(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,ar.none())])}function tp(n,...e){var t,r,i;n=Qe(n);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||Iv(e[a])||(s=e[a],a++);let c={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Iv(e[a])){let m=e[a];e[a]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[a+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[a+2]=(i=m.complete)===null||i===void 0?void 0:i.bind(m)}let l,h,p;if(n instanceof Ye)h=ei(n.firestore,mi),p=qf(n._key.path),l={next:m=>{e[a]&&e[a](DD(h,n,m))},error:e[a+1],complete:e[a+2]};else{let m=ei(n,pi);h=ei(m.firestore,mi),p=m._query;let E=new Ec(h);l={next:S=>{e[a]&&e[a](new Ff(h,E,m,S))},error:e[a+1],complete:e[a+2]},AD(n._query)}return function(E,S,P,x){let k=new Sf(x),z=new If(S,k,P);return E.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return JR(yield gv(E),z)})),()=>{k.eu(),E.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return XR(yield gv(E),z)}))}}(wI(h),p,c,l)}function RD(n,e){return function(r,i){let s=new Yt;return r.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return oD(yield gD(r),i,s)})),s.promise}(wI(n),e)}function DD(n,e,t){let r=t.docs.get(e._key),i=new Ec(n);return new wc(n,i,e._key,r,new or(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){gi=i})(An),Tn(new lt("firestore",(r,{instanceIdentifier:i,options:s})=>{let a=r.getProvider("app").getImmediate(),c=new mi(new nh(r.getProvider("auth-internal")),new oh(r.getProvider("app-check-internal")),function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new F(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ya(h.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),Re(jy,"4.7.5",e),Re(jy,"4.7.5","esm2017")})();var kc=function(){return kc=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},kc.apply(this,arguments)};var MD={includeMetadataChanges:!1};function MI(n,e){return e===void 0&&(e=MD),new dn(function(t){var r=tp(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function NI(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:kc(kc({},r),(t={},t[e.idField]=n.id,t))}function xI(n){return MI(n,{includeMetadataChanges:!0}).pipe(B(function(e){return e.docs}))}function OI(n,e){return e===void 0&&(e={}),xI(n).pipe(B(function(t){return t.map(function(r){return NI(r,e)})}))}var gr=class{constructor(e){return e}},VI="firestore",np=class{constructor(){return ks(VI)}};var rp=new X("angularfire2.firestore-instances");function ND(n,e){let t=ya(VI,n,e);return t&&new gr(t)}function xD(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new gr(r)}}var OD={provide:np,deps:[[new He,rp]]},VD={provide:gr,useFactory:ND,deps:[[new He,rp],Wt]};function FI(n,...e){return Re("angularfire",Xn.full,"fst"),ft([VD,OD,{provide:rp,useFactory:xD(n),multi:!0,deps:[we,pt,qr,Zn,[new He,Us],[new He,zr],...e]}])}var ip=vt(OI,!0);var sp=vt(yI,!0);var LI=vt(vI,!0);var UI=vt(II,!0);var op=vt(DI,!0);var jI=vt(kI,!0);var Nn=class n{firestore=N(gr);toolCollection;userCollection;tools$;users$;auth=Va();constructor(){this.toolCollection=sp(this.firestore,"Tools");var e=op(this.toolCollection);this.tools$=ip(e),this.userCollection=sp(this.firestore,"Users"),e=op(this.userCollection),this.users$=ip(e)}addTool(e){return v(this,null,function*(){try{let t=LI(this.toolCollection),r=t.id;return yield jI(t,se(O({},e),{id:r,timestamp:De.fromDate(new Date)})),console.log("Tool successfully added with ID:",r),r}catch(t){console.error("Error adding tool:",t)}return"Failed to add tool"})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})};var ap;try{ap=typeof Intl<"u"&&Intl.v8BreakIterator}catch{ap=!1}var Ii=(()=>{class n{_platformId=N(Lt);isBrowser=this._platformId?_g(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||ap)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function cp(n){return Array.isArray(n)?n:[n]}var BI=new Set,_r,FD=(()=>{class n{_platform=N(Ii);_nonce=N(Hi,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):UD}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&LD(t,this._nonce),this._matchMedia(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function LD(n,e){if(!BI.has(n))try{_r||(_r=document.createElement("style"),e&&_r.setAttribute("nonce",e),_r.setAttribute("type","text/css"),document.head.appendChild(_r)),_r.sheet&&(_r.sheet.insertRule(`@media ${n} {body{ }}`,0),BI.add(n))}catch(t){console.error(t)}}function UD(n){return{matches:n==="all"||n==="",media:n,addListener:()=>{},removeListener:()=>{}}}var zI=(()=>{class n{_mediaMatcher=N(FD);_zone=N(we);_queries=new Map;_destroySubject=new rt;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return $I(cp(t)).some(i=>this._registerQuery(i).mql.matches)}observe(t){let i=$I(cp(t)).map(a=>this._registerQuery(a).observable),s=qi(i);return s=No(s.pipe(bt(1)),s.pipe(Nm(1),Dm(0))),s.pipe(B(a=>{let c={matches:!1,breakpoints:{}};return a.forEach(({matches:l,query:h})=>{c.matches=c.matches||l,c.breakpoints[h]=l}),c}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);let r=this._mediaMatcher.matchMedia(t),s={observable:new dn(a=>{let c=l=>this._zone.run(()=>a.next(l));return r.addListener(c),()=>{r.removeListener(c)}}).pipe(Gi(r),B(({matches:a})=>({query:t,matches:a})),Oo(this._destroySubject)),mql:r};return this._queries.set(t,s),s}static \u0275fac=function(r){return new(r||n)};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function $I(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}var yr=function(n){return n[n.NONE=0]="NONE",n[n.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",n[n.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",n}(yr||{}),qI="cdk-high-contrast-black-on-white",GI="cdk-high-contrast-white-on-black",lp="cdk-high-contrast-active",WI=(()=>{class n{_platform=N(Ii);_hasCheckedHighContrastMode;_document=N(Ee);_breakpointSubscription;constructor(){this._breakpointSubscription=N(zI).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return yr.NONE;let t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);let r=this._document.defaultView||window,i=r&&r.getComputedStyle?r.getComputedStyle(t):null,s=(i&&i.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return yr.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return yr.BLACK_ON_WHITE}return yr.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let t=this._document.body.classList;t.remove(lp,qI,GI),this._hasCheckedHighContrastMode=!0;let r=this.getHighContrastMode();r===yr.BLACK_ON_WHITE?t.add(lp,qI):r===yr.WHITE_ON_BLACK&&t.add(lp,GI)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var up=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Se({type:n});static \u0275inj=Ce({})}return n})();var rn=(()=>{class n{constructor(){N(WI)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Se({type:n});static \u0275inj=Ce({imports:[up,up]})}return n})();var BD=["*",[["mat-toolbar-row"]]],$D=["*","mat-toolbar-row"],zD=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=fe({type:n,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]})}return n})(),HI=(()=>{class n{_elementRef=N(mt);_platform=N(Ii);_document=N(Ee);color;_toolbarRows;constructor(){}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Pe({type:n,selectors:[["mat-toolbar"]],contentQueries:function(r,i,s){if(r&1&&Nl(s,zD,5),r&2){let a;$o(a=zo())&&(i._toolbarRows=a)}},hostAttrs:[1,"mat-toolbar"],hostVars:6,hostBindings:function(r,i){r&2&&(Bo(i.color?"mat-"+i.color:""),Tt("mat-toolbar-multiple-rows",i._toolbarRows.length>0)("mat-toolbar-single-row",i._toolbarRows.length===0))},inputs:{color:"color"},exportAs:["matToolbar"],ngContentSelectors:$D,decls:2,vars:0,template:function(r,i){r&1&&(gn(BD),gt(0),gt(1,1))},styles:[".mat-toolbar{background:var(--mat-toolbar-container-background-color, var(--mat-sys-surface));color:var(--mat-toolbar-container-text-color, var(--mat-sys-on-surface))}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font, var(--mat-sys-title-large-font));font-size:var(--mat-toolbar-title-text-size, var(--mat-sys-title-large-size));line-height:var(--mat-toolbar-title-text-line-height, var(--mat-sys-title-large-line-height));font-weight:var(--mat-toolbar-title-text-weight, var(--mat-sys-title-large-weight));letter-spacing:var(--mat-toolbar-title-text-tracking, var(--mat-sys-title-large-tracking));margin:0}@media(forced-colors: active){.mat-toolbar{outline:solid 1px}}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mdc-text-button-label-text-color:var(--mat-toolbar-container-text-color, var(--mat-sys-on-surface));--mdc-outlined-button-label-text-color:var(--mat-toolbar-container-text-color, var(--mat-sys-on-surface))}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height, 64px)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height, 56px)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height, 64px)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height, 56px)}}"],encapsulation:2,changeDetection:0})}return n})();var Mc=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Se({type:n});static \u0275inj=Ce({imports:[rn,rn]})}return n})();var GD=["*"],Nc;function WD(){if(Nc===void 0&&(Nc=null,typeof window<"u")){let n=window;n.trustedTypes!==void 0&&(Nc=n.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return Nc}function oo(n){return WD()?.createHTML(n)||n}function KI(n){return Error(`Unable to find icon with the name "${n}"`)}function HD(){return Error("Could not find HttpClient for use with Angular Material icons. Please add provideHttpClient() to your providers.")}function QI(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function YI(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}var sn=class{url;svgText;options;svgElement;constructor(e,t,r){this.url=e,this.svgText=t,this.options=r}},KD=(()=>{class n{_httpClient;_sanitizer;_errorHandler;_document;_svgIconConfigs=new Map;_iconSetConfigs=new Map;_cachedIconsByUrl=new Map;_inProgressUrlFetches=new Map;_fontCssClassesByAlias=new Map;_resolvers=[];_defaultFontSetClass=["material-icons","mat-ligature-font"];constructor(t,r,i,s){this._httpClient=t,this._sanitizer=r,this._errorHandler=s,this._document=i}addSvgIcon(t,r,i){return this.addSvgIconInNamespace("",t,r,i)}addSvgIconLiteral(t,r,i){return this.addSvgIconLiteralInNamespace("",t,r,i)}addSvgIconInNamespace(t,r,i,s){return this._addSvgIconConfig(t,r,new sn(i,null,s))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,r,i,s){let a=this._sanitizer.sanitize(Xe.HTML,i);if(!a)throw YI(i);let c=oo(a);return this._addSvgIconConfig(t,r,new sn("",c,s))}addSvgIconSet(t,r){return this.addSvgIconSetInNamespace("",t,r)}addSvgIconSetLiteral(t,r){return this.addSvgIconSetLiteralInNamespace("",t,r)}addSvgIconSetInNamespace(t,r,i){return this._addSvgIconSetConfig(t,new sn(r,null,i))}addSvgIconSetLiteralInNamespace(t,r,i){let s=this._sanitizer.sanitize(Xe.HTML,r);if(!s)throw YI(r);let a=oo(s);return this._addSvgIconSetConfig(t,new sn("",a,i))}registerFontClassAlias(t,r=t){return this._fontCssClassesByAlias.set(t,r),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){let r=this._sanitizer.sanitize(Xe.RESOURCE_URL,t);if(!r)throw QI(t);let i=this._cachedIconsByUrl.get(r);return i?U(xc(i)):this._loadSvgIconFromConfig(new sn(t,null)).pipe(ge(s=>this._cachedIconsByUrl.set(r,s)),B(s=>xc(s)))}getNamedSvgIcon(t,r=""){let i=JI(r,t),s=this._svgIconConfigs.get(i);if(s)return this._getSvgFromConfig(s);if(s=this._getIconConfigFromResolvers(r,t),s)return this._svgIconConfigs.set(i,s),this._getSvgFromConfig(s);let a=this._iconSetConfigs.get(r);return a?this._getSvgFromIconSetConfigs(t,a):Ln(KI(i))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?U(xc(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(B(r=>xc(r)))}_getSvgFromIconSetConfigs(t,r){let i=this._extractIconWithNameFromAnySet(t,r);if(i)return U(i);let s=r.filter(a=>!a.svgText).map(a=>this._loadSvgIconSetFromConfig(a).pipe(fn(c=>{let h=`Loading icon set URL: ${this._sanitizer.sanitize(Xe.RESOURCE_URL,a.url)} failed: ${c.message}`;return this._errorHandler.handleError(new Error(h)),U(null)})));return xo(s).pipe(B(()=>{let a=this._extractIconWithNameFromAnySet(t,r);if(!a)throw KI(t);return a}))}_extractIconWithNameFromAnySet(t,r){for(let i=r.length-1;i>=0;i--){let s=r[i];if(s.svgText&&s.svgText.toString().indexOf(t)>-1){let a=this._svgElementFromConfig(s),c=this._extractSvgIconFromSet(a,t,s.options);if(c)return c}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(ge(r=>t.svgText=r),B(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?U(null):this._fetchIcon(t).pipe(ge(r=>t.svgText=r))}_extractSvgIconFromSet(t,r,i){let s=t.querySelector(`[id="${r}"]`);if(!s)return null;let a=s.cloneNode(!0);if(a.removeAttribute("id"),a.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(a,i);if(a.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(a),i);let c=this._svgElementFromString(oo("<svg></svg>"));return c.appendChild(a),this._setSvgAttributes(c,i)}_svgElementFromString(t){let r=this._document.createElement("DIV");r.innerHTML=t;let i=r.querySelector("svg");if(!i)throw Error("<svg> tag not found");return i}_toSvgElement(t){let r=this._svgElementFromString(oo("<svg></svg>")),i=t.attributes;for(let s=0;s<i.length;s++){let{name:a,value:c}=i[s];a!=="id"&&r.setAttribute(a,c)}for(let s=0;s<t.childNodes.length;s++)t.childNodes[s].nodeType===this._document.ELEMENT_NODE&&r.appendChild(t.childNodes[s].cloneNode(!0));return r}_setSvgAttributes(t,r){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),r&&r.viewBox&&t.setAttribute("viewBox",r.viewBox),t}_fetchIcon(t){let{url:r,options:i}=t,s=i?.withCredentials??!1;if(!this._httpClient)throw HD();if(r==null)throw Error(`Cannot fetch icon from URL "${r}".`);let a=this._sanitizer.sanitize(Xe.RESOURCE_URL,r);if(!a)throw QI(r);let c=this._inProgressUrlFetches.get(a);if(c)return c;let l=this._httpClient.get(a,{responseType:"text",withCredentials:s}).pipe(B(h=>oo(h)),jn(()=>this._inProgressUrlFetches.delete(a)),Mm());return this._inProgressUrlFetches.set(a,l),l}_addSvgIconConfig(t,r,i){return this._svgIconConfigs.set(JI(t,r),i),this}_addSvgIconSetConfig(t,r){let i=this._iconSetConfigs.get(t);return i?i.push(r):this._iconSetConfigs.set(t,[r]),this}_svgElementFromConfig(t){if(!t.svgElement){let r=this._svgElementFromString(t.svgText);this._setSvgAttributes(r,t.options),t.svgElement=r}return t.svgElement}_getIconConfigFromResolvers(t,r){for(let i=0;i<this._resolvers.length;i++){let s=this._resolvers[i](r,t);if(s)return QD(s)?new sn(s.url,null,s.options):new sn(s,null)}}static \u0275fac=function(r){return new(r||n)(ne(Tg,8),ne(Xl),ne(Ee,8),ne(zn))};static \u0275prov=q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function xc(n){return n.cloneNode(!0)}function JI(n,e){return n+":"+e}function QD(n){return!!(n.url&&n.options)}var YD=new X("MAT_ICON_DEFAULT_OPTIONS"),JD=new X("mat-icon-location",{providedIn:"root",factory:XD});function XD(){let n=N(Ee),e=n?n.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}var XI=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],ZD=XI.map(n=>`[${n}]`).join(", "),eP=/^url\(['"]?#(.*?)['"]?\)$/,ZI=(()=>{class n{_elementRef=N(mt);_iconRegistry=N(KD);_location=N(JD);_errorHandler=N(zn);_defaultColor;get color(){return this._color||this._defaultColor}set color(t){this._color=t}_color;inline=!1;get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}_svgIcon;get fontSet(){return this._fontSet}set fontSet(t){let r=this._cleanupFontValue(t);r!==this._fontSet&&(this._fontSet=r,this._updateFontIconClasses())}_fontSet;get fontIcon(){return this._fontIcon}set fontIcon(t){let r=this._cleanupFontValue(t);r!==this._fontIcon&&(this._fontIcon=r,this._updateFontIconClasses())}_fontIcon;_previousFontSetClass=[];_previousFontIconClass;_svgName;_svgNamespace;_previousPath;_elementsWithExternalReferences;_currentIconFetch=Mo.EMPTY;constructor(){let t=N(new Fm("aria-hidden"),{optional:!0}),r=N(YD,{optional:!0});r&&(r.color&&(this.color=this._defaultColor=r.color),r.fontSet&&(this.fontSet=r.fontSet)),t||this._elementRef.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(t){if(!t)return["",""];let r=t.split(":");switch(r.length){case 1:return["",r[0]];case 2:return r;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let t=this._elementsWithExternalReferences;if(t&&t.size){let r=this._location.getPathname();r!==this._previousPath&&(this._previousPath=r,this._prependPathToReferences(r))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();let r=this._location.getPathname();this._previousPath=r,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(r),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){let t=this._elementRef.nativeElement,r=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();r--;){let i=t.childNodes[r];(i.nodeType!==1||i.nodeName.toLowerCase()==="svg")&&i.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let t=this._elementRef.nativeElement,r=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(i=>i.length>0);this._previousFontSetClass.forEach(i=>t.classList.remove(i)),r.forEach(i=>t.classList.add(i)),this._previousFontSetClass=r,this.fontIcon!==this._previousFontIconClass&&!r.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return typeof t=="string"?t.trim().split(" ")[0]:t}_prependPathToReferences(t){let r=this._elementsWithExternalReferences;r&&r.forEach((i,s)=>{i.forEach(a=>{s.setAttribute(a.name,`url('${t}#${a.value}')`)})})}_cacheChildrenWithExternalReferences(t){let r=t.querySelectorAll(ZD),i=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let s=0;s<r.length;s++)XI.forEach(a=>{let c=r[s],l=c.getAttribute(a),h=l?l.match(eP):null;if(h){let p=i.get(c);p||(p=[],i.set(c,p)),p.push({name:a,value:h[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){let[r,i]=this._splitIconName(t);r&&(this._svgNamespace=r),i&&(this._svgName=i),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(i,r).pipe(bt(1)).subscribe(s=>this._setSvgElement(s),s=>{let a=`Error retrieving icon ${r}:${i}! ${s.message}`;this._errorHandler.handleError(new Error(a))})}}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Pe({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(r,i){r&2&&(mn("data-mat-icon-type",i._usingFontIcon()?"font":"svg")("data-mat-icon-name",i._svgName||i.fontIcon)("data-mat-icon-namespace",i._svgNamespace||i.fontSet)("fontIcon",i._usingFontIcon()?i.fontIcon:null),Bo(i.color?"mat-"+i.color:""),Tt("mat-icon-inline",i.inline)("mat-icon-no-color",i.color!=="primary"&&i.color!=="accent"&&i.color!=="warn"))},inputs:{color:"color",inline:[2,"inline","inline",_t],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Sr],ngContentSelectors:GD,decls:1,vars:0,template:function(r,i){r&1&&(gn(),gt(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color, inherit)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}return n})(),Oc=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Se({type:n});static \u0275inj=Ce({imports:[rn,rn]})}return n})();var nP=["*"];var rP=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],iP=["[mat-card-avatar], [matCardAvatar]",`mat-card-title, mat-card-subtitle,
      [mat-card-title], [mat-card-subtitle],
      [matCardTitle], [matCardSubtitle]`,"*"],sP=new X("MAT_CARD_CONFIG"),ew=(()=>{class n{appearance;constructor(){let t=N(sP,{optional:!0});this.appearance=t?.appearance||"raised"}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Pe({type:n,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(r,i){r&2&&Tt("mat-mdc-card-outlined",i.appearance==="outlined")("mdc-card--outlined",i.appearance==="outlined")},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:nP,decls:1,vars:0,template:function(r,i){r&1&&(gn(),gt(0))},styles:['.mat-mdc-card{display:flex;flex-direction:column;box-sizing:border-box;position:relative;border-style:solid;border-width:0;background-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium));box-shadow:var(--mdc-elevated-card-container-elevation, var(--mat-sys-level1))}.mat-mdc-card::after{position:absolute;top:0;left:0;width:100%;height:100%;border:solid 1px rgba(0,0,0,0);content:"";display:block;pointer-events:none;box-sizing:border-box;border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium))}.mat-mdc-card-outlined{background-color:var(--mdc-outlined-card-container-color, var(--mat-sys-surface));border-radius:var(--mdc-outlined-card-container-shape, var(--mat-sys-corner-medium));border-width:var(--mdc-outlined-card-outline-width, 1px);border-color:var(--mdc-outlined-card-outline-color, var(--mat-sys-outline-variant));box-shadow:var(--mdc-outlined-card-container-elevation, var(--mat-sys-level0))}.mat-mdc-card-outlined::after{border:none}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mat-mdc-card-actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font, var(--mat-sys-title-large-font));line-height:var(--mat-card-title-text-line-height, var(--mat-sys-title-large-line-height));font-size:var(--mat-card-title-text-size, var(--mat-sys-title-large-size));letter-spacing:var(--mat-card-title-text-tracking, var(--mat-sys-title-large-tracking));font-weight:var(--mat-card-title-text-weight, var(--mat-sys-title-large-weight))}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color, var(--mat-sys-on-surface));font-family:var(--mat-card-subtitle-text-font, var(--mat-sys-title-medium-font));line-height:var(--mat-card-subtitle-text-line-height, var(--mat-sys-title-medium-line-height));font-size:var(--mat-card-subtitle-text-size, var(--mat-sys-title-medium-size));letter-spacing:var(--mat-card-subtitle-text-tracking, var(--mat-sys-title-medium-tracking));font-weight:var(--mat-card-subtitle-text-weight, var(--mat-sys-title-medium-weight))}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0})}return n})(),tw=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=fe({type:n,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-mdc-card-title"]})}return n})();var nw=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=fe({type:n,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"]})}return n})(),rw=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=fe({type:n,selectors:[["mat-card-subtitle"],["","mat-card-subtitle",""],["","matCardSubtitle",""]],hostAttrs:[1,"mat-mdc-card-subtitle"]})}return n})();var iw=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Pe({type:n,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-mdc-card-header"],ngContentSelectors:iP,decls:4,vars:0,consts:[[1,"mat-mdc-card-header-text"]],template:function(r,i){r&1&&(gn(rP),gt(0),Z(1,"div",0),gt(2,1),ie(),gt(3,2))},encapsulation:2,changeDetection:0})}return n})();var sw=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=fe({type:n,selectors:[["","mat-card-sm-image",""],["","matCardImageSmall",""]],hostAttrs:[1,"mat-mdc-card-sm-image","mdc-card__media"]})}return n})();var ow=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Se({type:n});static \u0275inj=Ce({imports:[rn,rn]})}return n})();function aP(n,e){if(n&1&&(Z(0,"a",4)(1,"mat-card",5)(2,"mat-card-header")(3,"mat-card-title",6),pe(4),ie(),Z(5,"mat-card-subtitle",7),pe(6),ie()(),Z(7,"mat-card-content"),at(8,"img",8),Z(9,"p"),pe(10),ie()()()()),n&2){let t=e.$implicit;Rr("routerLink","/tooldetail"+t.id),Ke(4),xl(t.name),Ke(2),xl(t.availabilityStatus?"Available":"Unavailable"),Ke(2),og("alt",t.name),Rr("src",t.imageUrl,Jm),Ke(2),Ji("Owner: ",t.ownerPublicName,"")}}var ao=class n{title="toolshed";tools=[];toolshedService=N(Nn);static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Pe({type:n,selectors:[["app-shed"]],decls:14,vars:2,consts:[["lang","en"],["charset","UTF-8"],["name","viewport","content","width=device-width, initial-scale=1.0"],[1,"item-grid"],[1,"item-link",3,"routerLink"],[1,"item-card"],[1,"card-title"],[1,"status"],["mat-card-sm-image","",1,"tool-image",3,"src","alt"]],template:function(t,r){t&1&&(Z(0,"html",0)(1,"head"),at(2,"meta",1)(3,"meta",2),Z(4,"title"),pe(5,"Tool List"),ie()(),Z(6,"body")(7,"ul",3),ig(8,aP,11,6,"a",4,rg),ag(10,"async"),Z(11,"li"),pe(12,"No more products available"),ie()(),at(13,"router-outlet"),ie()()),t&2&&(Ke(8),sg(cg(10,0,r.toolshedService.tools$)))},dependencies:[bs,mg,Mc,Oc,ow,ew,nw,iw,sw,rw,tw,da],styles:[".tool-image[_ngcontent-%COMP%]{width:100px;height:100px}.item-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;list-style:none;padding:0;margin:0}.item-link[_ngcontent-%COMP%]{text-decoration:none}.item-card[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column}@media (max-width: 1200px){.item-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}@media (max-width: 900px){.item-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 600px){.item-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};var mw=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(_e(Yi),_e(mt))};static \u0275dir=fe({type:n})}return n})(),gw=(()=>{class n extends mw{static \u0275fac=(()=>{let t;return function(i){return(t||(t=$n(n)))(i||n)}})();static \u0275dir=fe({type:n,features:[Ut]})}return n})(),fp=new X(""),cP={provide:fp,useExisting:br(()=>pp),multi:!0},pp=(()=>{class n extends gw{writeValue(t){this.setProperty("checked",t)}static \u0275fac=(()=>{let t;return function(i){return(t||(t=$n(n)))(i||n)}})();static \u0275dir=fe({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(r,i){r&1&&jt("change",function(a){return i.onChange(a.target.checked)})("blur",function(){return i.onTouched()})},standalone:!1,features:[_n([cP]),Ut]})}return n})(),lP={provide:fp,useExisting:br(()=>zc),multi:!0};function uP(){let n=kr()?kr().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var dP=new X(""),zc=(()=>{class n extends mw{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!uP())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(_e(Yi),_e(mt),_e(dP,8))};static \u0275dir=fe({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&jt("input",function(a){return i._handleInput(a.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(a){return i._compositionEnd(a.target.value)})},standalone:!1,features:[_n([lP]),Ut]})}return n})();function hP(n){return n==null||(typeof n=="string"||Array.isArray(n))&&n.length===0}var mp=new X(""),_w=new X("");function fP(n){return hP(n.value)?{required:!0}:null}function aw(n){return null}function yw(n){return n!=null}function vw(n){return jo(n)?We(n):n}function Iw(n){let e={};return n.forEach(t=>{e=t!=null?O(O({},e),t):e}),Object.keys(e).length===0?null:e}function ww(n,e){return e.map(t=>t(n))}function pP(n){return!n.validate}function Ew(n){return n.map(e=>pP(e)?e:t=>e.validate(t))}function mP(n){if(!n)return null;let e=n.filter(yw);return e.length==0?null:function(t){return Iw(ww(t,e))}}function gp(n){return n!=null?mP(Ew(n)):null}function gP(n){if(!n)return null;let e=n.filter(yw);return e.length==0?null:function(t){let r=ww(t,e).map(vw);return xo(r).pipe(B(Iw))}}function _p(n){return n!=null?gP(Ew(n)):null}function cw(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function _P(n){return n._rawValidators}function yP(n){return n._rawAsyncValidators}function hp(n){return n?Array.isArray(n)?n:[n]:[]}function Fc(n,e){return Array.isArray(n)?n.includes(e):n===e}function lw(n,e){let t=hp(e);return hp(n).forEach(i=>{Fc(t,i)||t.push(i)}),t}function uw(n,e){return hp(e).filter(t=>!Fc(n,t))}var Lc=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=gp(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=_p(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},bi=class extends Lc{name;get formDirective(){return null}get path(){return null}},po=class extends Lc{_parent=null;name=null;valueAccessor=null},Uc=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},vP={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},B1=se(O({},vP),{"[class.ng-submitted]":"isSubmitted"}),bw=(()=>{class n extends Uc{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(_e(po,2))};static \u0275dir=fe({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Tt("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[Ut]})}return n})(),Tw=(()=>{class n extends Uc{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(_e(bi,10))};static \u0275dir=fe({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&Tt("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[Ut]})}return n})();var co="VALID",Vc="INVALID",wi="PENDING",lo="DISABLED",Ti=class{},jc=class extends Ti{value;source;constructor(e,t){super(),this.value=e,this.source=t}},ho=class extends Ti{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},fo=class extends Ti{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},Ei=class extends Ti{status;source;constructor(e,t){super(),this.status=e,this.source=t}};function Aw(n){return(qc(n)?n.validators:n)||null}function IP(n){return Array.isArray(n)?gp(n):n||null}function Cw(n,e){return(qc(e)?e.asyncValidators:n)||null}function wP(n){return Array.isArray(n)?_p(n):n||null}function qc(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function EP(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new ue(1e3,"");if(!r[t])throw new ue(1001,"")}function bP(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new ue(1002,"")})}var Bc=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return yn(this.statusReactive)}set status(e){yn(()=>this.statusReactive.set(e))}_status=ts(()=>this.statusReactive());statusReactive=Cr(void 0);get valid(){return this.status===co}get invalid(){return this.status===Vc}get pending(){return this.status==wi}get disabled(){return this.status===lo}get enabled(){return this.status!==lo}errors;get pristine(){return yn(this.pristineReactive)}set pristine(e){yn(()=>this.pristineReactive.set(e))}_pristine=ts(()=>this.pristineReactive());pristineReactive=Cr(!0);get dirty(){return!this.pristine}get touched(){return yn(this.touchedReactive)}set touched(e){yn(()=>this.touchedReactive.set(e))}_touched=ts(()=>this.touchedReactive());touchedReactive=Cr(!1);get untouched(){return!this.touched}_events=new rt;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(lw(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(lw(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(uw(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(uw(e,this._rawAsyncValidators))}hasValidator(e){return Fc(this._rawValidators,e)}hasAsyncValidator(e){return Fc(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(se(O({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new fo(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new fo(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(se(O({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new ho(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new ho(!0,r))}markAsPending(e={}){this.status=wi;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ei(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(se(O({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=lo,this.errors=null,this._forEachChild(i=>{i.disable(se(O({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new jc(this.value,r)),this._events.next(new Ei(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(se(O({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=co,this._forEachChild(r=>{r.enable(se(O({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(se(O({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===co||this.status===wi)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new jc(this.value,t)),this._events.next(new Ei(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(se(O({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?lo:co}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=wi,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=vw(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Ei(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new ot,this.statusChanges=new ot}_calculateStatus(){return this._allControlsDisabled()?lo:this.errors?Vc:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(wi)?wi:this._anyControlsHaveStatus(Vc)?Vc:co}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new ho(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new fo(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){qc(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=IP(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=wP(this._rawAsyncValidators)}},$c=class extends Bc{constructor(e,t,r){super(Aw(t),Cw(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){bP(this,!0,e),Object.keys(e).forEach(r=>{EP(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var yp=new X("CallSetDisabledState",{providedIn:"root",factory:()=>vp}),vp="always";function TP(n,e){return[...e.path,n]}function Sw(n,e,t=vp){Rw(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),CP(n,e),RP(n,e),SP(n,e),AP(n,e)}function dw(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function AP(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function Rw(n,e){let t=_P(n);e.validator!==null?n.setValidators(cw(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=yP(n);e.asyncValidator!==null?n.setAsyncValidators(cw(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();dw(e._rawValidators,i),dw(e._rawAsyncValidators,i)}function CP(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&Dw(n,e)})}function SP(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&Dw(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function Dw(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function RP(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function DP(n,e){n==null,Rw(n,e)}function PP(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function kP(n){return Object.getPrototypeOf(n.constructor)===gw}function MP(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function NP(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===zc?t=s:kP(s)?r=s:i=s}),i||r||t||null}var xP={provide:bi,useExisting:br(()=>Ip)},uo=Promise.resolve(),Ip=(()=>{class n extends bi{callSetDisabledState;get submitted(){return yn(this.submittedReactive)}_submitted=ts(()=>this.submittedReactive());submittedReactive=Cr(!1);_directives=new Set;form;ngSubmit=new ot;options;constructor(t,r,i){super(),this.callSetDisabledState=i,this.form=new $c({},gp(t),_p(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){uo.then(()=>{let r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),Sw(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){uo.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){uo.then(()=>{let r=this._findContainer(t.path),i=new $c({});DP(i,t),r.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){uo.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){uo.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),MP(this.form,this._directives),this.ngSubmit.emit(t),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static \u0275fac=function(r){return new(r||n)(_e(mp,10),_e(_w,10),_e(yp,8))};static \u0275dir=fe({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,i){r&1&&jt("submit",function(a){return i.onSubmit(a)})("reset",function(){return i.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[_n([xP]),Ut]})}return n})();function hw(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function fw(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var OP=class extends Bc{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(Aw(t),Cw(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),qc(t)&&(t.nonNullable||t.initialValueIsDefault)&&(fw(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){hw(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){hw(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){fw(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var VP={provide:po,useExisting:br(()=>wp)},pw=Promise.resolve(),wp=(()=>{class n extends po{_changeDetectorRef;callSetDisabledState;control=new OP;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new ot;constructor(t,r,i,s,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=NP(this,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),PP(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Sw(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){pw.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&_t(r);pw.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?TP(t,this._parent):[t]}static \u0275fac=function(r){return new(r||n)(_e(bi,9),_e(mp,10),_e(_w,10),_e(fp,10),_e(Pr,8),_e(yp,8))};static \u0275dir=fe({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[_n([VP]),Ut,Bn]})}return n})(),Pw=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=fe({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})();var FP=(()=>{class n{_validator=aw;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):aw,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(r){return new(r||n)};static \u0275dir=fe({type:n,features:[Bn]})}return n})();var LP={provide:mp,useExisting:br(()=>Ep),multi:!0};var Ep=(()=>{class n extends FP{required;inputName="required";normalizeInput=_t;createValidator=t=>fP;enabled(t){return t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=$n(n)))(i||n)}})();static \u0275dir=fe({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){r&2&&mn("required",i._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[_n([LP]),Ut]})}return n})();var UP=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Se({type:n});static \u0275inj=Ce({})}return n})();var kw=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:yp,useValue:t.callSetDisabledState??vp}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=Se({type:n});static \u0275inj=Ce({imports:[UP]})}return n})();var Gc=class n{toolshedService=N(Nn);toolName="";toolDescription="";toolOwner="";toolImageUrl="";toolAvailabilityStatus=!0;addToolFromInput(){if(this.toolName&&this.toolDescription&&this.toolOwner){let e={id:"placeholder",name:this.toolName,description:this.toolDescription,imageUrl:"https://example.com/hammer.jpg",ownerPublicName:this.toolOwner,availabilityStatus:this.toolAvailabilityStatus};this.toolshedService.addTool(e).then(()=>{console.log("Tool added successfully")}).catch(t=>{console.error("Error adding tool:",t)}),this.clearInputs()}else console.error("All fields must be filled out.")}clearInputs(){this.toolName="",this.toolDescription="",this.toolOwner="",this.toolImageUrl="",this.toolAvailabilityStatus=!0}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Pe({type:n,selectors:[["app-upload-page"]],decls:25,vars:5,consts:[["lang","en"],["charset","UTF-8"],["name","viewport","content","width=device-width, initial-scale=1.0"],[3,"ngSubmit"],["for","toolName"],["id","toolName","name","toolName","type","text","placeholder","Enter tool name","required","",3,"ngModelChange","ngModel"],["for","toolDescription"],["id","toolDescription","name","toolDescription","placeholder","Enter tool description","required","",3,"ngModelChange","ngModel"],["for","toolOwner"],["id","toolOwner","name","toolOwner","type","text","placeholder","Enter tool owner","required","",3,"ngModelChange","ngModel"],["for","toolAvailabilityStatus"],["id","toolAvailabilityStatus","name","toolAvailabilityStatus","type","checkbox",3,"ngModelChange","ngModel"],["type","submit",3,"disabled"]],template:function(t,r){t&1&&(Z(0,"html",0)(1,"head"),at(2,"meta",1)(3,"meta",2),Z(4,"title"),pe(5,"Tool Upload"),ie()(),Z(6,"body")(7,"h1"),pe(8,"Upload Tool"),ie(),Z(9,"div")(10,"form",3),jt("ngSubmit",function(){return r.addToolFromInput()}),Z(11,"label",4),pe(12,"Tool Name:"),ie(),Z(13,"input",5),es("ngModelChange",function(s){return Zi(r.toolName,s)||(r.toolName=s),s}),ie(),Z(14,"label",6),pe(15,"Description:"),ie(),Z(16,"textarea",7),es("ngModelChange",function(s){return Zi(r.toolDescription,s)||(r.toolDescription=s),s}),ie(),Z(17,"label",8),pe(18,"Owner:"),ie(),Z(19,"input",9),es("ngModelChange",function(s){return Zi(r.toolOwner,s)||(r.toolOwner=s),s}),ie(),Z(20,"label",10)(21,"input",11),es("ngModelChange",function(s){return Zi(r.toolAvailabilityStatus,s)||(r.toolAvailabilityStatus=s),s}),ie(),pe(22," Available "),ie(),Z(23,"button",12),pe(24,"Add Tool"),ie()()()()()),t&2&&(Ke(13),Xi("ngModel",r.toolName),Ke(3),Xi("ngModel",r.toolDescription),Ke(3),Xi("ngModel",r.toolOwner),Ke(2),Xi("ngModel",r.toolAvailabilityStatus),Ke(2),Rr("disabled",!r.toolName||!r.toolDescription||!r.toolOwner))},dependencies:[kw,Pw,zc,pp,bw,Tw,Ep,wp,Ip],styles:["body[_ngcontent-%COMP%]{font-family:Arial,sans-serif;background-color:#f4f4f9;margin:0;padding:0;display:flex;justify-content:center;align-items:center;height:100vh;flex-direction:column}div[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:8px;box-shadow:0 4px 8px #0000001a;max-width:400px;width:100%;flex:1;margin-bottom:10px;box-sizing:border-box}h1[_ngcontent-%COMP%]{text-align:center;color:#333}label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-size:1rem;color:#555;font-weight:500}input[type=text][_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%;padding:10px;margin-bottom:20px;border:1px solid #ddd;border-radius:6px;font-size:1rem;color:#333;transition:border .3s;box-sizing:border-box}input[type=text][_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}input[type=checkbox][_ngcontent-%COMP%]{margin-right:10px}button[_ngcontent-%COMP%]{width:100%;padding:12px;background-color:#007bff;color:#fff;font-size:1.1rem;border:none;border-radius:6px;cursor:pointer;transition:background-color .3s}button[_ngcontent-%COMP%]:hover{background-color:#0056b3}button[_ngcontent-%COMP%]:disabled{background-color:silver;cursor:not-allowed}textarea[_ngcontent-%COMP%]{resize:vertical;min-height:100px}button[_ngcontent-%COMP%]{margin-top:10px}"]})};var Wc=class n{id=Vo("");toolshedService=N(Nn);currProd$=this.toolshedService.tools$.pipe(B(e=>e.find(t=>t.id===this.id())));static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Pe({type:n,selectors:[["app-tooldetail"]],inputs:{id:[1,"id"]},decls:2,vars:1,template:function(t,r){t&1&&(Z(0,"p"),pe(1),ie()),t&2&&(Ke(),Ji("tooldetail works! ",r.id(),""))},encapsulation:2})};var Mw=[{path:"",component:ao},{path:"shed",component:ao},{path:"upload",component:Gc},{path:"tooldetail/:id",component:Wc},{path:"**",redirectTo:""}];var BP="@",$P=(()=>{class n{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=N(Lm,{optional:!0});loadingSchedulerFn=N(zP,{optional:!0});_engine;constructor(t,r,i,s,a){this.doc=t,this.delegate=r,this.zone=i,this.animationType=s,this.moduleImpl=a}ngOnDestroy(){this._engine?.flush()}loadImpl(){let t=()=>this.moduleImpl??import("./chunk-LRKZEJEA.js").then(i=>i),r;return this.loadingSchedulerFn?r=this.loadingSchedulerFn(t):r=t(),r.catch(i=>{throw new ue(5300,!1)}).then(({\u0275createEngine:i,\u0275AnimationRendererFactory:s})=>{this._engine=i(this.animationType,this.doc);let a=new s(this.delegate,this._engine,this.zone);return this.delegate=a,a})}createRenderer(t,r){let i=this.delegate.createRenderer(t,r);if(i.\u0275type===0)return i;typeof i.throwOnSyntheticProps=="boolean"&&(i.throwOnSyntheticProps=!1);let s=new bp(i);return r?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(a=>{let c=a.createRenderer(t,r);s.use(c),this.scheduler?.notify(11)}).catch(a=>{s.use(i)}),s}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static \u0275fac=function(r){kl()};static \u0275prov=q({token:n,factory:n.\u0275fac})}return n})(),bp=class{delegate;replay=[];\u0275type=1;constructor(e){this.delegate=e}use(e){if(this.delegate=e,this.replay!==null){for(let t of this.replay)t(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,t){this.delegate.appendChild(e,t)}insertBefore(e,t,r,i){this.delegate.insertBefore(e,t,r,i)}removeChild(e,t,r){this.delegate.removeChild(e,t,r)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,r,i){this.delegate.setAttribute(e,t,r,i)}removeAttribute(e,t,r){this.delegate.removeAttribute(e,t,r)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,r,i){this.delegate.setStyle(e,t,r,i)}removeStyle(e,t,r){this.delegate.removeStyle(e,t,r)}setProperty(e,t,r){this.shouldReplay(t)&&this.replay.push(i=>i.setProperty(e,t,r)),this.delegate.setProperty(e,t,r)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,r){return this.shouldReplay(t)&&this.replay.push(i=>i.listen(e,t,r)),this.delegate.listen(e,t,r)}shouldReplay(e){return this.replay!==null&&e.startsWith(BP)}},zP=new X("");function Nw(n="animations"){return zm("NgAsyncAnimations"),ft([{provide:Lo,useFactory:(e,t,r)=>new $P(e,t,r,n),deps:[Ee,Ho,we]},{provide:Pl,useValue:n==="noop"?"NoopAnimations":"BrowserAnimations"}])}var xw={providers:[ug({eventCoalescing:!0}),__(Mw),W_(()=>H_({projectId:"toolshed-d03f6",appId:"1:1076441728383:web:3972f389a5cce4e223864a",storageBucket:"toolshed-d03f6.firebasestorage.app",apiKey:"AIzaSyBPeR3G-Ai_UZlkHM3Z61ZOg2KEvIIAd18",authDomain:"toolshed-d03f6.firebaseapp.com",messagingSenderId:"1076441728383",measurementId:"G-Q3C67485L5"})),FI(()=>UI()),Fy(()=>Va()),Nw()]};var Hc=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Pe({type:n,selectors:[["app-root"]],decls:20,vars:0,consts:[["lang","en"],["charset","UTF-8"],["name","viewport","content","width=device-width, initial-scale=1.0"],[1,"toolbar"],["routerLink","/shed"],["routerLink","/upload"]],template:function(t,r){t&1&&(Z(0,"html",0)(1,"head"),at(2,"meta",1)(3,"meta",2),Z(4,"title"),pe(5,"ToolShed"),ie()(),Z(6,"body")(7,"h1"),pe(8,"Tool Shed"),ie(),Z(9,"mat-toolbar",3)(10,"span")(11,"mat-icon"),pe(12,"home"),ie(),Z(13,"a",4),pe(14,"Shed"),ie(),Z(15,"mat-icon"),pe(16,"about"),ie(),Z(17,"a",5),pe(18,"Upload"),ie()()(),at(19,"router-outlet"),ie()())},dependencies:[bs,da,Mc,HI,Oc,ZI],encapsulation:2})};Ng(Hc,xw).catch(n=>console.error(n));
